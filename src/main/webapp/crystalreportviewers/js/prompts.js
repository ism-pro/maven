
var debug=false;function dumpFormFields(a){theForm=document.forms[a];for(idx=0;idx<theForm.elements.length;++idx){alert(theForm.elements[idx].name+" - "+theForm.elements[idx].value)}}var needURLEncode=false;var promptPrefix="promptex-";function encodePrompt(a){if(needURLEncode){return encodeURIComponent(a)}else{return a}}function addPromptDiscreteValue(e,a,d){var b,c;b=c=e[d+"DiscreteValue"];if(c.type&&c.type.toLowerCase()!="text"&&c.type.toLowerCase()!="hidden"&&c.type.toLowerCase()!="password"){c=c.options[c.selectedIndex]}if(!checkSingleValue(c.value,a)){if(b.focus&&b.type.toLowerCase()!="hidden"){b.focus()}return false}promptValue=encodePrompt(c.value);displayString=(c.text)?c.text:c.value;promptEntry=new Option(displayString,promptValue,false,false);theList=e[d+"ListBox"];theList.options[theList.length]=promptEntry;if(b.focus&&b.type.toLowerCase()!="hidden"){b.focus()}if(b.select){b.select()}if(b.type.toLowerCase!="text"&&b.type.toLowerCase!="hidden"&&b.type.toLowerCase!="password"){if(b.selectedIndex<b.length-1){b.selectedIndex=b.selectedIndex+1}}}function addPromptRangeValue(c,a,b){lowerBound=c[b+"LowerBound"];upperBound=c[b+"UpperBound"];if(lowerBound.type.toLowerCase()!="text"&&lowerBound.type.toLowerCase()!="hidden"&&lowerBound.type.toLowerCase()!="password"){lowerBound=lowerBound.options[lowerBound.selectedIndex];upperBound=upperBound.options[upperBound.selectedIndex]}lowerUnBounded=c[b+"NoLowerBoundCheck"].checked;upperUnBounded=c[b+"NoUpperBoundCheck"].checked;lvalue=uvalue="";if(!lowerUnBounded){if(!checkSingleValue(lowerBound.value,a)){if(lowerBound.focus&&lowerBound.type.toLowerCase()!="hidden"){lowerBound.focus()}return false}lvalue=lowerBound.value}if(!upperUnBounded){if(!checkSingleValue(upperBound.value,a)){if(upperBound.focus&&upperBound.type.toLowerCase()!="hidden"){upperBound.focus()}return false}uvalue=upperBound.value}ldisplay=(lowerBound.text&&!lowerUnBounded)?lowerBound.text:lvalue;udisplay=(upperBound.text&&!upperUnBounded)?upperBound.text:uvalue;lowerChecked=c[b+"LowerCheck"].checked;upperChecked=c[b+"UpperCheck"].checked;value=(lowerChecked&&!lowerUnBounded)?"[":"(";if(!lowerUnBounded){value+=encodePrompt(lvalue)}value+="_crRANGE_";if(!upperUnBounded){value+=encodePrompt(uvalue)}value+=(upperChecked&&!upperUnBounded)?"]":")";if(debug){alert(value)}display=(lowerChecked&&!lowerUnBounded)?"[":"(";display+=ldisplay;display+="  ..  ";display+=udisplay;display+=(upperChecked&&!upperUnBounded)?"]":")";promptEntry=new Option(display,value,false,false);theList=c[b+"ListBox"];theList.options[theList.length]=promptEntry}function disableBoundCheck(c,a,b){if(c==0){if(a[b+"NoLowerBoundCheck"].checked){a[b+"NoUpperBoundCheck"].disabled=true;a[b+"LowerCheck"].disabled=true;a[b+"LowerBound"].disabled=true}else{a[b+"NoUpperBoundCheck"].disabled=false;a[b+"LowerCheck"].disabled=false;a[b+"LowerBound"].disabled=false}}else{if(c==1){if(a[b+"NoUpperBoundCheck"].checked){a[b+"NoLowerBoundCheck"].disabled=true;a[b+"UpperCheck"].disabled=true;a[b+"UpperBound"].disabled=true}else{a[b+"NoLowerBoundCheck"].disabled=false;a[b+"UpperCheck"].disabled=false;a[b+"UpperBound"].disabled=false}}}}function setSelectedValue(c,a,b){selectedOption=c[a].options[c[a].selectedIndex];c[b].value=selectedOption.value}function removeFromListBox(c,b){lbox=c[b+"ListBox"];for(var a=0;a<lbox.options.length;){if(lbox.options[a].selected){lbox.options[a]=null}else{a++}}}function setPromptSingleValue(a,b,c){hiddenField=a[promptPrefix+c];value="";if(a[c+"NULL"]!=null&&a[c+"NULL"].checked){value="_crNULL_"}else{discreteVal=a[c+"DiscreteValue"];if(discreteVal.type.toLowerCase()!="text"&&discreteVal.type.toLowerCase()!="hidden"&&discreteVal.type.toLowerCase()!="password"){value=discreteVal.options[discreteVal.selectedIndex].value}else{value=discreteVal.value}if(!checkSingleValue(value,b)){if(discreteVal.focus&&discreteVal.type.toLowerCase()){discreteVal.focus()}return false}else{value=encodePrompt(value)}}hiddenField.value=value;return true}function setPromptRangeValue(a,b,c){hiddenField=a[promptPrefix+c];if(a[c+"NULL"]!=null&&a[c+"NULL"].checked){value="_crNULL_";hiddenField.value=value;return true}lowerBound=a[c+"LowerBound"];upperBound=a[c+"UpperBound"];if(lowerBound.type.toLowerCase()!="text"&&lowerBound.type.toLowerCase()!="hidden"&&lowerBound.type.toLowerCase()!="password"){lowerBound=lowerBound.options[lowerBound.selectedIndex];upperBound=upperBound.options[upperBound.selectedIndex]}lowerUnBounded=a[c+"NoLowerBoundCheck"].checked;upperUnBounded=a[c+"NoUpperBoundCheck"].checked;lowerChecked=a[c+"LowerCheck"].checked;upperChecked=a[c+"UpperCheck"].checked;uvalue=lvalue="";if(!lowerUnBounded){if(!checkSingleValue(lowerBound.value,b)){if(lowerBound.focus&&lowerBound.type.toLowerCase()!="hidden"){lowerBound.focus()}return false}lvalue=lowerBound.value}if(!upperUnBounded){if(!checkSingleValue(upperBound.value,b)){if(upperBound.focus&&upperBound.type.toLowerCase()!="hidden"){upperBound.focus()}return false}uvalue=upperBound.value}value=(lowerChecked&&!lowerUnBounded)?"[":"(";if(!lowerUnBounded){value+=encodePrompt(lvalue)}value+="_crRANGE_";if(!upperUnBounded){value+=encodePrompt(uvalue)}value+=(upperChecked&&!upperUnBounded)?"]":")";if(debug){alert(value)}hiddenField.value=value;return true}function setPromptMultipleValue(a,b,c){hiddenField=a[promptPrefix+c];values=a[c+"ListBox"].options;if(a[c+"NULL"]!=null&&a[c+"NULL"].checked){value="_crNULL_";hiddenField.value=value;return true}if(values.length==0){value="_crEMPTY_"}else{value="";for(idx=0;idx<values.length;++idx){if(idx!=0){value+="_crMULT_"}value+=values[idx].value}}if(debug){alert(value)}hiddenField.value=value;return true}var regNumber=/^(\+|-)?((\d+(\.|,| |\u00A0)?\d*)+|(\d*(\.|,| |\u00A0)?\d+)+)$/;var regCurrency=regNumber;var regDate=/^(D|d)(A|a)(T|t)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *\)$/;var regDateTime=/^(D|d)(A|a)(T|t)(E|e)(T|t)(I|i)(M|m)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *, *([0-1]?\d|2[0-3]) *, *[0-5]?\d *, *[0-5]?\d *\)$/;var regTime=/^(T|t)(I|i)(M|m)(E|e) *\( *([0-1]?\d|2[0-3]) *, *[0-5]?\d *, *[0-5]?\d *\)$/;function checkSingleValue(b,a){if(a=="n"&&!regNumber.test(b)){alert(L_BadNumber);return false}else{if(a=="c"&&!regCurrency.test(b)){alert(L_BadCurrency);return false}else{if(a=="d"&&!regDate.test(b)){alert(L_BadDate);return false}else{if(a=="dt"&&!regDateTime.test(b)){alert(L_BadDateTime);return false}else{if(a=="t"&&!regTime.test(b)){alert(L_BadTime);return false}}}}}return true}function checkValue(a){if(navigator.appName=="Netscape"){if(a.which==13&&(a.target.type=="text"||a.target.type=="password")){checkSetAndSubmitValues()}}else{if(window.event.keyCode==13&&(window.event.srcElement.type=="text"||window.event.srcElement.type=="password")){checkSetAndSubmitValues()}}};