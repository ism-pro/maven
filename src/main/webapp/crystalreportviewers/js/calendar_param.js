
topBackground="black";bottomBackground="white";tableBGColor="black";cellColor="lightgrey";headingCellColor="white";headingTextColor="black";dateColor="blue";focusColor="#ff0000";hoverColor="darkred";fontStyle="12pt arial, helvetica";headingFontStyle="bold 12pt arial, helvetica";bottomBorder=false;tableBorder=0;var DateTimeFormat=true;var isNav=false;var isIE=false;if(navigator.appName=="Netscape"){isNav=true}else{isIE=true}var calDocTop;var calDocBottom;buildCalParts();function setDateField(b,c,a){thisform=document.forms[b];calDateField=thisform[c];calHiddenField=thisform[a];inDate=thisform[a].value;setInitialDate();calDocTop=buildTopCalFrame();calDocBottom=buildBottomCalFrame()}function setInitialDate(){calDate=ParseDate(inDate,DateTimeFormat);if(isNaN(calDate)){calDate=new Date()}calDay=calDate.getDate();calDate.setDate(1)}function buildTopCalFrame(){var a="<HTML><HEAD></HEAD><BODY BGCOLOR='"+topBackground+"'><FORM NAME='calControl' onSubmit='return false;'><CENTER><TABLE CELLPADDING=0 CELLSPACING=1 BORDER=0 WIDTH=100%><TR><TD COLSPAN=7><CENTER>"+getMonthSelect()+"<INPUT NAME='year' VALUE='"+calDate.getFullYear()+"'TYPE=TEXT SIZE=4 MAXLENGTH=4 onKeyDown='parent.opener.keydownfn(event, \"setYear\", \"\");' onChange='parent.opener.setYear()'></CENTER></TD></TR><TR><TD COLSPAN=7><CENTER><INPUT TYPE=BUTTON NAME='previousYear' VALUE='<<'    onClick='parent.opener.setPreviousYear()'><INPUT TYPE=BUTTON NAME='previousMonth' VALUE=' < '   onClick='parent.opener.setPreviousMonth()'><INPUT TYPE=BUTTON NAME='today' VALUE=\""+L_Today+"\" onClick='parent.opener.setToday()'><INPUT TYPE=BUTTON NAME='nextMonth' VALUE=' > '   onClick='parent.opener.setNextMonth()'><INPUT TYPE=BUTTON NAME='nextYear' VALUE='>>'    onClick='parent.opener.setNextYear()'></CENTER></TD></TR></TABLE></CENTER></FORM></BODY></HTML>";return a}function buildBottomCalFrame(){var h=calendarBegin;month=calDate.getMonth();year=calDate.getFullYear();day=calDay;var c=0;var j=getDaysInMonth();if(day>j){day=j}var b=new Date(year,month,1);var e=b.getDay();j+=e;var f=0;for(c=0;c<e;c++){h+=blankCell;f++}var g=0;var d="weekday";for(c=e;c<j;c++){var a="&nbsp;";if(c-e+1<10){padding="&nbsp;&nbsp;"}else{padding="&nbsp;"}g=c-e+1;if(g==day){d="focusDay"}else{d="weekDay"}h+="<TD align=center bgcolor='"+cellColor+"'><a class='"+d+"' href='javascript:parent.opener.returnDate("+g+")'>"+padding+g+a+"</a></TD>";f++;if(f%7==0){h+="</TR><TR>"}}for(c=j;c<42;c++){h+=blankCell;f++;if(f%7==0){h+="</TR>";if(c<41){h+="<TR>"}}}h+=calendarEnd;return h}function writeCalendar(){calDocBottom=buildBottomCalFrame();if(document.getElementById){top.newWin.frames.bottomCalFrame.document.getElementById("bottomDiv").innerHTML=calDocBottom}else{top.newWin.frames.bottomCalFrame.document.open();top.newWin.frames.bottomCalFrame.document.write(calDocBottom);top.newWin.frames.bottomCalFrame.document.close()}}function setToday(){calDate=new Date();var b=calDate.getMonth();var a=calDate.getFullYear();top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex=b;top.newWin.frames.topCalFrame.document.calControl.year.value=a;calDay=calDate.getDate();writeCalendar()}function setYear(){var a=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(a)){calDate.setFullYear(a);writeCalendar();top.newWin.frames.topCalFrame.document.calControl.year.blur()}else{top.newWin.frames.topCalFrame.document.calControl.year.focus();top.newWin.frames.topCalFrame.document.calControl.year.select()}}function setCurrentMonth(){var a=top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex;calDate.setMonth(a);writeCalendar()}function setPreviousYear(){var a=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(a)&&a>1000){a--;calDate.setFullYear(a);top.newWin.frames.topCalFrame.document.calControl.year.value=a;writeCalendar()}}function setPreviousMonth(){var a=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(a)){var b=top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex;if(b==0){b=11;if(a>1000){a--;calDate.setFullYear(a);top.newWin.frames.topCalFrame.document.calControl.year.value=a}}else{b--}calDate.setMonth(b);top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex=b;writeCalendar()}}function setNextMonth(){var a=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(a)){var b=top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex;if(b==11){b=0;a++;calDate.setFullYear(a);top.newWin.frames.topCalFrame.document.calControl.year.value=a}else{b++}calDate.setMonth(b);top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex=b;writeCalendar()}}function setNextYear(){var a=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(a)){a++;calDate.setFullYear(a);top.newWin.frames.topCalFrame.document.calControl.year.value=a;writeCalendar()}}function getDaysInMonth(){var c;var b=calDate.getMonth()+1;var a=calDate.getFullYear();if(b==1||b==3||b==5||b==7||b==8||b==10||b==12){c=31}else{if(b==4||b==6||b==9||b==11){c=30}else{if(b==2){if(isLeapYear(a)){c=29}else{c=28}}}}return(c)}function isLeapYear(a){if(((a%4)==0)&&((a%100)!=0)||((a%400)==0)){return(true)}else{return(false)}}function isFourDigitYear(a){if(a==null||a.match(/^[0-9]{4}$/)==null){top.newWin.frames.topCalFrame.document.calControl.year.value=calDate.getFullYear();top.newWin.frames.topCalFrame.document.calControl.year.select();top.newWin.frames.topCalFrame.document.calControl.year.focus()}else{return true}}function getMonthSelect(){monthArray=new Array(L_January,L_February,L_March,L_April,L_May,L_June,L_July,L_August,L_September,L_October,L_November,L_December);var a=calDate.getMonth();monthSelect="<SELECT NAME='month' onChange='parent.opener.setCurrentMonth()'>";for(i in monthArray){if(i==a){monthSelect+="<OPTION SELECTED>"+monthArray[i]+"\n"}else{monthSelect+="<OPTION>"+monthArray[i]+"\n"}}monthSelect+="</SELECT>";return monthSelect}function createWeekdayList(){weekdayArray=new Array(L_Su,L_Mo,L_Tu,L_We,L_Th,L_Fr,L_Sa);var a="<TR BGCOLOR='"+headingCellColor+"'>";for(i in weekdayArray){a+="<TD class='heading' align=center>"+weekdayArray[i]+"</TD>"}a+="</TR>";return a}function buildCalParts(){weekdays=createWeekdayList();blankCell="<TD align=center bgcolor='"+cellColor+"'>&nbsp;&nbsp;&nbsp;</TD>";calendarBegin="<HTML><HEAD><STYLE type='text/css'><!--TD.heading { text-decoration: none; color:"+headingTextColor+"; font: "+headingFontStyle+"; }A.focusDay:link { color: "+focusColor+"; text-decoration: none; font: "+fontStyle+"; }A.focusDay:hover { color: "+focusColor+"; text-decoration: none; font: "+fontStyle+"; }A.focusDay:visited { color: "+focusColor+"; text-decoration: none; font: "+fontStyle+"; }A.weekday:link { color: "+dateColor+"; text-decoration: none; font: "+fontStyle+"; }A.weekday:hover { color: "+hoverColor+"; font: "+fontStyle+"; }A.weekday:visited { color: "+dateColor+"; text-decoration: none; font: "+fontStyle+"; }--></STYLE></HEAD><BODY BGCOLOR='"+bottomBackground+"' onload='javascript:self.focus()'>";if(document.getElementById){calendarBegin+="<DIV ID='bottomDiv'>"}calendarBegin+="<CENTER>";if(isNav){calendarBegin+="<TABLE CELLPADDING=0 CELLSPACING=1 BORDER="+tableBorder+" ALIGN=CENTER BGCOLOR='"+tableBGColor+"'><TR><TD>"}calendarBegin+="<TABLE CELLPADDING=0 CELLSPACING=1 BORDER="+tableBorder+" ALIGN=CENTER BGCOLOR='"+tableBGColor+"'>"+weekdays+"<TR>";calendarEnd="";if(bottomBorder){calendarEnd+="<TR></TR>"}if(isNav){calendarEnd+="</TD></TR></TABLE>"}calendarEnd+="</TABLE></CENTER>";if(document.getElementById){calendarEnd+="</DIV>"}calendarEnd+="</BODY></HTML>"}function jsReplace(c,d,b){var a="";if(!c){return""}if(c.indexOf(d)!=-1){t=c.split(d);return(t.join(b))}else{return c}}function doNothing(){}function makeTwoDigit(a){var b=parseInt(a,10);if(b<10){return("0"+b)}else{return b}}function returnDate(a){calDate.setDate(a);var b=calDate.getDate();var e=calDate.getMonth()+1;var c=calDate.getFullYear();var d=new Date(c,e-1,b,0,0,0);if(this.formatJsDate){calDateField.value=formatJsDate(d)}else{calDateField.value=GLDT(d,true,false)}calHiddenField.value="Date(";calHiddenField.value+=c;calHiddenField.value+=",";calHiddenField.value+=e;calHiddenField.value+=",";calHiddenField.value+=b;calHiddenField.value+=")";calDateField.focus();top.newWin.close()}var gHour="0";var gMin="0";var gSec="0";var regDateTimePrompt=/^(D|d)(A|a)(T|t)(E|e)(T|t)(I|i)(M|m)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *, *([0-1]?\d|2[0-3]) *, *[0-5]?\d *, *[0-5]?\d *\)$/;function ParseDateTimePrompt(c){if(regDateTimePrompt.test(c)){var d=c.substr(c.indexOf("(")+1);d=d.substr(0,d.lastIndexOf(")"));var b=d.split(",");var a=new Date(b[0],Number(b[1])-1,b[2]);gHour=b[3];gMin=b[4];gSec=b[5];return a}return new Date()}var regDatePrompt=/^(D|d)(A|a)(T|t)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *\)$/;function ParseDatePrompt(b){if(regDatePrompt.test(b)){var c=b.substr(b.indexOf("(")+1);c=c.substr(0,c.lastIndexOf(")"));var a=c.split(",");return new Date(a[0],Number(a[1])-1,a[2])}return new Date()}function ParseDate(b,c){var a;if(c==true){a=ParseDateTimePrompt(b)}else{a=ParseDatePrompt(b)}return a};