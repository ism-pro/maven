
var debug=false;function dumpFormFields(a){theForm=document.forms[a];for(idx=0;idx<theForm.elements.length;++idx){alert(theForm.elements[idx].name+" - "+theForm.elements[idx].value)}}var needURLEncode=false;var promptPrefix="promptex-";var CR_NULL="_crNULL_";var CR_USE_VALUE="_crUseValue_";var promptMinValue="_minValue";var promptMaxValue="_maxValue";var warningMaxValue="_warnMSG";var _bver=parseInt(navigator.appVersion);var Nav4=((navigator.appName=="Netscape")&&_bver==4);var Nav4plus=((navigator.appName=="Netscape")&&_bver>=4);var IE4plus=((navigator.userAgent.indexOf("MSIE")!=-1)&&_bver>4);if(Nav4plus){var userLanguage=(navigator.language.substr(0,2))}else{var userLanguage=(navigator.browserLanguage.substr(0,2))}function ConstructRangeDisplayString(b,d,c){var a=b.replace("{0}",d);a=a.replace("{1}",c);return a}function GetRangeValueDisplayText(a,d,b,c){if(c=="dt"||c=="d"||c=="t"){if(d.length!=0){if(this.formatJsDate){d=formatJsDate(NeutralDT2Date(d))}else{d=NeutralDT2D(d)}}if(b.length!=0){if(this.formatJsDate){b=formatJsDate(NeutralDT2Date(b))}else{b=NeutralDT2D(b)}}}return ConstructRangeDisplayString(a,d,b)}function encodePrompt(a){if(needURLEncode){return encodeURIComponent(a)}else{return a}}function clickSetNullCheckBox(d,f,i){var j=d[f+"NULL"];var c=d[f+i];var e=d[f+i+"Hidden"];var g=d[f+i+"Hour"];var b=d[f+i+"Minute"];var h=d[f+i+"Second"];var a=d[f+i+"AMPM"];if(j.checked){if(c!=null){c.disabled=true}if(g!=null){g.disabled=true}if(b!=null){b.disabled=true}if(h!=null){h.disabled=true}if(a!=null){a.disabled=true}}else{if(c!=null){c.disabled=false}if(g!=null){g.disabled=false}if(b!=null){b.disabled=false}if(h!=null){h.disabled=false}if(a!=null){a.disabled=false}}}function ClearListBoxAndSetNULL(b){promptEntry=new Option(L_NoValue,CR_NULL,false,false);for(var a=0;a<b.options.length;){b.options[0]=null;a++}b.options[0]=promptEntry;return}function DateTimePromptValueHelper(l,e,p,a,r,b){var q="";var m;var j;var n;if((l=="dt")||(l=="d")){var k=e.value;if(k.length==0){alert(L_NoDateEntered);return""}var o=k.indexOf("(");var f=k.indexOf(")");k=k.substr(o+1,f-o-1);var c=k.split(",");m=c[0];j=c[1];n=c[2]}if(l=="dt"){q="DateTime(";q+=m;q+=",";q+=j;q+=",";q+=n;q+=",";var g=0;if(b!=undefined){var h=0;if(b.selectedIndex==1){h=1}g=p.selectedIndex+1+h*12;if(g==12){g=0}else{if(g==24){g=12}}}else{g=p.selectedIndex}q+=g;q+=",";q+=a.selectedIndex;q+=",";q+=r.selectedIndex;q+=")"}else{if(l=="d"){q="Date(";q+=m;q+=",";q+=j;q+=",";q+=n;q+=")"}else{if(l=="t"){q="Time(";var g=0;if(b!=undefined){var h=0;if(b.selectedIndex==1){h=1}g=p.selectedIndex+1+h*12;if(g==12){g=0}else{if(g==24){g=12}}}else{g=p.selectedIndex}q+=g;q+=",";q+=a.selectedIndex;q+=",";q+=r.selectedIndex;q+=")"}}}return q}function DateTimeDisplayStringHelper(b,f,a,g,d,c){var e=DateTimePromptValueHelper(b,f,a,g,d,c);if(b=="d"&&this.formatJsDate){return formatJsDate(NeutralDT2Date(e))}else{if(b=="t"&&this.formatJsTime){return formatJsTime(NeutralDT2Date(e))}else{if(b=="dt"&&this.formatJsDate&&this.formatJsTime){return formatJsDate(NeutralDT2Date(e))+" "+formatJsTime(NeutralDT2Date(e))}else{return NeutralDT2D(e)}}}}function addPromptDiscreteValueHelper(d,h,g,n){theList=d[g+"ListBox"];if(d[g+"NULL"]!=null&&d[g+"NULL"].checked){ClearListBoxAndSetNULL(theList);return}if(theList.options.length>0&&theList.options[0].value==CR_NULL){alert(L_NoValueAlready);return}var l="";if(n=="DiscreteValue"){l=g+"SelectValue"}else{l=g+"SelectLowerBound"}var j=d[l];if(j!=null){if(j.options[j.selectedIndex].value==CR_NULL){ClearListBoxAndSetNULL(theList);return}}var c=d[g+n];var e=d[g+n+"Hidden"];var k=d[g+n+"Hour"];var b=d[g+n+"Minute"];var m=d[g+n+"Second"];var a=d[g+n+"AMPM"];var f;var i=true;if(c==undefined&&k==undefined){i=false;f=j;f=f.options[f.selectedIndex]}else{if(h=="t"){f=k}else{f=c}}if(h=="dt"||h=="d"||h=="t"){promptValue=DateTimePromptValueHelper(h,e,k,b,m,a);if(promptValue.length==0){return false}if(i){displayString=DateTimeDisplayStringHelper(h,e,k,b,m,a)}else{displayString=DateTimeDisplayStringHelper(h,f.text,k,b,m,a)}}else{promptValue=encodePrompt(f.value);displayString=(f.text)?f.text:f.value}if(!checkSingleValue(promptValue,h)){return false}promptEntry=new Option(displayString,promptValue,false,false);theList.options[theList.length]=promptEntry}function addPromptDiscreteValueHelperWithChecking(e,j,g,q,m,h,i){theList=e[g+"ListBox"];if(e[g+"NULL"]!=null&&e[g+"NULL"].checked){ClearListBoxAndSetNULL(theList);return}if(theList.options.length>0&&theList.options[0].value==CR_NULL){alert(L_NoValueAlready);return}var o="";if(q=="DiscreteValue"){o=g+"SelectValue"}else{o=g+"SelectLowerBound"}var l=e[o];if(l!=null){if(l.options[l.selectedIndex].value==CR_NULL){ClearListBoxAndSetNULL(theList);return}}var c=e[g+q];var d=e[g+q+"Hidden"];var n=e[g+q+"Hour"];var b=e[g+q+"Minute"];var p=e[g+q+"Second"];var a=e[g+q+"AMPM"];var f;var k=true;if(c==undefined&&n==undefined){k=false;f=l;f=f.options[f.selectedIndex]}else{if(j=="t"){f=n}else{f=c}}if(j=="dt"||j=="d"||j=="t"){promptValue=DateTimePromptValueHelper(j,d,n,b,p,a);if(promptValue.length==0){return false}if(k){displayString=DateTimeDisplayStringHelper(j,d,n,b,p,a)}else{displayString=DateTimeDisplayStringHelper(j,f.text,n,b,p,a)}}else{promptValue=encodePrompt(f.value);displayString=(f.text)?f.text:f.value}if(!checkSingleValueWithMinMax(promptValue,j,m,h,i)){return false}promptEntry=new Option(displayString,promptValue,false,false);theList.options[theList.length]=promptEntry}function addPromptDiscreteValue(c,a,b){addPromptDiscreteValueHelper(c,a,b,"DiscreteValue")}function addPromptDiscreteValueWithChecking(f,b,e,c,d,a){addPromptDiscreteValueHelperWithChecking(f,b,e,"DiscreteValue",c,d,a)}function addPromptDiscreteRangeValue(c,a,b){lowerOption=c[b+"SelectLowerOptions"];if(lowerOption.selectedIndex==1){addPromptDiscreteValueHelper(c,a,b,"LowerBound")}else{addPromptRangeValue(c,a,b)}}function addPromptDiscreteRangeValueWithChecking(f,b,e,c,d,a){lowerOption=f[e+"SelectLowerOptions"];if(lowerOption.selectedIndex==1){addPromptDiscreteValueHelperWithChecking(f,b,e,"LowerBound",c,d,a)}else{addPromptRangeValueWithChecking(f,b,e,c,d,a)}}function addPromptRangeValue(a,e,f){theList=a[f+"ListBox"];if(a[f+"NULL"]!=null&&a[f+"NULL"].checked){ClearListBoxAndSetNULL(theList);return}if(theList.options.length>0&&theList.options[0].value==CR_NULL){alert(L_NoValueAlready);return}var l=f+"SelectLowerBound";var s=f+"SelectUpperBound";var b=a[l];var g=a[s];if(b!=null&&g!=null){if(b.options[b.selectedIndex].value==CR_NULL&&g.options[g.selectedIndex].value==CR_NULL){ClearListBoxAndSetNULL(theList);return}else{if(b.options[b.selectedIndex].value==CR_NULL||g.options[g.selectedIndex].value==CR_NULL){alert(L_BadValue);return}}}lowerOption=a[f+"SelectLowerOptions"];upperOption=a[f+"SelectUpperOptions"];lowerBound=a[f+"LowerBound"];upperBound=a[f+"UpperBound"];lowerBoundHidden=a[f+"LowerBoundHidden"];upperBoundHidden=a[f+"UpperBoundHidden"];var j=a[f+"LowerBoundHour"];var h=a[f+"LowerBoundMinute"];var i=a[f+"LowerBoundSecond"];var r=a[f+"LowerBoundAMPM"];var q=a[f+"UpperBoundHour"];var k=a[f+"UpperBoundMinute"];var c=a[f+"UpperBoundSecond"];var p=a[f+"UpperBoundAMPM"];var n=true;if(lowerBound==undefined&&j==undefined){n=false;lowerBound=a[f+"SelectLowerBound"];upperBound=a[f+"SelectUpperBound"];lowerBound=lowerBound.options[lowerBound.selectedIndex];upperBound=upperBound.options[upperBound.selectedIndex]}lowerUnBounded=(a[f+"SelectLowerOptions"].selectedIndex==(a[f+"SelectLowerOptions"].options.length-1));upperUnBounded=(a[f+"SelectUpperOptions"].selectedIndex==(a[f+"SelectUpperOptions"].options.length-1));lvalue=uvalue="";if(!lowerUnBounded){if((e=="dt"||e=="d"||e=="t")&&(n)){lvalue=DateTimePromptValueHelper(e,lowerBoundHidden,j,h,i,r);if(lvalue.length==0){return false}}else{lvalue=lowerBound.value}if(!checkSingleValue(lvalue,e)){if(lowerBound.focus&&lowerBound.type.toLowerCase()!="hidden"){lowerBound.focus()}return false}}if(!upperUnBounded){if((e=="dt"||e=="d"||e=="t")&&(n)){uvalue=DateTimePromptValueHelper(e,upperBoundHidden,q,k,c,p);if(uvalue.length==0){return false}}else{uvalue=upperBound.value}if(!checkSingleValue(uvalue,e)){if(upperBound.focus&&upperBound.type.toLowerCase()!="hidden"){upperBound.focus()}return false}}var m="";var d="";if((e=="dt"||e=="d"||e=="t")&&(n)){if(!lowerUnBounded){m=DateTimeDisplayStringHelper(e,lowerBoundHidden,j,h,i,r)}if(!upperUnBounded){d=DateTimeDisplayStringHelper(e,upperBoundHidden,q,k,c,p)}}else{m=lvalue;d=uvalue}lowerChecked=(a[f+"SelectLowerOptions"].selectedIndex==0);upperChecked=(a[f+"SelectUpperOptions"].selectedIndex==0);value=lowerUnBounded?"{":lowerChecked?"[":"(";if(!lowerUnBounded){value+=encodePrompt(lvalue)}value+="_crRANGE_";if(!upperUnBounded){value+=encodePrompt(uvalue)}value+=upperUnBounded?"}":upperChecked?"]":")";if(debug){alert(value)}if(!lowerUnBounded&&!upperUnBounded&&!checkRangeValue(lvalue,uvalue,e)){return false}var o="";if(lowerChecked&&upperUnBounded){o=ConstructRangeDisplayString(L_FROM,m,"")}else{if(lowerUnBounded&&upperChecked){o=ConstructRangeDisplayString(L_TO,d,"")}else{if(!lowerChecked&&upperUnBounded){o=ConstructRangeDisplayString(L_AFTER,m,"")}else{if(lowerUnBounded&&!upperChecked){o=ConstructRangeDisplayString(L_BEFORE,d,"")}else{if(lowerChecked&&upperChecked){o=ConstructRangeDisplayString(L_FROM_TO,m,d)}else{if(lowerChecked&&!upperUnBounded&&!upperChecked){o=ConstructRangeDisplayString(L_FROM_BEFORE,m,d)}else{if(!lowerChecked&&!lowerUnBounded&&upperChecked){o=ConstructRangeDisplayString(L_AFTER_TO,m,d)}else{if(!lowerChecked&&!lowerUnBounded&&!upperChecked&&!upperUnBounded){o=ConstructRangeDisplayString(L_AFTER_BEFORE,m,d)}}}}}}}}if((!lowerUnBounded)||(!upperUnBounded)){promptEntry=new Option(o,value,false,false);theList.options[theList.length]=promptEntry}else{alert(L_BadBound)}}function addPromptRangeValueWithChecking(a,e,f,j,s,p){theList=a[f+"ListBox"];if(a[f+"NULL"]!=null&&a[f+"NULL"].checked){ClearListBoxAndSetNULL(theList);return}if(theList.options.length>0&&theList.options[0].value==CR_NULL){alert(L_NoValueAlready);return}var m=f+"SelectLowerBound";var v=f+"SelectUpperBound";var b=a[m];var g=a[v];if(b!=null&&g!=null){if(b.options[b.selectedIndex].value==CR_NULL&&g.options[g.selectedIndex].value==CR_NULL){ClearListBoxAndSetNULL(theList);return}else{if(b.options[b.selectedIndex].value==CR_NULL||g.options[g.selectedIndex].value==CR_NULL){alert(L_BadValue);return}}}lowerOption=a[f+"SelectLowerOptions"];upperOption=a[f+"SelectUpperOptions"];lowerBound=a[f+"LowerBound"];upperBound=a[f+"UpperBound"];lowerBoundHidden=a[f+"LowerBoundHidden"];upperBoundHidden=a[f+"UpperBoundHidden"];var k=a[f+"LowerBoundHour"];var h=a[f+"LowerBoundMinute"];var i=a[f+"LowerBoundSecond"];var u=a[f+"LowerBoundAMPM"];var t=a[f+"UpperBoundHour"];var l=a[f+"UpperBoundMinute"];var c=a[f+"UpperBoundSecond"];var r=a[f+"UpperBoundAMPM"];var o=true;if(lowerBound==undefined&&k==undefined){o=false;lowerBound=a[f+"SelectLowerBound"];upperBound=a[f+"SelectUpperBound"];lowerBound=lowerBound.options[lowerBound.selectedIndex];upperBound=upperBound.options[upperBound.selectedIndex]}lowerUnBounded=(a[f+"SelectLowerOptions"].selectedIndex==(a[f+"SelectLowerOptions"].options.length-1));upperUnBounded=(a[f+"SelectUpperOptions"].selectedIndex==(a[f+"SelectUpperOptions"].options.length-1));lvalue=uvalue="";if(!lowerUnBounded){if((e=="dt"||e=="d"||e=="t")&&(o)){lvalue=DateTimePromptValueHelper(e,lowerBoundHidden,k,h,i,u);if(lvalue.length==0){return false}}else{lvalue=lowerBound.value}if(!checkSingleValue(lvalue,e)){if(lowerBound.focus&&lowerBound.type.toLowerCase()!="hidden"){lowerBound.focus()}return false}}if(!upperUnBounded){if((e=="dt"||e=="d"||e=="t")&&(o)){uvalue=DateTimePromptValueHelper(e,upperBoundHidden,t,l,c,r);if(uvalue.length==0){return false}}else{uvalue=upperBound.value}if(!checkSingleValue(uvalue,e)){if(upperBound.focus&&upperBound.type.toLowerCase()!="hidden"){upperBound.focus()}return false}}var n="";var d="";if((e=="dt"||e=="d"||e=="t")&&(o)){if(!lowerUnBounded){n=DateTimeDisplayStringHelper(e,lowerBoundHidden,k,h,i,u)}if(!upperUnBounded){d=DateTimeDisplayStringHelper(e,upperBoundHidden,t,l,c,r)}}else{n=lvalue;d=uvalue}lowerChecked=(a[f+"SelectLowerOptions"].selectedIndex==0);upperChecked=(a[f+"SelectUpperOptions"].selectedIndex==0);value=lowerUnBounded?"{":lowerChecked?"[":"(";if(!lowerUnBounded){value+=encodePrompt(lvalue)}value+="_crRANGE_";if(!upperUnBounded){value+=encodePrompt(uvalue)}value+=upperUnBounded?"}":upperChecked?"]":")";if(debug){alert(value)}if(!lowerUnBounded&&!upperUnBounded&&!checkRangeValueWithMinMax(lvalue,uvalue,e,j,s,p)){return false}var q="";if(lowerChecked&&upperUnBounded){q=ConstructRangeDisplayString(L_FROM,n,"")}else{if(lowerUnBounded&&upperChecked){q=ConstructRangeDisplayString(L_TO,d,"")}else{if(!lowerChecked&&upperUnBounded){q=ConstructRangeDisplayString(L_AFTER,n,"")}else{if(lowerUnBounded&&!upperChecked){q=ConstructRangeDisplayString(L_BEFORE,d,"")}else{if(lowerChecked&&upperChecked){q=ConstructRangeDisplayString(L_FROM_TO,n,d)}else{if(lowerChecked&&!upperUnBounded&&!upperChecked){q=ConstructRangeDisplayString(L_FROM_BEFORE,n,d)}else{if(!lowerChecked&&!lowerUnBounded&&upperChecked){q=ConstructRangeDisplayString(L_AFTER_TO,n,d)}else{if(!lowerChecked&&!lowerUnBounded&&!upperChecked&&!upperUnBounded){q=ConstructRangeDisplayString(L_AFTER_BEFORE,n,d)}}}}}}}}if((!lowerUnBounded)||(!upperUnBounded)){promptEntry=new Option(q,value,false,false);theList.options[theList.length]=promptEntry}else{alert(L_BadBound)}}function disableBoundCheck(c,a,b){if(c==0){if(a[b+"NoLowerBoundCheck"].checked){a[b+"NoUpperBoundCheck"].disabled=true;a[b+"LowerCheck"].disabled=true;a[b+"LowerBound"].disabled=true}else{a[b+"NoUpperBoundCheck"].disabled=false;a[b+"LowerCheck"].disabled=false;a[b+"LowerBound"].disabled=false}}else{if(c==1){if(a[b+"NoUpperBoundCheck"].checked){a[b+"NoLowerBoundCheck"].disabled=true;a[b+"UpperCheck"].disabled=true;a[b+"UpperBound"].disabled=true}else{a[b+"NoLowerBoundCheck"].disabled=false;a[b+"UpperCheck"].disabled=false;a[b+"UpperBound"].disabled=false}}}}function setSelectedValue(b,r,l,e,x){var h=b[l];var s=b[r];var w=b[x+"Hidden"];var d=b[x+"Hour"];var p=b[x+"Minute"];var f=b[x+"Second"];var j=b[x+"AMPM"];if(h==null&&d==null){return}if(s.options[s.selectedIndex].value==CR_USE_VALUE){return}if(s.options[s.selectedIndex].value==CR_NULL){if(h!=null){h.disabled=true}if(d!=null){d.disabled=true}if(p!=null){p.disabled=true}if(f!=null){f.disabled=true}if(j!=null){j.disabled=true}return}else{if(h!=null){h.disabled=false}if(d!=null){d.disabled=false}if(p!=null){p.disabled=false}if(f!=null){f.disabled=false}if(j!=null){j.disabled=false}}var i,u,q;var g,m,t;if(e=="dt"||e=="d"||e=="t"){var c=s.options[s.selectedIndex].value;if(c.length==0){return}var n=c.indexOf("(");c=c.substr(n+1,c.length-n);var o=c.indexOf(")");c=c.substr(0,o);var v=c.split(",");if(e=="dt"){i=v[0];u=v[1];q=v[2];g=parseInt(v[3]);m=parseInt(v[4]);t=parseInt(v[5])}else{if(e=="d"){i=v[0];u=v[1];q=v[2]}else{if(e=="t"){g=parseInt(v[0]);m=parseInt(v[1]);t=parseInt(v[2])}}}}selectedOption=s.options[s.selectedIndex];if(e=="dt"){var k=new Date(i,u-1,q,g,m,t);if(this.formatJsDate){h.value=formatJsDate(k)}else{h.value=GLDT(k,true,false)}w.value="Date(";w.value+=i;w.value+=",";w.value+=u;w.value+=",";w.value+=q;w.value+=")";if(j!=undefined){if(g==0||g==12){d.selectedIndex=11}else{if(g>12){d.selectedIndex=g-12-1}else{d.selectedIndex=g-1}}}else{d.selectedIndex=g}p.selectedIndex=m;f.selectedIndex=t;if(j!=null){if(g>=12){j.selectedIndex=1}else{j.selectedIndex=0}}}else{if(e=="d"){var k=new Date(i,u-1,q,0,0,0);if(this.formatJsDate){h.value=formatJsDate(k)}else{h.value=GLDT(k,true,false)}w.value="Date(";w.value+=i;w.value+=",";w.value+=u;w.value+=",";w.value+=q;w.value+=")"}else{if(e=="t"){if(j!=null){if(g==0||g==12){d.selectedIndex=11}else{if(g>12){d.selectedIndex=g-12-1}else{d.selectedIndex=g-1}}}else{d.selectedIndex=g}p.selectedIndex=m;f.selectedIndex=t;if(j!=null){if(g>=12){j.selectedIndex=1}else{j.selectedIndex=0}}}else{h.value=selectedOption.value}}}if(s.options[0].value==CR_USE_VALUE){s.selectedIndex=0}}function removeFromListBox(c,b){lbox=c[b+"ListBox"];for(var a=0;a<lbox.options.length;){if(lbox.options[a].selected){lbox.options[a]=null}else{a++}}}function setPromptSingleValue(j,h,f){hiddenField=j[promptPrefix+f];var g="";var c="";var e="";if(typeof(j[promptPrefix+f+promptMinValue])!="undefined"){g=(j[promptPrefix+f+promptMinValue]).value}if(typeof(j[promptPrefix+f+promptMaxValue])!="undefined"){c=(j[promptPrefix+f+promptMaxValue]).value}if(typeof(j[promptPrefix+f+warningMaxValue])!="undefined"){e=(j[promptPrefix+f+warningMaxValue]).value}value="";if(j[f+"NULL"]!=null&&j[f+"NULL"].checked){value=CR_NULL;hiddenField.value=value;return true}var l=f+"SelectValue";var i=j[l];if(i!=null){if(i.options[i.selectedIndex].value==CR_NULL){hiddenField.value=CR_NULL;return true}}discreteVal=j[f+"DiscreteValue"];if(discreteVal!=undefined||j[f+"DiscreteValueHour"]!=undefined){if(h=="dt"||h=="d"||h=="t"){var d=j[f+"DiscreteValueHidden"];var k=j[f+"DiscreteValueHour"];var b=j[f+"DiscreteValueMinute"];var m=j[f+"DiscreteValueSecond"];var a=j[f+"DiscreteValueAMPM"];value=DateTimePromptValueHelper(h,d,k,b,m,a);if(value.length==0){return false}}else{value=discreteVal.value}}else{discreteVal=j[f+"SelectValue"];value=discreteVal.options[discreteVal.selectedIndex].value}if((g.length==0&&c.length==0&&e.length==0)&&!checkSingleValue(value,h)){if(discreteVal.focus&&discreteVal.type.toLowerCase()){discreteVal.focus()}return false}else{if((g.length>0&&c.length>0&&e.length>0)&&!checkSingleValueWithMinMax(value,h,g,c,e)){if(typeof(discreteVal)!="undefined"&&discreteVal.focus&&discreteVal.type.toLowerCase()){discreteVal.focus()}return false}else{value=encodePrompt(value)}}hiddenField.value=value;return true}function setPromptRangeValue(o,c,e){hiddenField=o[promptPrefix+e];var k="";var h="";var d="";if(typeof(o[promptPrefix+e+promptMinValue])!="undefined"){k=(o[promptPrefix+e+promptMinValue]).value}if(typeof(o[promptPrefix+e+promptMaxValue])!="undefined"){h=(o[promptPrefix+e+promptMaxValue]).value}if(typeof(o[promptPrefix+e+warningMaxValue])!="undefined"){d=(o[promptPrefix+e+warningMaxValue]).value}if(o[e+"NULL"]!=null&&o[e+"NULL"].checked){value=CR_NULL;hiddenField.value=value;return true}var n=e+"SelectLowerBound";var s=e+"SelectUpperBound";var a=o[n];var f=o[s];if(a!=null&&f!=null){if(a.options[a.selectedIndex].value==CR_NULL&&f.options[f.selectedIndex].value==CR_NULL){hiddenField.value="_crNULL_";return true}else{if(a.options[a.selectedIndex].value==CR_NULL||f.options[f.selectedIndex].value==CR_NULL){alert(L_BadValue);return false}}}lowerOptions=o[e+"SelectLowerOptions"];upperOptions=o[e+"SelectUpperOptions"];lowerBound=o[e+"LowerBound"];upperBound=o[e+"UpperBound"];lowerBoundHidden=o[e+"LowerBoundHidden"];upperBoundHidden=o[e+"UpperBoundHidden"];lowerBoundDropdown=o[e+"SelectLowerBound"];upperBoundDropdown=o[e+"SelectUpperBound"];var j=true;if(lowerBound==undefined&&o[e+"LowerBoundHour"]==undefined){j=false;lowerBound=lowerBoundDropdown;upperBound=upperBoundDropdown;lowerBound=lowerBound.options[lowerBound.selectedIndex];upperBound=upperBound.options[upperBound.selectedIndex]}lowerUnBounded=(lowerOptions.selectedIndex==(lowerOptions.length-1));upperUnBounded=(upperOptions.selectedIndex==(upperOptions.length-1));lowerChecked=(lowerOptions.selectedIndex==0);upperChecked=(upperOptions.selectedIndex==0);uvalue=lvalue="";if(!lowerUnBounded){if((c=="dt"||c=="d"||c=="t")&&(j)){var l=o[e+"LowerBoundHour"];var g=o[e+"LowerBoundMinute"];var i=o[e+"LowerBoundSecond"];var r=o[e+"LowerBoundAMPM"];lvalue=DateTimePromptValueHelper(c,lowerBoundHidden,l,g,i,r);if(lvalue.length==0){return false}}else{lvalue=lowerBound.value}if(!checkSingleValue(lvalue,c)){if(lowerBound!=undefined&&lowerBound.focus){lowerBound.focus()}return false}}if(!upperUnBounded){if((c=="dt"||c=="d"||c=="t")&&(j)){var q=o[e+"UpperBoundHour"];var m=o[e+"UpperBoundMinute"];var b=o[e+"UpperBoundSecond"];var p=o[e+"UpperBoundAMPM"];uvalue=DateTimePromptValueHelper(c,upperBoundHidden,q,m,b,p);if(uvalue.length==0){return false}}else{uvalue=upperBound.value}if(!checkSingleValue(uvalue,c)){if(upperBound!=undefined&&upperBound.focus){upperBound.focus()}return false}}value=lowerUnBounded?"{":lowerChecked?"[":"(";if(!lowerUnBounded){value+=encodePrompt(lvalue)}value+="_crRANGE_";if(!upperUnBounded){value+=encodePrompt(uvalue)}value+=upperUnBounded?"}":upperChecked?"]":")";if(debug){alert(value)}if(lowerUnBounded&&upperUnBounded){alert(L_BadBound);return false}if((k.length==0&&h.length==0&&d.length==0)&&!lowerUnBounded&&!upperUnBounded&&!checkRangeValue(lvalue,uvalue,c)){return false}else{if((k.length>0&&h.length>0&&d.length>0)&&!lowerUnBounded&&!upperUnBounded&&!checkRangeValueWithMinMax(lvalue,uvalue,c,k,h,d)){return false}}hiddenField.value=value;return true}function setPromptMultipleValue(a,b,c){hiddenField=a[promptPrefix+c];values=a[c+"ListBox"].options;if(values.length==0){value="_crEMPTY_"}else{value="";for(idx=0;idx<values.length;++idx){if(idx!=0){value+="_crMULT_"}value+=values[idx].value}}if(debug){alert(value)}hiddenField.value=value;return true}var regNumber=/^(\+|-)?((\d+(\.|,| |\u00A0)?\d*)+|(\d*(\.|,| |\u00A0)?\d+)+)$/;var regCurrency=regNumber;var regDate=/^(D|d)(A|a)(T|t)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *\)$/;var regDateTime=/^(D|d)(A|a)(T|t)(E|e)(T|t)(I|i)(M|m)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *, *([0-1]?\d|2[0-3]) *, *[0-5]?\d *, *[0-5]?\d *\)$/;var regTime=/^(T|t)(I|i)(M|m)(E|e) *\( *([0-1]?\d|2[0-3]) *, *[0-5]?\d *, *[0-5]?\d *\)$/;function checkSingleValue(b,a){if(a=="n"&&!regNumber.test(b)){alert(L_BadNumber);return false}else{if(a=="c"&&!regCurrency.test(b)){alert(L_BadCurrency);return false}}return true}function checkSingleValueWithMinMax(value,type,minValue,maxValue,errorMessage){if(type=="n"){if(!regNumber.test(value)||isNaN(DelocalizeNum(value))||isNaN(DelocalizeNum(minValue))||isNaN(DelocalizeNum(maxValue))){alert(L_BadNumber);return false}if(minValue.length>0&&maxValue.length>0){if(eval(DelocalizeNum(value))<eval(DelocalizeNum(minValue))||eval(DelocalizeNum(value))>eval(DelocalizeNum(maxValue))){alert(errorMessage);return false}}}else{if(type=="c"){if(!regCurrency.test(value)||isNaN(DelocalizeNum(value))||isNaN(DelocalizeNum(minValue))||isNaN(DelocalizeNum(maxValue))){alert(L_BadCurrency);return false}if(minValue.length>0&&maxValue.length>0){if(eval(DelocalizeNum(value))<eval(DelocalizeNum(minValue))||eval(DelocalizeNum(value))>eval(DelocalizeNum(maxValue))){alert(errorMessage);return false}}}else{if(type=="d"){if(minValue.length>0&&maxValue.length>0){var comp=NeutralDT2Date(value);var dMin=Date.parse(minValue);var dMax=Date.parse(maxValue);var offset=comp.getTimezoneOffset()*60*1000;var dComp=Date.parse(comp)-offset;if(dComp<dMin||dComp>dMax){alert(errorMessage);return false}}}else{if(type=="dt"){if(minValue.length>0&&maxValue.length>0){var comp=NeutralDT2Date(value);var dtMin=Date.parse(minValue);var dtMax=Date.parse(maxValue);var offset=comp.getTimezoneOffset()*60*1000;var dtComp=Date.parse(comp)-offset;if(dtComp<dtMin||dtComp>dtMax){alert(errorMessage);return false}}}else{if(type=="t"){if(minValue.length>0&&maxValue.length>0){var comp=eval("new Date(0,0,0,"+value.substring(value.indexOf("(")+1,value.indexOf(")")+1));var tMinComponents=getTimeFromIETFFormat(minValue);var tMaxComponents=getTimeFromIETFFormat(maxValue);var tMinTEFT=eval("new Date(0,0,0,"+tMinComponents[0]+","+tMinComponents[1]+","+tMinComponents[2]+")");var tMaxTEFT=eval("new Date(0,0,0,"+tMaxComponents[0]+","+tMaxComponents[1]+","+tMaxComponents[2]+")");var index1=minValue.indexOf(" PM ");if(index1>-1){tMinTEFT.setTime(tMinTEFT.getTime()+(12*3600*1000))}var index2=maxValue.indexOf(" PM ");if(index2>-1){tMaxTEFT.setTime(tMaxTEFT.getTime()+(12*3600*1000))}var tMin=Date.parse(tMinTEFT);var tMax=Date.parse(tMaxTEFT);var tComp=Date.parse(comp);if(tComp<tMin||tComp>tMax){alert(errorMessage);return false}}}else{if(type=="text"||type=="s"){if(value.length<eval(DelocalizeNum(minValue))||value.length>eval(DelocalizeNum(maxValue))){alert(errorMessage);return false}}}}}}}return true}function checkRangeValue(fvalue,tvalue,type){if((type=="n")||(type=="c")){if(eval(DelocalizeNum(fvalue))>eval(DelocalizeNum(tvalue))){alert(L_RangeError);return false}}else{if(type=="d"){if(eval("new "+fvalue)>eval("new "+tvalue)){alert(L_RangeError);return false}}else{if(type=="t"){var comp1=eval("new Date(0,0,0,"+fvalue.substring(fvalue.indexOf("(")+1,fvalue.indexOf(")")+1));var comp2=eval("new Date(0,0,0,"+tvalue.substring(tvalue.indexOf("(")+1,tvalue.indexOf(")")+1));if(comp1>comp2){alert(L_RangeError);return false}}else{if(type=="dt"){var comp1=eval("new Date"+fvalue.substring(8,fvalue.length));var comp2=eval("new Date"+tvalue.substring(8,tvalue.length));if(comp1>comp2){alert(L_RangeError);return false}}else{if(type=="text"){if(fvalue.toLowerCase()>tvalue.toLowerCase()){alert(L_RangeError);return false}}}}}}return true}function checkRangeValueWithMinMax(fvalue,tvalue,type,minValue,maxValue,errorMessage){if((type=="n")||(type=="c")){if(isNaN(DelocalizeNum(fvalue))||isNaN(DelocalizeNum(minValue))||isNaN(DelocalizeNum(tvalue))||isNaN(DelocalizeNum(maxValue))){alert(L_BadNumber);return false}if(eval(DelocalizeNum(fvalue))>eval(DelocalizeNum(tvalue))){alert(L_RangeError);return false}if(minValue.length>0&&maxValue.length>0){if(eval(DelocalizeNum(fvalue))<eval(DelocalizeNum(minValue))||eval(DelocalizeNum(tvalue))>eval(DelocalizeNum(maxValue))){alert(errorMessage);return false}}}else{if(type=="d"){var comp1=NeutralDT2Date(fvalue);var comp2=NeutralDT2Date(tvalue);if(comp1>comp2){alert(L_RangeError);return false}if(minValue.length>0&&maxValue.length>0){var dMin=Date.parse(minValue);var dMax=Date.parse(maxValue);var offset1=comp1.getTimezoneOffset()*60*1000;var offset2=comp2.getTimezoneOffset()*60*1000;var dComp1=Date.parse(comp1)-offset1;var dComp2=Date.parse(comp2)-offset2;if(dComp1<dMin||dComp2>dMax){alert(errorMessage);return false}}}else{if(type=="t"){var comp1=eval("new Date(0,0,0,"+fvalue.substring(fvalue.indexOf("(")+1,fvalue.indexOf(")")+1));var comp2=eval("new Date(0,0,0,"+tvalue.substring(tvalue.indexOf("(")+1,tvalue.indexOf(")")+1));if(comp1>comp2){alert(L_RangeError);return false}if(minValue.length>0&&maxValue.length>0){var tMinComponents=getTimeFromIETFFormat(minValue);var tMaxComponents=getTimeFromIETFFormat(maxValue);var tMinTEFT=eval("new Date(0,0,0,"+tMinComponents[0]+","+tMinComponents[1]+","+tMinComponents[2]+")");var tMaxTEFT=eval("new Date(0,0,0,"+tMaxComponents[0]+","+tMaxComponents[1]+","+tMaxComponents[2]+")");var index1=minValue.indexOf(" PM ");if(index1>-1){tMinTEFT.setTime(tMinTEFT.getTime()+(12*3600*1000))}var index2=maxValue.indexOf(" PM ");if(index2>-1){tMaxTEFT.setTime(tMaxTEFT.getTime()+(12*3600*1000))}var tMin=Date.parse(tMinTEFT);var tMax=Date.parse(tMaxTEFT);var tComp1=Date.parse(comp1);var tComp2=Date.parse(comp2);if(tComp1<tMin||tComp2>tMax){alert(errorMessage);return false}}}else{if(type=="dt"){var comp1=NeutralDT2Date(fvalue);var comp2=NeutralDT2Date(tvalue);if(comp1>comp2){alert(L_RangeError);return false}if(minValue.length>0&&maxValue.length>0){var dtMin=Date.parse(minValue);var dtMax=Date.parse(maxValue);var offset1=comp1.getTimezoneOffset()*60*1000;var offset2=comp2.getTimezoneOffset()*60*1000;var dtComp1=Date.parse(comp1)-offset1;var dtComp2=Date.parse(comp2)-offset2;if(dtComp1<dtMin||dtComp2>dtMax){alert(errorMessage);return false}}}else{if(type=="text"||type=="s"){if(fvalue.toLowerCase()>tvalue.toLowerCase()){alert(L_RangeError);return false}if(minValue.length>0&&maxValue.length>0){if(fvalue.length<eval(DelocalizeNum(minValue))||fvalue.length>eval(DelocalizeNum(maxValue))||tvalue.length>eval(DelocalizeNum(maxValue))||tvalue.length<eval(DelocalizeNum(minValue))){alert(errorMessage);return false}}}}}}}return true}function DelocalizeNum(d){var e=d.replace(/\s/g,"");var a="";var b=e.indexOf(groupSep);while(b!=-1){a+=e.substr(0,b);e=e.substr(b+groupSep.length,e.length-b-groupSep.length);b=e.indexOf(groupSep)}a+=e;b=a.indexOf(decimalSep);var c="";if(b!=-1){c+=a.substr(0,b);c+=".";c+=a.substr(b+decimalSep.length,a.length-b-decimalSep.length)}else{c=a}return c}var isEnabledLanguage=(!((userLanguage=="ja")||(userLanguage=="ko")||(userLanguage=="zh")));var isNav=(navigator.appName=="Netscape");if(isEnabledLanguage){if(isNav){document.captureEvents(Event.KEYUP)}document.onkeyup=checkValue}function checkValue(a){var b="";if(isNav){if(a.which==13&&(a.target.type=="text"||a.target.type=="password")){b=a.target.value}}else{if(window.event.keyCode==13&&(window.event.srcElement.type=="text"||window.event.srcElement.type=="password")){b=window.event.srcElement.value}}if(b!=""){submitValues()}}function getTimeFromIETFFormat(a){var c=a.split(" ");for(var b=0;b<c.length;b++){var d=c[b].split(":");if(d.length>1){return d}}};