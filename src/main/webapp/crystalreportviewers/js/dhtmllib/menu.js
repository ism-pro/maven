_menusZIndex=2000;_menusItems=new Array;_globMenuCaptured=null;_isColor=0;_isLastUsedColor=1;_isNotColor=2;_currentFocus=null;_mitemH=22;function newMenuWidget(e,a,c){var b=newWidget(e);b.items=new Array;b.par=null;b.container=null;b.currentSub=-1;b.nextSub=-1;b.zIndex=_menusZIndex;b.hideCB=a;b.beforeShowCB=c;b.init=MenuWidget_init;b.justInTimeInit=MenuWidget_justInTimeInit;b.getHTML=MenuWidget_getHTML;b.show=MenuWidget_show;b.internalAdd=b.add=MenuWidget_add;b.addCheck=MenuWidget_addCheck;b.addSeparator=MenuWidget_addSeparator;b.insert=MenuWidget_insert;b.insertCheck=MenuWidget_insertCheck;b.insertSeparator=MenuWidget_insertSeparator;b.getItem=MenuWidget_getItem;b.getItemByID=MenuWidget_getItemByID;b.isShown=MenuWidget_isShown;b.remove=MenuWidget_remove;b.removeByID=MenuWidget_removeByID;b.showSub=MenuWidget_showSub;b.captureClicks=MenuWidget_captureClicks;b.releaseClicks=MenuWidget_releaseClicks;b.focus=MenuWidget_focus;b.restoreFocus=MenuWidget_restoreFocus;b.hasVisibleItem=MenuWidget_hasVisibleItem;b.updateIndex=MenuWidget_updateIndex;b.clickCB=new Array;b.clickCBDocs=new Array;b.write=MenuWidget_write;b.alignLeft=false;b.sepCount=0;return b}function MenuWidget_captureClicks(c){var g=this;if(g.par==null){if(c==null){_globMenuCaptured=g;g.clickCB.length=0;g.clickCBDocs.length=0;c=_curWin}if(canScanFrames(c)){if(_moz){_oldErrHandler=window.onerror;window.onerror=localErrHandler}try{d=c.document;g.clickCB[g.clickCB.length]=d.onmousedown;g.clickCBDocs[g.clickCBDocs.length]=d;d.onmousedown=MenuWidget_globalClick;var b=c.frames,a=b.length;for(var e=0;e<a;e++){g.captureClicks(b[e])}}catch(f){}if(_moz){window.onerror=_oldErrHandler}}}}function MenuWidget_releaseClicks(){var e=this;if(e.par==null){var a=e.clickCB.length;for(var b=0;b<a;b++){try{e.clickCBDocs[b].onmousedown=e.clickCB[b]}catch(c){}e.clickCB[b]=null;e.clickCBDocs[b]=null}e.clickCB.length=0;e.clickCBDocs.length=0}}_menuItem=null;function MenuWidget_focus(){var e=this,b=e.items,a=b.length;for(var c=0;c<a;c++){if(b[c].isShown&&!b[c].isSeparator){_menuItem=b[c];setTimeout("_menuItem.focus()",1);if(e.endLink){e.endLink.show(true)}if(e.startLink){e.startLink.show(true)}break}}}function MenuWidget_keepFocus(b){var a=getWidget(getLayer(b));if(a){a.focus()}}function MenuWidget_restoreFocus(){var a=this;if(a.endLink){a.endLink.show(false)}if(a.startLink){a.startLink.show(false)}if(a.parIcon){a.parIcon.focus()}else{if(a.par){a.par.focus()}else{if(a.parCalendar){a.parCalendar.focus()}}}}function MenuWidget_keyDown(f,b){var c=getWidget(getLayer(f));var a=eventGetKey(b);if(a==27&&c){c.restoreFocus();c.show(false);if(c.par&&c.par.par){c.par.par.currentSub=-1}c.currentSub=-1;eventCancelBubble(b)}else{if(c&&(a==109||a==37)){if(c.par&&c.par.par){c.restoreFocus();c.show(false);c.par.par.currentSub=-1;c.currentSub=-1}}else{if(a==13){eventCancelBubble(b)}}}}function MenuWidget_globalClick(){var a=_globMenuCaptured;if(a!=null){_globMenuCaptured=null;a.releaseClicks();a.show(false)}}function MenuWidget_add(b,l,e,k,p,m,f,a,n,h){var c=this,g=c.items.length;var j=c.items[g]=newMenuItem(c,b,l,e,k,p,m,f,a,n,false,h);j.menuIndex=g;j.dynHTML();return j}function MenuWidget_addCheck(b,l,e,k,p,m,f,a,n,h){var c=this,g=c.items.length;var j=c.items[g]=newMenuItem(c,b,l,e,k,p,m,f,a,n,true,h);j.menuIndex=g;j.dynHTML();return j}function MenuWidget_addSeparator(){var a=this.internalAdd("_menusep_"+(this.sepCount++));a.isSeparator=true;return a}function MenuWidget_insert(h,b,j,e,i,n,l,f,a,m,g){var c=this,k=newMenuItem(c,b,j,e,i,n,l,f,a,m,false,g);arrayAdd(c,"items",k,h);c.updateIndex();k.dynHTML();return k}function MenuWidget_insertCheck(h,b,j,e,i,n,l,f,a,m,g){var c=this,k=newMenuItem(c,b,j,e,i,n,l,f,a,m,true,g);arrayAdd(c,"items",k,h);c.updateIndex();k.dynHTML();return k}function MenuWidget_insertSeparator(a){var b=newMenuItem(this,"_menusep_"+(this.sepCount++));b.isSeparator=true;arrayAdd(this,"items",b,a);this.updateIndex();b.dynHTML();return b}function MenuWidget_init(){}function MenuWidget_getItem(b){var c=this,a=c.items;if((b>=0)&&(b<a.length)){return a[b]}return null}function MenuWidget_getItemByID(e){var c=this,a=c.items;for(var b in a){if(a[b].id==e){return a[b]}}return null}function MenuWidget_removeByID(e){var c=this;var b=c.getItemByID(e);if(b){arrayRemove(c,"items",b.menuIndex);c.updateIndex();if(c.layer==null){return}var a=c.layer.childNodes[0];a.deleteRow(b.menuIndex)}}function MenuWidget_remove(b){var c=this;if(b!=null){arrayRemove(c,"items",b);c.updateIndex()}else{c.items.length=0}if(c.layer==null){return}if(b!=null){var a=c.layer.childNodes[0];a.deleteRow(b)}}function MenuWidget_updateIndex(){var b=this.items,a=b.length;for(var c=0;c<a;c++){b[c].menuIndex=c}}function MenuWidget_showSub(){var b=this;if(b.nextSub!=-1){if(b.nextSub!=b.currentSub){var j=b.items[b.currentSub];if(j&&j.sub){j.sub.show(false);b.currentSub=-1}var a=b.items[b.nextSub];if(a&&a.sub){var e=a.layer;var g=parseInt(b.css.left);var f=parseInt(b.css.top);for(var c=0;c<b.nextSub;c++){var k=b.items[c];if(k.isShown){if((k.icon!=null)||(k.text!=null)){f+=_mitemH}else{f+=3}}}var h=b.getWidth();g=g+h-4;a.attachSubMenu(a.sub);a.sub.show(true,g,f,false,h);b.currentSub=b.nextSub}}}else{if(b.currentSub!=-1){var j=b.items[b.currentSub];if(j&&j.sub){j.sub.show(false);b.currentSub=-1}}}}function MenuWidget_write(){}function MenuWidget_justInTimeInit(){var c=this;c.layer=getLayer(c.id);if(c.layer==null){targetApp(c.getHTML());c.layer=getLayer(c.id)}c.layer._widget=c.widx;c.css=c.layer.style;c.endLink=newWidget("endLink_"+c.id);c.endLink.init();c.startLink=newWidget("startLink_"+c.id);c.startLink.init();var a=c.items;for(var b in a){a[b].init()}}function MenuWidget_getHTML(){var f=this,b=f.items;var a=' onkeydown="'+_codeWinName+".MenuWidget_keyDown('"+f.id+"',event);return true\" ";var e='<a style="position:absolute;left:-30px;top:-30px; visibility:hidden" id="startLink_'+f.id+'" href="javascript:void(0)" onfocus="'+_codeWinName+".MenuWidget_keepFocus('"+f.id+'\');return false;" ></a><table style="display:none;" class="menuFrame" id="'+f.id+'" cellspacing="0" cellpadding="0" border="0" '+a+' dir="ltr"><tbody>';for(var c in b){e+=b[c].getHTML()}e+='</tbody></table><a style="position:absolute;left:-30px;top:-30px; visibility:hidden" id="endLink_'+f.id+'" href="javascript:void(0)" onfocus="'+_codeWinName+".MenuWidget_keepFocus('"+f.id+"');return false;\" ></a>";return e}function MenuWidget_show(n,l,j,f,c,k){var b=this;if(b.layer==null){b.justInTimeInit()}var g=b.css;if(n){b.iframeLyr=getDynamicBGIFrameLayer();b.iframeCss=b.iframeLyr.style;if(b.beforeShowCB){b.beforeShowCB()}if(!b.hasVisibleItem()){return}b.captureClicks();g.display="block";g.zIndex=(b.zIndex+1);g.visibility="hidden";g.left="-1000px";g.top="-1000px";var m=b.getWidth();var e=b.getHeight();if(b.alignLeft){l-=m}if(k){var p=k.getWidth();if(p>m){l=l+p-m}}var a=l+m+4,i=j+e+4;if(a-getScrollX()>winWidth()){if(k){l=Math.max(0,winWidth()-m)}else{l=Math.max(0,l-4-(m+((c!=null)?c-12:0)))}}if(i-getScrollY()>winHeight()){j=Math.max(0,j-4-e+(c!=null?30:0))}g.left=""+l+"px";g.top=""+j+"px";g.visibility="visible";iCss=b.iframeCss;iCss.left=""+l+"px";iCss.top=""+j+"px";iCss.width=""+m+"px";iCss.height=""+e+"px";iCss.zIndex=b.zIndex-1;iCss.display="block";if(_ie){j-=2;l-=2}b.nextSub=-1;b.showSub();b.focus()}else{if(f&&b.par&&b.par.par){b.par.par.show(n,l,j,f)}if(b.iframeLyr){releaseBGIFrame(b.iframeLyr.id)}g.display="none";if(b.iframeCss){b.iframeCss.display="none"}b.nextSub=-1;b.showSub();if(b.hideCB){b.hideCB()}b.releaseClicks()}}function MenuWidget_isShown(){var a=this;if(a.layer==null){return false}else{return(a.css.display=="block")}}function MenuWidget_hasVisibleItem(){var e=this;if(e.isMenuColor||e.isCalendar){return true}var a=e.items;for(var b in a){var c=a[b];if(c&&!(c.isSeparator==true)&&c.isShown){return true}}return false}function newMenuItem(i,c,k,f,j,n,l,g,b,m,a,h){var e=new Object;e.par=i;e.id=c;e.text=k;e.cb=f;e.icon=j;e.dx=(n==null)?0:n;e.dy=(l==null)?0:l;e.disDx=(b==null)?e.dx:b;e.disDy=(m==null)?e.dy:m;e.sub=null;e.layer=null;e.iconTDLayer=null;e.iconLayer=null;e.textLayer=null;e.textOnlyLayer=null;e.accel=null;e.accelLayer=null;e.hasNoLayer=false;e.isSeparator=false;e.disabled=(g!=null)?g:false;e.isShown=true;e.alt=h;e.index=_menusItems.length;_menusItems[e.index]=e;e.menuIndex=-1;e.isCheck=a;e.checked=false;e.menuItemType=_isNotColor;e.init=MenuItem_init;e.leftZoneClass="menuLeftPart";e.leftZoneSelClass="menuLeftPartSel";e.attachSubMenu=MenuItem_attachSubMenu;e.getHTML=MenuItem_getHTML;e.getHTMLPart=MenuItem_getHTMLPart;e.dynHTML=MenuItem_dynHTML;e.setDisabled=MenuItem_setDisabled;e.check=MenuItem_check;e.isChecked=MenuItem_isChecked;e.show=MenuItem_show;e.setText=MenuItem_setText;e.setIcon=MenuItem_setIcon;e.setAccelerator=MenuItem_setAccelerator;e.focus=MenuItem_focus;return e}function MenuItem_init(){if(!this.hasNoLayer){var a=this,b=a.par.id;a.layer=getLayer(b+"_item_"+a.id);a.layer._boIndex=a.index;if(!a.isSeparator){if((a.icon!=null)||(a.isCheck)){a.iconLayer=getLayer(b+"_item_icon_"+a.id);a.iconTDLayer=getLayer(b+"_item_td_"+a.id)}a.textLayer=getLayer(b+"_text_"+a.id);a.textOnlyLayer=getLayer(b+"_span_text_"+a.id);a.accelLayer=getLayer(b+"_accel_"+a.id);if(a.textOnlyLayer){a.textOnlyLayer.title=a.checked?a.textOnlyLayer.innerText+" "+_menuCheckLab:"";if(a.disabled){a.textOnlyLayer.title+=" "+_menuDisableLab}}}if(a.isCheck){a.check(a.checked,true)}}}function MenuItem_attachSubMenu(c){var b=this;b.sub=c;c.par=b;c.zIndex=b.par.zIndex+2;if(b.layer){if(b.arrowLayer==null){b.arrowLayer=getLayer(b.par.id+"_item_arrow_"+b.id)}var a=b.disabled;changeSimpleOffset(b.arrowLayer,a?7:0,a?81:64)}return c}function MenuItem_check(a,c){var e=this;if((e.checked!=a)||c){e.checked=a;if(e.par.layer){var b=e.layer;if(b){if(e.icon==null){changeSimpleOffset(e.iconLayer,0,(e.checked?48:0),null,(e.checked?_menuCheckLab:""))}changeOffset(e.iconTDLayer,0,(e.checked?96:0));if(e.checkFrame==null){e.checkFrame=getLayer(e.par.id+"_item_check_"+e.id)}e.checkFrame.className="menuIcon"+(e.checked?"Check":"");if(e.textOnlyLayer){e.textOnlyLayer.title=e.checked?e.textOnlyLayer.innerText+" "+_menuCheckLab:""}}}}}function MenuItem_setDisabled(a){var c=this;if(c.disabled!=a){c.disabled=a;if(c.par.layer){var b=c.layer;if(b){b.style.cursor=a?"default":_hand;if(c.icon){changeSimpleOffset(c.iconLayer,a?c.disDx:c.dx,a?c.disDy:c.dy)}var e="menuTextPart"+(c.disabled?"Disabled":"");if(e!=c.textLayer.className){c.textLayer.className=e}if(c.accel&&(e!=c.accelLayer.className)){c.accelLayer.className=e}if(c.sub){if(c.arrowLayer==null){c.arrowLayer=getLayer(c.par.id+"_item_arrow_"+c.id)}changeSimpleOffset(c.arrowLayer,a?7:0,a?81:64)}if(c.textOnlyLayer){c.textOnlyLayer.title=c.disabled?c.textOnlyLayer.innerText+" "+_menuDisableLab:""}}}}}function _mii(g,h){var k=g.childNodes,l=0,j=k.length,m=g._boIndex;var b=_menusItems[m];if(b.disabled){h=0}else{if(h){b.par.nextSub=b.menuIndex;MenuItem_callShowSub(m,true);if(b.par.par){if(b.par.par.par){b.par.par.par.nextSub=b.par.par.menuIndex}}}}var e=0;for(var f=0;f<j;f++){var a=k[f];if(a.tagName!=null){if(e==0){a.className=h?b.leftZoneSelClass:b.leftZoneClass}else{if(e==1){a.className="menuTextPart"+(h?"Sel":"")+(b.disabled?"Disabled":"")}else{if(b.accel&&(e==2)){a.className="menuTextPart"+(h?"Sel":"")+(b.disabled?"Disabled":"");break}else{a.className="menuRightPart"+(h?"Sel":"")}}}e++}}}function MenuItem_getHTMLPart(b){var h=this;switch(b){case 0:var a=null,g=' class="menuIcon'+(h.checked?"Check":"")+'"';if(h.isCheck&&(h.icon==null)){a=simpleImgOffset(_skin+"menus.gif",16,16,0,h.checked?48:0,(h.par.id+"_item_icon_"+h.id),null,(h.checked?_menuCheckLab:""))}else{a=h.icon?simpleImgOffset(h.icon,16,16,h.disabled?h.disDx:h.dx,h.disabled?h.disDy:h.dy,(h.par.id+"_item_icon_"+h.id),null,h.alt?h.alt:""):(getSpace(16,16))}if(h.isCheck){var e=_ie?18:16;a='<div id="'+h.par.id+"_item_check_"+h.id+'" class="menuIcon'+(h.checked?"Check":"")+'" style="width:'+e+"px;height:"+e+'px;padding:1px">'+a+"</div>"}return a;case 1:var f=_saf?'<div style="height:19px;padding-top:5px">':"",c=_saf?"</div>":"";return f+'<span id="'+(h.par.id+"_span_text_"+h.id)+'" tabIndex="0">'+convStr(h.text)+"</span>"+c;case 2:return simpleImgOffset(_skin+"menus.gif",16,16,h.sub?(h.disabled?7:0):0,h.sub?(h.disabled?81:64):0,h.par.id+"_item_arrow_"+h.id,null,null,null,"right");case 3:return'<table width="100%" height="3" cellpadding="0" cellspacing="0" border="0" style="'+backImgOffset(_skin+"menus.gif",0,80)+';"><tbody><tr><td></td></tr></tbody></table>';case 4:return convStr(h.accel)}}function MenuItem_getHTML(){var f=this;if((f.icon!=null)||(f.text!=null)){var e=' onclick="'+_codeWinName+'._micl(this,event);return true" oncontextmenu="'+_codeWinName+'._micl(this,event);return false" onmouseover="'+_codeWinName+'._mii(this,1)" onmouseout="'+_codeWinName+'._mii(this,0);" ';var a=' onkeydown="'+_codeWinName+'._mikd(this,event);return true" ';var b=new Array(),c=0;b[c++]='<tr onmousedown="'+_codeWinName+'._minb(event)" onmouseup="'+_codeWinName+'._minb(event)" id="'+(f.par.id+"_item_"+f.id)+'" style="'+(!f.isShown?"display:none;":"")+"height:"+_mitemH+"px;width:24px;cursor:"+(f.disabled?"default":_hand)+'" '+e+a+' valign="middle">';b[c++]='<td id="'+(f.par.id+"_item_td_"+f.id)+'" style="width:23px;height:'+_mitemH+'px;" align="center" class="'+f.leftZoneClass+'">';b[c++]=f.getHTMLPart(0);b[c++]="</td>";b[c++]="<td "+(f.centered?' align="center" ':"")+' style="height:'+_mitemH+'px" id="'+(f.par.id+"_text_"+f.id)+'" class="menuTextPart'+(f.disabled?"Disabled":"")+'">';b[c++]=f.getHTMLPart(1);b[c++]="</td>";if(f.accel!=null){b[c++]='<td class="menuTextPart'+(f.disabled?"Disabled":"")+'" id="'+(f.par.id+"_accel_"+f.id)+'" align="right" style="height:'+_mitemH+'px"  tabIndex="-1">';b[c++]=f.getHTMLPart(4);b[c++]="</td>"}else{b[c++]='<td class="menuRightPart" align="right" style="width:40px;height:'+_mitemH+'px;" >';b[c++]=f.getHTMLPart(2);b[c++]="</td>"}b[c++]="</tr>";return b.join("")}else{return'<tr onmousedown="'+_codeWinName+'._minb(event)" onclick="'+_codeWinName+'._minb(event)" id="'+(f.par.id+"_item_"+f.id)+'" onmouseup="'+_codeWinName+'._minb(event)" style="height:3px"><td class="'+f.leftZoneClass+'" style="width:24px;height:3px;border:0px"></td><td colspan="2" style="padding-left:5px;padding-right:5px;border:0px">'+f.getHTMLPart(3)+"</td></tr>"}}function MenuItem_dynHTML(){var a=this;if(a.par.layer==null){return}var g=a.par.layer.childNodes[0],j=g.insertRow(a.menuIndex),k=j.style;j.onmousedown=_minb;j.onmouseup=_minb;j.id=(a.par.id+"_item_"+a.id);if((a.icon!=null)||(a.text!=null)){var e=j.insertCell(0),c=j.insertCell(1),b=j.insertCell(2),i=e.style,h=c.style,f=b.style;j.onclick=MenuItem_clickCallTrue;j.oncontextmenu=MenuItem_clickCallFalse;j.onmouseover=MenuItem_invertCall1;j.onmouseout=MenuItem_invertCall0;k.height=""+_mitemH+"px";k.width="24px";k.cursor=(a.disabled?"default":_hand);e.id=(a.par.id+"_item_td_"+a.id);i.width="23px";i.height=""+_mitemH+"px";e.innerHTML=a.getHTMLPart(0);e.align="center";e.className=a.leftZoneClass;if(a.centered){c.align="center"}h.height=""+_mitemH+"px";c.id=(a.par.id+"_text_"+a.id);c.className="menuTextPart"+(a.disabled?"Disabled":"");c.innerHTML=a.getHTMLPart(1);if(a.accel){b.className="menuTextPart"+(a.disabled?"Disabled":"");b.align="right";f.height=""+_mitemH+"px";b.innerHTML=a.getHTMLPart(4)}else{b.className="menuRightPart";b.align="right";f.width="40px";f.height=""+_mitemH+"px";changeOffset(b,0,0,_skin+"menus.gif");b.innerHTML=a.getHTMLPart(2)}a.init()}else{j.onclick=_minb;j.style.height="3px";var e=j.insertCell(0),c=j.insertCell(1),i=e.style,h=c.style;e.className=a.leftZoneClass;i.width="24px";i.height="3px";i.border="0px";c.colSpan="2";h.paddingLeft="5px";h.paddingRight="5px";c.innerHTML=a.getHTMLPart(3)}}function MenuItem_isChecked(){return this.checked}function MenuItem_setText(a){var b=this,c=b.par.id;b.text=a;if(b.textLayer){b.textLayer.innerHTML=b.getHTMLPart(1);b.textOnlyLayer=getLayer(c+"_span_text_"+b.id)}}function MenuItem_setAccelerator(b,a){var c=this,e=c.par.id;c.accel=((a!=null)?_modifiers[a]:"")+b;if(c.accelLayer){c.accelLayer.innerHTML=c.getHTMLPart(4)}}function MenuItem_setIcon(b,a,f,e,c){var g=this;g.url=c?c:g.url;g.dx=(b!=null)?b:g.dx;g.dy=(a!=null)?a:g.dy;g.disDx=(f!=null)?f:g.disDx;g.disDy=(e!=null)?e:g.disDy;if(g.icon&&g.iconLayer){changeSimpleOffset(g.iconLayer,g.disabled?g.disDx:g.dx,g.disabled?g.disDy:g.dy,g.url)}}function MenuItem_show(a){var b=this;b.isShown=a;if(b.layer!=null){b.layer.style.display=a?"":"none"}}function _micl(b,c){eventCancelBubble(c);var a=b._boIndex,f=_menusItems[a];f.layer=b;if(!f.disabled){if(f.sub){f.par.nextSub=f.menuIndex;MenuItem_callShowSub(a)}else{f.par.show(false,0,0,true);if(f.isCheck){if(f.par.uncheckAll){f.par.uncheckAll()}f.check(!f.checked)}if(f.par.container&&f.par.container.updateButton){f.par.container.updateButton(a)}_mii(b,0,a);f.par.nextSub=-1;if(f.cb){setTimeout("MenuItem_delayedClick("+a+")",1)}}}}function _mikd(g,j){var b=g._boIndex,l=_menusItems[b];l.layer=g;var f=eventGetKey(j);switch(f){case 13:_micl(g,j);break;case 107:case 39:if(!l.disabled&&l.sub){_micl(g,j)}break;case 109:case 37:break;case 40:var c=l.par.items,a=c.length;for(var h=l.menuIndex+1;h<a;h++){if(c[h].isShown&&!c[h].isSeparator){c[h].focus();break}}break;case 38:var c=l.par.items,a=c.length;for(var h=l.menuIndex-1;h>=0;h--){if(c[h].isShown&&!c[h].isSeparator){c[h].focus();break}}break}}function MenuItem_callShowSub(a,b){var c=_menusItems[a];if(b){setTimeout("MenuItem_delayedShowSub("+a+")",500)}else{MenuItem_delayedShowSub(a)}}function MenuItem_delayedShowSub(a){var b=_menusItems[a];b.par.showSub()}function _minb(a){eventCancelBubble(a)}function MenuItem_delayedClick(a){var b=_menusItems[a];if(b.cb){b.cb()}}function MenuItem_clickCallTrue(a){_micl(this,a);return true}function MenuItem_clickCallFalse(a){_micl(this,a);return false}function MenuItem_invertCall0(a){_mii(this,0)}function MenuItem_invertCall1(a){_mii(this,1)}function MenuItem_focus(){var a=this;if(isLayerDisplayed(a.layer)&&a.textOnlyLayer&&a.textOnlyLayer.focus){a.textOnlyLayer.focus()}}function newMenuColorWidget(c,a){var b=newMenuWidget(c,a);b.addSeparator=null;b.lastUsedTxt="";b.lastUsedColorsAr=null;b.addColor=MenuColorWidget_addColor;b.addLastUsed=MenuColorWidget_addLastUsed;b.getHTML=MenuColorWidget_getHTML;b.uncheckAll=MenuColorWidget_uncheckAll;b.isMenuColor=true;return b}function MenuColorWidget_addColor(f,b,a){var g=this,e=g.items.length;var c=g.items[e]=newColorMenuItem(g,b,f,a);c.menuIndex=e;return c}function MenuColorWidget_addLastUsed(g,b,a,i){var f=this;f.lastUsedTxt=g;f.lastUsedColorsAr=b;f.beforeShowCB=MenuColorWidget_beforeShowCB;colorsMax=8;len=f.items.length;var e=null;for(var h=0;h<colorsMax;h++){e=newLastUsedColorMenuItem(f,h,b[h],"",a);e.isLast=(h==colorsMax-1)?true:false;f.items[len+h]=e}}function MenuColorWidget_getHTML(){var a=this,f=a.items;var b=0;var h=' onkeydown="'+_codeWinName+".MenuWidget_keyDown('"+a.id+"',event);return true\" ";var k=new Array;k[b++]='<a style="position:absolute;left:-30px;top:-30px; visibility:hidden" id="startLink_'+a.id+'" href="javascript:void(0)" onfocus="'+_codeWinName+".MenuWidget_keepFocus('"+a.id+"');return false;\" ></a>";k[b++]='<table style="display:none;" class="menuFrame" id="'+a.id+'" cellspacing="0" cellpadding="0" border="0"'+h+"><tbody>";var l='<tr style="height:3px"><td colspan="8" style="padding-left:5px;padding-right:5px;"><table width="100%" height="3" cellpadding="0" cellspacing="0" border="0" style="'+backImgOffset(_skin+"menus.gif",0,80)+';"><tbody><tr><td></td></tr></tbody></table></td></tr>';var e=f.length;lastUsedCol="";lastUsedColIconsNb=0;lastUsedColIconsMaxLine=3;for(var c in f){var g=f[c];switch(g.menuItemType){case _isColor:k[b++]=g.getHTML();break;case _isLastUsedColor:lastUsedCol+=g.getHTML();lastUsedCol+=(lastUsedColIconsNb++==lastUsedColIconsMaxLine)?"</tr><tr>":"";if(g.isLast){k[b++]=l;k[b++]='<tr><td colspan="8">';k[b++]='<table border="0" cellspacing="0" cellpadding="0" width="100%"><tbody><tr>';k[b++]='<td width="50%" class="menuTextPart">'+convStr(a.lastUsedTxt)+"</td>";k[b++]='<td><table border="0" cellspacing="0" cellpadding="0"><tbody><tr>';k[b++]=lastUsedCol;k[b++]="</tr></tbody></table></td>";k[b++]="</tr></tbody></table>";k[b++]="</td></tr>";k[b++]=l}break;case _isNotColor:g.leftZoneClass="menuLeftPartColor";g.leftZoneSelClass="menuLeftPartSel";g.centered=true;k[b++]='<tr><td colspan="8"><table border="0" cellspacing="0" cellpadding="0" width="100%"><tbody><tr>'+g.getHTML()+"</tr></tbody></table></td></tr>";k[b++]=(c==0)?l:""}}k[b++]='</tbody></table><a style="position:absolute;left:-30px;top:-30px; visibility:hidden" id="endLink_'+a.id+'" href="javascript:void(0)" onfocus="'+_codeWinName+".MenuWidget_keepFocus('"+a.id+"');return false;\" ></a>";return k.join("")}function MenuColorWidget_beforeShowCB(){var g=this,a=0;lenLastUsed=g.lastUsedColorsAr.length;if((lenLastUsed==1)&&((g.lastUsedColorsAr[0].length==0)||(g.lastUsedColorsAr[0]=="null"))){lenLastUsed=0;g.lastUsedColorsAr.length=0}for(var e in g.items){var f=g.items[e];if(f.menuItemType==_isLastUsedColor){if(a<lenLastUsed){f.init();var h=g.lastUsedColorsAr[a++];f.color=h;f.layer.childNodes[0].childNodes[0].style.backgroundColor="rgb("+h+")";var b=_colorsArr[""+h+""];f.text=(b)?b:(_RGBTxtBegin+h+_RGBTxtEnd);f.layer.childNodes[0].childNodes[0].childNodes[0].title=f.text;f.show(true)}else{f.show(false)}}}}function MenuColor_invert(b,a){var c=_menusItems[b._boIndex];if(c&&c.checked){a=1}b.childNodes[0].className="menuColor"+(a?"sel":"")}function MenuColor_out(){MenuColor_invert(this,0)}function _Mcov(a){a.onmouseout=MenuColor_out;MenuColor_invert(a,1)}function MenuColorWidget_uncheckAll(){var e=this,a=e.items;for(var b in a){var c=a[b];if(c.checked){c.check(false)}}}function _mcc(b,c){eventCancelBubble(c);var a=b._boIndex,f=_menusItems[a];f.par.uncheckAll();MenuColor_invert(b,1,a);f.checked=true;f.par.show(false,0,0,true);if(f.cb){setTimeout("MenuItem_delayedClick("+a+")",1)}}function newColorMenuItem(c,b,f,a){var e=newMenuItem(c,"color_"+b,f,a);e.color=b;e.attachSubMenu=null;e.getHTML=ColorMenuItem_getHTML;e.check=ColorMenuItem_check;e.menuItemType=_isColor;return e}function ColorMenuItem_check(a){var b=this;if(b.checked!=a){b.checked=a;if(b.layer){MenuColor_invert(b.layer,b.checked?1:0)}}}function ColorMenuItem_getHTML(){var a=this,n="",k=_moz?10:12,f=a.par.items.length,g=a.menuIndex-1;col=g%8;var h=0;for(var c=0;c<f;c++){if(a.par.items[c].menuItemType==_isColor){h++}}var e=(col==0);var m=(col==7);var l=(g<8);var j=(g>=(Math.floor((h-1)/8)*8));var b=' onclick="'+_codeWinName+'._mcc(this,event);return true" oncontextmenu="'+_codeWinName+'._mcc(this,event);return false" onmousedown="'+_codeWinName+'._minb(event)" onmouseup="'+_codeWinName+'._minb(event)" onmouseover="'+_codeWinName+'._Mcov(this)" ';if(e){n+='<tr valign="middle" align="center">'}n+='<td id="'+(a.par.id+"_item_"+a.id)+'" '+b+' style="padding-top:'+(l?2:0)+"px;padding-bottom:"+(j?2:0)+"px;padding-left:"+(e?3:1)+"px;padding-right:"+(m?3:1)+'px"><div class="menuColor'+(a.checked?"Sel":"")+'"><div style="cursor:'+_hand+";border:1px solid #4A657B;width:"+k+"px;height:"+k+"px;background-color:rgb("+a.color+');">'+img(_skin+"../transp.gif",10,10,null,null,a.text)+"</div></div></td>";if(m){n+="</tr>"}return n}function newLastUsedColorMenuItem(e,b,c,g,a){var f=newMenuItem(e,"color_"+b,g,a);f.idx=b;f.color=c;f.menuItemType=_isLastUsedColor;f.attachSubMenu=null;f.check=ColorMenuItem_check;f.getHTML=LastUsedColorMenuItem_getHTML;f.init=LastUsedColorMenuItem_init;return f}function LastUsedColorMenuItem_getHTML(){var e=this,b="",c=_moz?10:12;var a=' onclick="'+_codeWinName+'._mcc(this,event);return true" oncontextmenu="'+_codeWinName+'._mcc(this,event);return false" onmousedown="'+_codeWinName+'._minb(event)" onmouseup="'+_codeWinName+'._minb(event)" onmouseover="'+_codeWinName+'._Mcov(this)" ';b+='<td id="'+(e.par.id+"_item_"+e.id)+'" width="18" '+a+' style="padding-top:0px;padding-bottom:0px;padding-left:1px;padding-right:1px"><div class="menuColor'+(e.checked?"sel":"")+'"><div style="cursor:'+_hand+";border:1px solid #4A657B;width:"+c+"px;height:"+c+"px;background-color:rgb("+e.color+');">'+img(_skin+"../transp.gif",10,10,null,null,e.text)+"</div></div></td>";return b}function LastUsedColorMenuItem_init(){if(!this.hasNoLayer){var a=this,b=a.par.id;a.layer=getLayer(b+"_item_"+a.id);a.layer._boIndex=a.index;if(a.isCheck){a.check(a.checked,true)}}}function newScrollMenuWidget(a,j,i,b,p,n,l,h,g,k,e,m,f){var c=newWidget(a);c.list=newListWidget("list_"+a,ScrollMenuWidget_changeCB,i,b,p,n,ScrollMenuWidget_dblClickCB,ScrollMenuWidget_keyUpCB,ScrollMenuWidget_clickCB);c.list.par=c;c.label=NewLabelWidget("label_"+a,k,e);c.showLabel=g;c.changeCB=j;c.menuClickCB=f;c.dblClickCB=l;c.keyUpCB=h;c.beforeShowCB=m;c.zIndex=_menusZIndex;c.init=ScrollMenuWidget_init;c.justInTimeInit=ScrollMenuWidget_justInTimeInit;c.setDisabled=ScrollMenuWidget_setDisabled;c.write=ScrollMenuWidget_write;c.getHTML=ScrollMenuWidget_getHTML;c.show=ScrollMenuWidget_show;c.add=ScrollMenuWidget_add;c.del=ScrollMenuWidget_del;c.getSelection=ScrollMenuWidget_getSelection;c.select=ScrollMenuWidget_select;c.valueSelect=ScrollMenuWidget_valueSelect;c.getCount=ScrollMenuWidget_getCount;c.isShown=MenuWidget_isShown;c.captureClicks=MenuWidget_captureClicks;c.releaseClicks=MenuWidget_releaseClicks;c.clickCB=new Array;c.clickCBDocs=new Array;return c}function ScrollMenuWidget_init(){}function ScrollMenuWidget_justInTimeInit(){var a=this;a.layer=getLayer(a.id);if(a.layer==null){append2(_curDoc.body,a.getHTML());a.layer=getLayer(a.id)}a.layer._widget=a.widx;a.css=a.layer.style;a.css.visibility="hidden";a.list.init();a.label.init()}function ScrollMenuWidget_setDisabled(){}function ScrollMenuWidget_write(){}function ScrollMenuWidget_getHTML(){var b=this;var a="";a+='<table dir="ltr" onmousedown="event.cancelBubble=true" id="'+b.id+'" style="display:none;" class="menuFrame" cellspacing="0" cellpadding="0" border="0"><tbody>';a+='<tr><td align="center">'+b.list.getHTML()+"</td></tr>";a+='<tr><td align="center">'+b.label.getHTML()+"</td></tr>";a+="</tbody></table>";return a}function ScrollMenuWidget_show(j,i,g){var b=this;if(b.layer==null){b.justInTimeInit()}var e=b.css;if(j){if(b.beforeShowCB){b.beforeShowCB()}b.captureClicks();e.display="block";e.zIndex=(b.zIndex+1);e.visibility="hidden";e.left="-1000px";e.top="-1000px";var k=b.getWidth();var c=b.getHeight();if(b.alignLeft){i-=k}var a=i+k+4,f=g+c+4;if(a>winWidth()){i=Math.max(0,i-4-k)}if(f>winHeight()){g=Math.max(0,g-4-c)}e.left=""+i+"px";e.top=""+g+"px";e.visibility="visible";b.iframeLyr=getDynamicBGIFrameLayer();b.iframeCss=b.iframeLyr.style;iCss=b.iframeCss;iCss.left=""+i+"px";iCss.top=""+g+"px";iCss.width=""+k+"px";iCss.height=""+c+"px";iCss.zIndex=b.zIndex-1;iCss.display="block";if(_ie){g-=2;i-=2}}else{releaseBGIFrame(b.iframeLyr.id);e.display="none";iCss.display="none";b.releaseClicks()}}function ScrollMenuWidget_add(a,e,b,f){var c=this;if(c.layer==null){c.justInTimeInit()}c.list.add(a,e,b,f)}function ScrollMenuWidget_del(a){var b=this;if(b.layer==null){b.justInTimeInit()}b.list.del(a)}function ScrollMenuWidget_getSelection(){var a=this;if(a.layer==null){a.justInTimeInit()}return a.list.getSelection()}function ScrollMenuWidget_select(a){var b=this;if(b.layer==null){b.justInTimeInit()}b.list.select(a)}function ScrollMenuWidget_valueSelect(a){var b=this;if(b.layer==null){b.justInTimeInit()}b.list.valueSelect(a)}function ScrollMenuWidget_getCount(){var a=this;if(a.layer==null){a.justInTimeInit()}return a.list.getCount()}function ScrollMenuWidget_changeCB(){var a=this;if(a.par.changeCB){a.par.changeCB()}}function ScrollMenuWidget_clickCB(){var a=this;a.par.show(false);if(a.par.menuClickCB){a.par.menuClickCB()}}function ScrollMenuWidget_dblClickCB(){var a=this;a.par.show(false);if(a.par.dblClickCB){a.par.dblClickCB()}}function ScrollMenuWidget_keyUpCB(c){var g=13,b=27;var f=this;var a=eventGetKey(c);if(a==g||a==b){f.par.show(false)}if(f.par.keyUpCB){f.par.keyUpCB()}}function newButtonScrollMenuWidget(a,p,m,h,e,l,j,k,s,g,n,i,r,f,c,q){var b=newButtonWidget(a,p,ButtonScrollMenuWidget_clickCB,m,null,h,e,0,_skin+"menus.gif",7,16,0,81,true,0,97);b.menu=newScrollMenuWidget("scrollMenu_menu_"+a,l,j,k,s,g,n,i,r,f,c,q);b.getMenu=IconMenuWidget_getMenu;b.add=ButtonScrollMenuWidget_add;return b}function ButtonScrollMenuWidget_clickCB(){var b=this,a=b.layer;b.menu.show(!b.menu.isShown(),getPosScrolled(a).x,getPosScrolled(a).y+b.getHeight(),null,null,b)}function ButtonScrollMenuWidget_add(a,c,b,e){this.menu.add(a,c,b,e)}function newBorderMenuItem(f,b,a,e,c){var g=newMenuItem(f,"border_"+b,null,a);g.idx=b;g.isLabel=e?e:false;g.label=c?c:null;g.attachSubMenu=null;g.getHTML=BorderMenuItem_getHTML;g.check=BorderMenuItem_check;g.menuItemType=_isNotColor;return g}function BorderMenuItem_check(a){var b=this;if(b.checked!=a){b.checked=a;if(b.layer){BorderMenuItem_invert(b.layer,b.checked?1:0)}}}function BorderMenuItem_getHTML(){var i=this,g="",h=_moz?10:12,f=i.par.items.length,c=i.menuIndex-1;col=c%8;var b=' onclick="'+_codeWinName+'.MenuBordersWidget_onclickCB(this,event);return true" oncontextmenu="'+_codeWinName+'.MenuBordersWidget_onclickCB(this,event);return false" onmousedown="'+_codeWinName+'._minb(event)" onmouseup="'+_codeWinName+'._minb(event)" onmouseover="'+_codeWinName+'.MenuBordersWidget_onmouseOverCB(this)" ';var e=(i.isLabel?' colspan="4"':"");var a="menuiconborders"+(i.checked?"Sel":"");g+="<td "+e+' id="'+(i.par.id+"_item_"+i.id)+'" '+b+' align="center"><div class="'+a+'">';g+=i.isLabel?convStr(i.label):simpleImgOffset(_skin+"../borders.gif",16,16,16*i.idx,0,"IconImg_"+i.id,null,_bordersTooltip[i.idx],"margin:2px;cursor:default");g+="</div></td>";return g}function BorderMenuItem_invert(b,a){var c=_menusItems[b._boIndex];if(c&&c.checked){a=1}b.childNodes[0].className="menuiconborders"+(a?"Sel":"")}function newMenuBordersWidget(h,b,g,c){var f=newMenuWidget(h,b,g);f.items=new Array;for(var e=0;e<12;e++){f.items[e]=newBorderMenuItem(f,e,c)}var a=f.items.length;f.items[a]=newBorderMenuItem(f,12,c,true,_bordersMoreColorsLabel);f.clickCB=c;f.getHTML=MenuBordersWidget_getHTML;f.hasVisibleItem=MenuBordersWidget_hasVisibleItem;f.uncheckAll=MenuBordersWidget_uncheckAll;return f}function MenuBordersWidget_getHTML(){var f=this,b=f.items;var a=' onkeydown="'+_codeWinName+".MenuWidget_keyDown('"+f.id+"',event);return true\" ";var e='<a style="position:absolute;left:-30px;top:-30px; visibility:hidden" id="startLink_'+f.id+'" href="javascript:void(0)" onfocus="'+_codeWinName+".MenuWidget_keepFocus('"+f.id+"');return false;\" ></a>";e+='<table style="display:none;" class="menuFrame" id="'+f.id+'" cellspacing="0" cellpadding="0" border="0" '+a+"><tbody>";e+="<tr>";for(var c=0;c<=3;c++){e+=b[c].getHTML()}e+="</tr>";e+="<tr>";for(var c=4;c<=7;c++){e+=b[c].getHTML()}e+="</tr>";e+="<tr>";for(var c=8;c<=11;c++){e+=b[c].getHTML()}e+="</tr>";e+="<tr>"+b[12].getHTML()+"</tr>";e+='</tbody></table><a style="position:absolute;left:-30px;top:-30px; visibility:hidden" id="endLink_'+f.id+'" href="javascript:void(0)" onfocus="'+_codeWinName+".MenuWidget_keepFocus('"+f.id+"');return false;\" ></a>";return e}function MenuBordersWidget_hasVisibleItem(){return true}function MenuBordersWidget_uncheckAll(){var e=this,a=e.items;for(var b in a){var c=a[b];if(c.checked){c.check(false)}}}function MenuBordersWidget_onclickCB(b,c){eventCancelBubble(c);var a=b._boIndex,f=_menusItems[a];f.par.uncheckAll();BorderMenuItem_invert(b,1,a);f.checked=true;f.par.show(false,0,0,true);if(f.cb){setTimeout("MenuItem_delayedClick("+a+")",1)}}function MenuBordersWidget_out(){BorderMenuItem_invert(this,0)}function MenuBordersWidget_onmouseOverCB(a){a.onmouseout=MenuBordersWidget_out;BorderMenuItem_invert(a,1)};