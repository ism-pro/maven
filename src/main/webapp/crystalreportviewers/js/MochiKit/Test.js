if(typeof(dojo)!="undefined"){dojo.provide("MochiKit.Test");dojo.require("MochiKit.Base")}if(typeof(JSAN)!="undefined"){JSAN.use("MochiKit.Base",[])}try{if(typeof(MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Test depends on MochiKit.Base!"}if(typeof(MochiKit.Test)=="undefined"){MochiKit.Test={}}MochiKit.Test.NAME="MochiKit.Test";MochiKit.Test.VERSION="1.4";MochiKit.Test.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Test.toString=function(){return this.__repr__()};MochiKit.Test.EXPORT=["runTests"];MochiKit.Test.EXPORT_OK=[];MochiKit.Test.runTests=function(b){if(typeof(b)=="string"){b=JSAN.use(b)}var a=new MochiKit.Test.Suite();a.run(b)};MochiKit.Test.Suite=function(){this.testIndex=0;MochiKit.Base.bindMethods(this)};MochiKit.Test.Suite.prototype={run:function(b){try{b(this)}catch(a){this.traceback(a)}},traceback:function(d){var a=MochiKit.Iter.sorted(MochiKit.Base.items(d));print("not ok "+this.testIndex+" - Error thrown");for(var b=0;b<a.length;b++){var c=a[b];if(c[0]=="stack"){c[1]=c[1].split(/\n/)[0]}this.print("# "+c.join(": "))}},print:function(a){print(a)},is:function(a,d,c){var b=1;var g=null;try{b=MochiKit.Base.compare(a,d)}catch(f){g="Can not compare "+typeof(a)+":"+typeof(d)}if(b){g="Expected value did not compare equal"}if(!b){return this.testResult(true,c)}return this.testResult(false,c,[[g],["got:",a],["expected:",d]])},testResult:function(c,d,b){this.testIndex+=1;if(c){this.print("ok "+this.testIndex+" - "+d);return}this.print("not ok "+this.testIndex+" - "+d);if(b){for(var a=0;a<b.length;a++){this.print("# "+b[a].join(" "))}}},isDeeply:function(o,h,r){var c=MochiKit.Base;var l=1;try{l=c.compare(o,h)}catch(j){}if(l===0){return this.ok(true,r)}var g=c.keys(o);var a=c.keys(h);g.sort();a.sort();if(c.compare(g,a)){var n={};var f;for(f=0;f<g.length;f++){n[g[f]]="got"}for(f=0;f<a.length;f++){if(a[f] in n){delete n[a[f]]}else{n[a[f]]="expected"}}var b=c.keys(n);b.sort();var q=[];var p=[];while(b.length){var d=b.shift();if(d in Object.prototype){continue}(n[d]=="got"?q:p).push(d)}}return this.testResult((!l),msg,(msg?[["got:",o],["expected:",h]]:undefined))},ok:function(a,b){return this.testResult(a,b)}};MochiKit.Test.__new__=function(){var a=MochiKit.Base;this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)};a.nameFunctions(this)};MochiKit.Test.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Test);