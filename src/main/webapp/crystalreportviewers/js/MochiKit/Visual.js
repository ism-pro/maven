if(typeof(dojo)!="undefined"){dojo.provide("MochiKit.Visual");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Style");dojo.require("MochiKit.Color");dojo.require("MochiKit.Iter")}if(typeof(JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Style",[]);JSAN.use("MochiKit.Color",[]);JSAN.use("MochiKit.Iter",[])}try{if(typeof(MochiKit.Base)==="undefined"||typeof(MochiKit.DOM)==="undefined"||typeof(MochiKit.Style)==="undefined"||typeof(MochiKit.Color)==="undefined"||typeof(MochiKit.Iter)==="undefined"){throw""}}catch(e){throw"MochiKit.Visual depends on MochiKit.Base, MochiKit.DOM, MochiKit.Style, MochiKit.Color and MochiKit.Iter!"}if(typeof(MochiKit.Visual)=="undefined"){MochiKit.Visual={}}MochiKit.Visual.NAME="MochiKit.Visual";MochiKit.Visual.VERSION="1.4";MochiKit.Visual.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Visual.toString=function(){return this.__repr__()};MochiKit.Visual._RoundCorners=function(d,b){d=MochiKit.DOM.getElement(d);this._setOptions(b);if(this.options.__unstable__wrapElement){d=this._doWrap(d)}var a=this.options.color;var f=MochiKit.Color.Color;if(this.options.color==="fromElement"){a=f.fromBackground(d)}else{if(!(a instanceof f)){a=f.fromString(a)}}this.isTransparent=(a.asRGB().a<=0);var c=this.options.bgColor;if(this.options.bgColor==="fromParent"){c=f.fromBackground(d.offsetParent)}else{if(!(c instanceof f)){c=f.fromString(c)}}this._roundCornersImpl(d,a,c)};MochiKit.Visual._RoundCorners.prototype={_doWrap:function(d){var b=d.parentNode;var c=MochiKit.DOM.currentDocument();if(typeof(c.defaultView)==="undefined"||c.defaultView===null){return d}var a=c.defaultView.getComputedStyle(d,null);if(typeof(a)==="undefined"||a===null){return d}var f=MochiKit.DOM.DIV({style:{display:"block",marginTop:a.getPropertyValue("padding-top"),marginRight:a.getPropertyValue("padding-right"),marginBottom:a.getPropertyValue("padding-bottom"),marginLeft:a.getPropertyValue("padding-left"),padding:"0px"}});f.innerHTML=d.innerHTML;d.innerHTML="";d.appendChild(f);return d},_roundCornersImpl:function(c,a,b){if(this.options.border){this._renderBorder(c,b)}if(this._isTopRounded()){this._roundTopCorners(c,a,b)}if(this._isBottomRounded()){this._roundBottomCorners(c,a,b)}},_renderBorder:function(d,f){var b="1px solid "+this._borderColor(f);var a="border-left: "+b;var g="border-right: "+b;var c="style='"+a+";"+g+"'";d.innerHTML="<div "+c+">"+d.innerHTML+"</div>"},_roundTopCorners:function(c,a,f){var d=this._createCorner(f);for(var b=0;b<this.options.numSlices;b++){d.appendChild(this._createCornerSlice(a,f,b,"top"))}c.style.paddingTop=0;c.insertBefore(d,c.firstChild)},_roundBottomCorners:function(c,a,f){var d=this._createCorner(f);for(var b=(this.options.numSlices-1);b>=0;b--){d.appendChild(this._createCornerSlice(a,f,b,"bottom"))}c.style.paddingBottom=0;c.appendChild(d)},_createCorner:function(a){var b=MochiKit.DOM;return b.DIV({style:{backgroundColor:a.toString()}})},_createCornerSlice:function(c,d,h,a){var f=MochiKit.DOM.SPAN();var b=f.style;b.backgroundColor=c.toString();b.display="block";b.height="1px";b.overflow="hidden";b.fontSize="1px";var g=this._borderColor(c,d);if(this.options.border&&h===0){b.borderTopStyle="solid";b.borderTopWidth="1px";b.borderLeftWidth="0px";b.borderRightWidth="0px";b.borderBottomWidth="0px";b.height="0px";b.borderColor=g.toString()}else{if(g){b.borderColor=g.toString();b.borderStyle="solid";b.borderWidth="0px 1px"}}if(!this.options.compact&&(h==(this.options.numSlices-1))){b.height="2px"}this._setMargin(f,h,a);this._setBorder(f,h,a);return f},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false,__unstable__wrapElement:false};MochiKit.Base.update(this.options,a);this.options.numSlices=(this.options.compact?2:4)},_whichSideTop:function(){var a=this.options.corners;if(this._hasString(a,"all","top")){return""}var c=(a.indexOf("tl")!=-1);var b=(a.indexOf("tr")!=-1);if(c&&b){return""}if(c){return"left"}if(b){return"right"}return""},_whichSideBottom:function(){var b=this.options.corners;if(this._hasString(b,"all","bottom")){return""}var c=(b.indexOf("bl")!=-1);var a=(b.indexOf("br")!=-1);if(c&&a){return""}if(c){return"left"}if(a){return"right"}return""},_borderColor:function(a,b){if(a=="transparent"){return b}else{if(this.options.border){return this.options.border}else{if(this.options.blend){return b.blendedColor(a)}}}return""},_setMargin:function(f,g,b){var c=this._marginSize(g)+"px";var a=(b=="top"?this._whichSideTop():this._whichSideBottom());var d=f.style;if(a=="left"){d.marginLeft=c;d.marginRight="0px"}else{if(a=="right"){d.marginRight=c;d.marginLeft="0px"}else{d.marginLeft=c;d.marginRight=c}}},_setBorder:function(f,g,b){var c=this._borderSize(g)+"px";var a=(b=="top"?this._whichSideTop():this._whichSideBottom());var d=f.style;if(a=="left"){d.borderLeftWidth=c;d.borderRightWidth="0px"}else{if(a=="right"){d.borderRightWidth=c;d.borderLeftWidth="0px"}else{d.borderLeftWidth=c;d.borderRightWidth=c}}},_marginSize:function(g){if(this.isTransparent){return 0}var f=this.options;if(f.compact&&f.blend){var b=[1,0];return b[g]}else{if(f.compact){var d=[2,1];return d[g]}else{if(f.blend){var a=[3,2,1,0];return a[g]}else{var c=[5,3,2,1];return c[g]}}}},_borderSize:function(c){var b=this.options;var a;if(b.compact&&(b.blend||this.isTransparent)){return 1}else{if(b.compact){a=[1,0]}else{if(b.blend){a=[2,1,1,1]}else{if(b.border){a=[0,2,0,0]}else{if(this.isTransparent){a=[5,3,2,1]}else{return 0}}}}}return a[c]},_hasString:function(b){for(var a=1;a<arguments.length;a++){if(b.indexOf(arguments[a])!=-1){return true}}return false},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return(a.childNodes.length==1&&a.childNodes[0].nodeType==3)}};MochiKit.Visual.roundElement=function(b,a){new MochiKit.Visual._RoundCorners(b,a)};MochiKit.Visual.roundClass=function(c,d,a){var f=MochiKit.DOM.getElementsByTagAndClassName(c,d);for(var b=0;b<f.length;b++){MochiKit.Visual.roundElement(f[b],a)}};MochiKit.Visual.tagifyText=function(b,c){var c=c||"position:relative";if(MochiKit.Base.isIE()){c+=";zoom:1"}b=MochiKit.DOM.getElement(b);var a=MochiKit.Iter.forEach;a(b.childNodes,function(d){if(d.nodeType==3){a(d.nodeValue.split(""),function(f){b.insertBefore(MochiKit.DOM.SPAN({style:c},f==" "?String.fromCharCode(160):f),d)});MochiKit.DOM.removeElement(d)}})};MochiKit.Visual.forceRerendering=function(a){try{a=MochiKit.DOM.getElement(a);var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(b){}};MochiKit.Visual.multiple=function(f,c,b){b=MochiKit.Base.update({speed:0.1,delay:0},b||{});var d=b.delay;var a=0;MochiKit.Iter.forEach(f,function(g){b.delay=a*b.speed+d;new c(g,b);a+=1})};MochiKit.Visual.PAIRS={slide:["slideDown","slideUp"],blind:["blindDown","blindUp"],appear:["appear","fade"],size:["grow","shrink"]};MochiKit.Visual.toggle=function(c,d,b){c=MochiKit.DOM.getElement(c);d=(d||"appear").toLowerCase();b=MochiKit.Base.update({queue:{position:"end",scope:(c.id||"global"),limit:1}},b||{});var a=MochiKit.Visual;a[MochiKit.DOM.isVisible(c)?a.PAIRS[d][1]:a.PAIRS[d][0]](c,b)};MochiKit.Visual.Transitions={};MochiKit.Visual.Transitions.linear=function(a){return a};MochiKit.Visual.Transitions.sinoidal=function(a){return(-Math.cos(a*Math.PI)/2)+0.5};MochiKit.Visual.Transitions.reverse=function(a){return 1-a};MochiKit.Visual.Transitions.flicker=function(a){return((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4};MochiKit.Visual.Transitions.wobble=function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5};MochiKit.Visual.Transitions.pulse=function(a){return(Math.floor(a*10)%2==0?(a*10-Math.floor(a*10)):1-(a*10-Math.floor(a*10)))};MochiKit.Visual.Transitions.none=function(a){return 0};MochiKit.Visual.Transitions.full=function(a){return 1};MochiKit.Visual.ScopedQueue=function(){this.__init__()};MochiKit.Base.update(MochiKit.Visual.ScopedQueue.prototype,{__init__:function(){this.effects=[];this.interval=null},add:function(d){var f=new Date().getTime();var a=(typeof(d.options.queue)=="string")?d.options.queue:d.options.queue.position;var b=MochiKit.Iter.forEach;switch(a){case"front":b(this.effects,function(g){if(g.state=="idle"){g.startOn+=d.finishOn;g.finishOn+=d.finishOn}});break;case"end":var c;b(this.effects,function(h){var g=h.finishOn;if(g>=(c||g)){c=g}});f=c||f;break}d.startOn+=f;d.finishOn+=f;if(!d.options.queue.limit||this.effects.length<d.options.queue.limit){this.effects.push(d)}if(!this.interval){this.interval=setInterval(MochiKit.Base.bind(this.loop,this),40)}},remove:function(a){this.effects=MochiKit.Base.filter(function(b){return b!=a},this.effects);if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var a=new Date().getTime();MochiKit.Iter.forEach(this.effects,function(b){b.loop(a)})}});MochiKit.Visual.Queues={instances:{},get:function(a){if(typeof(a)!="string"){return a}if(!this.instances[a]){this.instances[a]=new MochiKit.Visual.ScopedQueue()}return this.instances[a]}};MochiKit.Visual.Queue=MochiKit.Visual.Queues.get("global");MochiKit.Visual.DefaultOptions={transition:MochiKit.Visual.Transitions.sinoidal,duration:1,fps:25,sync:false,from:0,to:1,delay:0,queue:"parallel"};MochiKit.Visual.Base=function(){};MochiKit.Visual.Base.prototype={__class__:MochiKit.Visual.Base,start:function(b){var a=MochiKit.Visual;this.options=MochiKit.Base.setdefault(b||{},a.DefaultOptions);this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.event("beforeStart");if(!this.options.sync){a.Queues.get(typeof(this.options.queue)=="string"?"global":this.options.queue.scope).add(this)}},loop:function(c){if(c>=this.startOn){if(c>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");this.finish();this.event("afterFinish");return}var b=(c-this.startOn)/(this.finishOn-this.startOn);var a=Math.round(b*this.options.fps*this.options.duration);if(a>this.currentFrame){this.render(b);this.currentFrame=a}}},render:function(a){if(this.state=="idle"){this.state="running";this.event("beforeSetup");this.setup();this.event("afterSetup")}if(this.state=="running"){if(this.options.transition){a=this.options.transition(a)}a*=(this.options.to-this.options.from);a+=this.options.from;this.event("beforeUpdate");this.update(a);this.event("afterUpdate")}},cancel:function(){if(!this.options.sync){MochiKit.Visual.Queues.get(typeof(this.options.queue)=="string"?"global":this.options.queue.scope).remove(this)}this.state="finished"},setup:function(){},finish:function(){},update:function(a){},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}};MochiKit.Visual.Parallel=function(b,a){this.__init__(b,a)};MochiKit.Visual.Parallel.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Parallel.prototype,{__init__:function(b,a){this.effects=b||[];this.start(a)},update:function(a){MochiKit.Iter.forEach(this.effects,function(b){b.render(a)})},finish:function(){MochiKit.Iter.forEach(this.effects,function(a){a.render(1);a.cancel();a.event("beforeFinish");a.finish();a.event("afterFinish")})}});MochiKit.Visual.Opacity=function(b,a){this.__init__(b,a)};MochiKit.Visual.Opacity.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Opacity.prototype,{__init__:function(f,c){var a=MochiKit.Base;var g=MochiKit.DOM;this.element=g.getElement(f);if(a.isIE()&&(!this.element.currentStyle.hasLayout)){g.setStyle(this.element,{zoom:1})}c=a.update({from:g.getOpacity(this.element)||0,to:1},c||{});this.start(c)},update:function(a){MochiKit.DOM.setOpacity(this.element,a)}});MochiKit.Visual.Move=function(b,a){this.__init__(b,a)};MochiKit.Visual.Move.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Move.prototype,{__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);a=MochiKit.Base.update({x:0,y:0,mode:"relative"},a||{});this.start(a)},setup:function(){var f=MochiKit.DOM;f.makePositioned(this.element);var b=this.element.style;var c=b.visibility;var a=b.display;if(a=="none"){b.visibility="hidden";b.display=""}this.originalLeft=parseFloat(f.getStyle(this.element,"left")||"0");this.originalTop=parseFloat(f.getStyle(this.element,"top")||"0");if(this.options.mode=="absolute"){this.options.x-=this.originalLeft;this.options.y-=this.originalTop}if(a=="none"){b.visibility=c;b.display=a}},update:function(a){MochiKit.DOM.setStyle(this.element,{left:Math.round(this.options.x*a+this.originalLeft)+"px",top:Math.round(this.options.y*a+this.originalTop)+"px"})}});MochiKit.Visual.Scale=function(b,c,a){this.__init__(b,c,a)};MochiKit.Visual.Scale.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Scale.prototype,{__init__:function(b,c,a){this.element=MochiKit.DOM.getElement(b);a=MochiKit.Base.update({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:c},a||{});this.start(a)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=MochiKit.DOM.getStyle(this.element,"position");var c=MochiKit.Iter.forEach;var a=MochiKit.Base.bind;this.originalStyle={};c(["top","left","width","height","fontSize"],a(function(b){this.originalStyle[b]=this.element.style[b]},this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var d=MochiKit.DOM.getStyle(this.element,"font-size")||"100%";c(["em","px","%"],a(function(b){if(d.indexOf(b)>0){this.fontSize=parseFloat(d);this.fontSizeType=b}},this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}else{if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}else{this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}}},update:function(a){var b=(this.options.scaleFrom/100)+(this.factor*a);if(this.options.scaleContent&&this.fontSize){MochiKit.DOM.setStyle(this.element,{fontSize:this.fontSize*b+this.fontSizeType})}this.setDimensions(this.dims[0]*b,this.dims[1]*b)},finish:function(){if(this.restoreAfterFinish){MochiKit.DOM.setStyle(this.element,this.originalStyle)}},setDimensions:function(a,f){var g={};if(this.options.scaleX){g.width=Math.round(f)+"px"}if(this.options.scaleY){g.height=Math.round(a)+"px"}if(this.options.scaleFromCenter){var c=(a-this.dims[0])/2;var b=(f-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){g.top=this.originalTop-c+"px"}if(this.options.scaleX){g.left=this.originalLeft-b+"px"}}else{if(this.options.scaleY){g.top=-c+"px"}if(this.options.scaleX){g.left=-b+"px"}}}MochiKit.DOM.setStyle(this.element,g)}});MochiKit.Visual.Highlight=function(b,a){this.__init__(b,a)};MochiKit.Visual.Highlight.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.Highlight.prototype,{__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);a=MochiKit.Base.update({startcolor:"#ffff99"},a||{});this.start(a)},setup:function(){var c=MochiKit.DOM;var a=MochiKit.Base;if(c.getStyle(this.element,"display")=="none"){this.cancel();return}this.oldStyle={backgroundImage:c.getStyle(this.element,"background-image")};c.setStyle(this.element,{backgroundImage:"none"});if(!this.options.endcolor){this.options.endcolor=MochiKit.Color.Color.fromBackground(this.element).toHexString()}if(!this.options.restorecolor){this.options.restorecolor=c.getStyle(this.element,"background-color")}this._base=a.map(a.bind(function(b){return parseInt(this.options.startcolor.slice(b*2+1,b*2+3),16)},this),[0,1,2]);this._delta=a.map(a.bind(function(b){return parseInt(this.options.endcolor.slice(b*2+1,b*2+3),16)-this._base[b]},this),[0,1,2])},update:function(b){var a="#";MochiKit.Iter.forEach([0,1,2],MochiKit.Base.bind(function(c){a+=MochiKit.Color.toColorPart(Math.round(this._base[c]+this._delta[c]*b))},this));MochiKit.DOM.setStyle(this.element,{backgroundColor:a})},finish:function(){MochiKit.DOM.setStyle(this.element,MochiKit.Base.update(this.oldStyle,{backgroundColor:this.options.endcolor}))}});MochiKit.Visual.ScrollTo=function(b,a){this.__init__(b,a)};MochiKit.Visual.ScrollTo.prototype=new MochiKit.Visual.Base();MochiKit.Base.update(MochiKit.Visual.ScrollTo.prototype,{__init__:function(b,a){this.element=MochiKit.DOM.getElement(b);this.start(a||{})},setup:function(){var c=MochiKit.Position;c.prepare();var b=c.cumulativeOffset(this.element);if(this.options.offset){b.y+=this.options.offset}var a;if(window.innerHeight){a=window.innerHeight-window.height}else{if(document.documentElement&&document.documentElement.clientHeight){a=document.documentElement.clientHeight-document.body.scrollHeight}else{if(document.body){a=document.body.clientHeight-document.body.scrollHeight}}}this.scrollStart=c.windowOffset.y;this.delta=(b.y>a?a:b.y)-this.scrollStart},update:function(a){var b=MochiKit.Position;b.prepare();window.scrollTo(b.windowOffset.x,this.scrollStart+(a*this.delta))}});MochiKit.Visual.fade=function(c,b){var f=MochiKit.DOM;var a=f.getInlineOpacity(c);b=MochiKit.Base.update({from:f.getOpacity(c)||1,to:0,afterFinishInternal:function(d){if(d.options.to!==0){return}MochiKit.Style.hideElement(d.element);f.setStyle(d.element,{opacity:a})}},b||{});return new MochiKit.Visual.Opacity(c,b)};MochiKit.Visual.appear=function(c,b){var f=MochiKit.DOM;var a=MochiKit.Visual;b=MochiKit.Base.update({from:(f.getStyle(c,"display")=="none"?0:f.getOpacity(c)||0),to:1,afterFinishInternal:function(d){a.forceRerendering(d.element)},beforeSetupInternal:function(d){f.setOpacity(d.element,d.options.from);MochiKit.Style.showElement(d.element)}},b||{});return new a.Opacity(c,b)};MochiKit.Visual.puff=function(f,c){var g=MochiKit.DOM;var b=MochiKit.Visual;f=g.getElement(f);var a={opacity:g.getInlineOpacity(f),position:g.getStyle(f,"position")};c=MochiKit.Base.update({beforeSetupInternal:function(d){g.setStyle(d.effects[0].element,{position:"absolute"})},afterFinishInternal:function(d){MochiKit.Style.hideElement(d.effects[0].element);g.setStyle(d.effects[0].element,a)}},c||{});return new b.Parallel([new b.Scale(f,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new b.Opacity(f,{sync:true,to:0})],c)};MochiKit.Visual.blindUp=function(b,a){var c=MochiKit.DOM;b=c.getElement(b);c.makeClipping(b);a=MochiKit.Base.update({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(d){MochiKit.Style.hideElement(d.element);c.undoClipping(d.element)}},a||{});return new MochiKit.Visual.Scale(b,0,a)};MochiKit.Visual.blindDown=function(c,b){var f=MochiKit.DOM;c=f.getElement(c);var a=MochiKit.Style.getElementDimensions(c);b=MochiKit.Base.update({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:a.h,originalWidth:a.w},restoreAfterFinish:true,afterSetupInternal:function(d){f.makeClipping(d.element);f.setStyle(d.element,{height:"0px"});MochiKit.Style.showElement(d.element)},afterFinishInternal:function(d){f.undoClipping(d.element)}},b||{});return new MochiKit.Visual.Scale(c,100,b)};MochiKit.Visual.switchOff=function(f,c){var g=MochiKit.DOM;f=g.getElement(f);var b=g.getInlineOpacity(f);var c=MochiKit.Base.update({duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetupInternal:function(d){g.makePositioned(d.element);g.makeClipping(d.element)},afterFinishInternal:function(d){MochiKit.Style.hideElement(d.element);g.undoClipping(d.element);g.undoPositioned(d.element);g.setStyle(d.element,{opacity:b})}},c||{});var a=MochiKit.Visual;return new a.appear(f,{duration:0.4,from:0,transition:a.Transitions.flicker,afterFinishInternal:function(d){new a.Scale(d.element,1,c)}})};MochiKit.Visual.dropOut=function(f,c){var g=MochiKit.DOM;f=g.getElement(f);var a={top:g.getStyle(f,"top"),left:g.getStyle(f,"left"),opacity:g.getInlineOpacity(f)};c=MochiKit.Base.update({duration:0.5,beforeSetupInternal:function(d){g.makePositioned(d.effects[0].element)},afterFinishInternal:function(d){MochiKit.Style.hideElement(d.effects[0].element);g.undoPositioned(d.effects[0].element);g.setStyle(d.effects[0].element,a)}},c||{});var b=MochiKit.Visual;return new b.Parallel([new b.Move(f,{x:0,y:100,sync:true}),new b.Opacity(f,{sync:true,to:0})],c)};MochiKit.Visual.shake=function(f,c){var g=MochiKit.DOM;var b=MochiKit.Visual;f=g.getElement(f);c=MochiKit.Base.update({x:-20,y:0,duration:0.05,afterFinishInternal:function(d){g.undoPositioned(d.element);g.setStyle(d.element,a)}},c||{});var a={top:g.getStyle(f,"top"),left:g.getStyle(f,"left")};return new b.Move(f,{x:20,y:0,duration:0.05,afterFinishInternal:function(d){new b.Move(d.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(h){new b.Move(h.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(i){new b.Move(i.element,{x:-40,y:0,duration:0.1,afterFinishInternal:function(j){new b.Move(j.element,{x:40,y:0,duration:0.1,afterFinishInternal:function(k){new b.Move(k.element,c)}})}})}})}})}})};MochiKit.Visual.slideDown=function(h,g){var i=MochiKit.DOM;var c=MochiKit.Base;h=i.getElement(h);if(!h.firstChild){throw"MochiKit.Visual.slideDown must be used on a element with a child"}i.removeEmptyTextNodes(h);var a=i.getStyle(h.firstChild,"bottom")||0;var f=MochiKit.Style.getElementDimensions(h);g=c.update({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:f.h,originalWidth:f.w},restoreAfterFinish:true,afterSetupInternal:function(b){i.makePositioned(b.element);i.makePositioned(b.element.firstChild);if(c.isOpera()){i.setStyle(b.element,{top:""})}i.makeClipping(b.element);i.setStyle(b.element,{height:"0px"});MochiKit.Style.showElement(b.element)},afterUpdateInternal:function(b){i.setStyle(b.element.firstChild,{bottom:(b.dims[0]-b.element.clientHeight)+"px"})},afterFinishInternal:function(b){i.undoClipping(b.element);if(c.isIE()){i.undoPositioned(b.element);i.undoPositioned(b.element.firstChild)}else{i.undoPositioned(b.element.firstChild);i.undoPositioned(b.element)}i.setStyle(b.element.firstChild,{bottom:a})}},g||{});return new MochiKit.Visual.Scale(h,100,g)};MochiKit.Visual.slideUp=function(g,f){var h=MochiKit.DOM;var c=MochiKit.Base;g=h.getElement(g);if(!g.firstChild){throw"MochiKit.Visual.slideUp must be used on a element with a child"}h.removeEmptyTextNodes(g);var a=h.getStyle(g.firstChild,"bottom");f=c.update({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,restoreAfterFinish:true,beforeStartInternal:function(b){h.makePositioned(b.element);h.makePositioned(b.element.firstChild);if(c.isOpera()){h.setStyle(b.element,{top:""})}h.makeClipping(b.element);MochiKit.Style.showElement(b.element)},afterUpdateInternal:function(b){h.setStyle(b.element.firstChild,{bottom:(b.dims[0]-b.element.clientHeight)+"px"})},afterFinishInternal:function(b){MochiKit.Style.hideElement(b.element);h.undoClipping(b.element);h.undoPositioned(b.element.firstChild);h.undoPositioned(b.element);h.setStyle(b.element.firstChild,{bottom:a})}},f||{});return new MochiKit.Visual.Scale(g,0,f)};MochiKit.Visual.squish=function(f,c){var g=MochiKit.DOM;var a=MochiKit.Base;c=a.update({restoreAfterFinish:true,beforeSetupInternal:function(b){g.makeClipping(b.element)},afterFinishInternal:function(b){MochiKit.Style.hideElement(b.element);g.undoClipping(b.element)}},c||{});return new MochiKit.Visual.Scale(f,a.isOpera()?1:0,c)};MochiKit.Visual.grow=function(h,m){var i=MochiKit.DOM;var l=MochiKit.Visual;h=i.getElement(h);m=MochiKit.Base.update({direction:"center",moveTransition:l.Transitions.sinoidal,scaleTransition:l.Transitions.sinoidal,opacityTransition:l.Transitions.full},m||{});var f={top:h.style.top,left:h.style.left,height:h.style.height,width:h.style.width,opacity:i.getInlineOpacity(h)};var k=MochiKit.Style.getElementDimensions(h);var g,c;var b,a;switch(m.direction){case"top-left":g=c=b=a=0;break;case"top-right":g=k.w;c=a=0;b=-k.w;break;case"bottom-left":g=b=0;c=k.h;a=-k.h;break;case"bottom-right":g=k.w;c=k.h;b=-k.w;a=-k.h;break;case"center":g=k.w/2;c=k.h/2;b=-k.w/2;a=-k.h/2;break}var j=MochiKit.Base.update({beforeSetupInternal:function(d){i.setStyle(d.effects[0].element,{height:"0px"});MochiKit.Style.showElement(d.effects[0].element)},afterFinishInternal:function(d){i.undoClipping(d.effects[0].element);i.undoPositioned(d.effects[0].element);i.setStyle(d.effects[0].element,f)}},m||{});return new l.Move(h,{x:g,y:c,duration:0.01,beforeSetupInternal:function(d){MochiKit.Style.hideElement(d.element);i.makeClipping(d.element);i.makePositioned(d.element)},afterFinishInternal:function(d){new l.Parallel([new l.Opacity(d.element,{sync:true,to:1,from:0,transition:m.opacityTransition}),new l.Move(d.element,{x:b,y:a,sync:true,transition:m.moveTransition}),new l.Scale(d.element,100,{scaleMode:{originalHeight:k.h,originalWidth:k.w},sync:true,scaleFrom:MochiKit.Base.isOpera()?1:0,transition:m.scaleTransition,restoreAfterFinish:true})],j)}})};MochiKit.Visual.shrink=function(f,k){var g=MochiKit.DOM;var j=MochiKit.Visual;f=g.getElement(f);k=MochiKit.Base.update({direction:"center",moveTransition:j.Transitions.sinoidal,scaleTransition:j.Transitions.sinoidal,opacityTransition:j.Transitions.none},k||{});var c={top:f.style.top,left:f.style.left,height:f.style.height,width:f.style.width,opacity:g.getInlineOpacity(f)};var i=MochiKit.Style.getElementDimensions(f);var b,a;switch(k.direction){case"top-left":b=a=0;break;case"top-right":b=i.w;a=0;break;case"bottom-left":b=0;a=i.h;break;case"bottom-right":b=i.w;a=i.h;break;case"center":b=i.w/2;a=i.h/2;break}var h=MochiKit.Base.update({beforeStartInternal:function(d){g.makePositioned(d.effects[0].element);g.makeClipping(d.effects[0].element)},afterFinishInternal:function(d){MochiKit.Style.hideElement(d.effects[0].element);g.undoClipping(d.effects[0].element);g.undoPositioned(d.effects[0].element);g.setStyle(d.effects[0].element,c)}},k||{});return new j.Parallel([new j.Opacity(f,{sync:true,to:0,from:1,transition:k.opacityTransition}),new j.Scale(f,MochiKit.Base.isOpera()?1:0,{sync:true,transition:k.scaleTransition,restoreAfterFinish:true}),new j.Move(f,{x:b,y:a,sync:true,transition:k.moveTransition})],h)};MochiKit.Visual.pulsate=function(h,g){var k=MochiKit.DOM;var f=MochiKit.Visual;var a=MochiKit.Base;h=k.getElement(h);var c=k.getInlineOpacity(h);g=a.update({duration:3,from:0,afterFinishInternal:function(b){k.setStyle(b.element,{opacity:c})}},g||{});var j=g.transition||f.Transitions.sinoidal;var i=a.bind(function(b){return j(1-f.Transitions.pulse(b))},j);a.bind(i,j);return new f.Opacity(h,a.update({transition:i},g))};MochiKit.Visual.fold=function(f,c){var g=MochiKit.DOM;var b=MochiKit.Visual;f=g.getElement(f);var a={top:f.style.top,left:f.style.left,width:f.style.width,height:f.style.height};g.makeClipping(f);c=MochiKit.Base.update({scaleContent:false,scaleX:false,afterFinishInternal:function(d){new b.Scale(f,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(h){MochiKit.Style.hideElement(h.element);g.undoClipping(h.element);g.setStyle(h.element,a)}})}},c||{});return new b.Scale(f,5,c)};MochiKit.Visual.Color=MochiKit.Color.Color;MochiKit.Visual.getElementsComputedStyle=MochiKit.DOM.computedStyle;MochiKit.Visual.__new__=function(){var a=MochiKit.Base;a.nameFunctions(this);this.EXPORT_TAGS={":common":this.EXPORT,":all":a.concat(this.EXPORT,this.EXPORT_OK)}};MochiKit.Visual.EXPORT=["roundElement","roundClass","tagifyText","multiple","toggle","Base","Parallel","Opacity","Move","Scale","Highlight","ScrollTo","fade","appear","puff","blindUp","blindDown","switchOff","dropOut","shake","slideDown","slideUp","squish","grow","shrink","pulsate","fold"];MochiKit.Visual.EXPORT_OK=["PAIRS"];MochiKit.Visual.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Visual);