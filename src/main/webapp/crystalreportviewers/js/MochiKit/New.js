MochiKit.Base.update(MochiKit.Base,{isIE:function(){return/MSIE/.test(navigator.userAgent)},isGecko:function(){return/Gecko/.test(navigator.userAgent)},isKHTML:function(){return/Konqueror|Safari|KHTML/.test(navigator.userAgent)},isSafari:function(){return/AppleWebKit'/.test(navigator.appVersion)},isOpera:function(){return/Opera/.test(navigator.userAgent)}});MochiKit.Base.update(MochiKit.DOM,{getStyle:function(b,c){b=MochiKit.DOM.getElement(b);var d=b.style[MochiKit.Base.camelize(c)];if(!d){if(document.defaultView&&document.defaultView.getComputedStyle){var a=document.defaultView.getComputedStyle(b,null);d=a?a.getPropertyValue(c):null}else{if(b.currentStyle){d=b.currentStyle[MochiKit.Base.camelize(c)]}}}if(MochiKit.Base.isOpera()&&(MochiKit.Base.find(["left","top","right","bottom"],c))){if(MochiKit.DOM.getStyle(b,"position")=="static"){d="auto"}}return d=="auto"?null:d},setStyle:function(a,b){a=MochiKit.DOM.getElement(a);for(name in b){a.style[MochiKit.Base.camelize(name)]=b[name]}},getOpacity:function(b){var a;if(a=MochiKit.DOM.getStyle(b,"opacity")){return parseFloat(a)}if(a=(MochiKit.DOM.getStyle(b,"filter")||"").match(/alpha\(opacity=(.*)\)/)){if(a[1]){return parseFloat(a[1])/100}}return 1},getInlineOpacity:function(a){return MochiKit.DOM.getElement(a).style.opacity||""},setOpacity:function(a,b){a=MochiKit.DOM.getElement(a);if(b==1){MochiKit.DOM.setStyle(a,{opacity:(MochiKit.Base.isGecko()&&!MochiKit.Base.isKHTML())?0.999999:null});if(MochiKit.Base.isIE()){MochiKit.DOM.setStyle(a,{filter:MochiKit.DOM.getStyle(a,"filter").replace(/alpha\([^\)]*\)/gi,"")})}}else{if(b<0.00001){b=0}MochiKit.DOM.setStyle(a,{opacity:b});if(MochiKit.Base.isIE()){MochiKit.DOM.setStyle(a,{filter:MochiKit.DOM.getStyle(a,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+b*100+")"})}}},isVisible:function(a){return MochiKit.DOM.getElement(a).style.display!="none"},makeClipping:function(a){a=MochiKit.DOM.getElement(a);if(a._overflow){return}a._overflow=a.style.overflow;if((MochiKit.DOM.getStyle(a,"overflow")||"visible")!="hidden"){a.style.overflow="hidden"}},undoClipping:function(a){a=MochiKit.DOM.getElement(a);if(!a._overflow){return}a.style.overflow=a._overflow;a._overflow=undefined},makePositioned:function(a){a=MochiKit.DOM.getElement(a);var b=MochiKit.DOM.getStyle(a,"position");if((b=="static"||!b)&&!a._madePositioned){a._madePositioned=true;a.style.position="relative";if(MochiKit.Base.isOpera()){a.style.top=0;a.style.left=0}}},undoPositioned:function(a){a=MochiKit.DOM.getElement(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}},getFirstElementByTagAndClassName:function(d,g,h){var k=MochiKit.DOM;if(typeof(d)=="undefined"||d===null){d="*"}if(typeof(h)=="undefined"||h===null){h=k._document}h=k.getElement(h);var c=(h.getElementsByTagName(d)||k._document.all);if(typeof(g)=="undefined"||g===null){return MochiKit.Base.extend(null,c)}for(var f=0;f<c.length;f++){var b=c[f];var a=b.className.split(" ");for(var e=0;e<a.length;e++){if(a[e]==g){return b}}}},isParent:function(b,a){if(!b.parentNode||b==a){return false}if(b.parentNode==a){return true}return MochiKit.DOM.isParent(b.parentNode,a)}});MochiKit.Position={includeScrollOffsets:false,prepare:function(){var b=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;this.windowOffset=new MochiKit.Style.Coordinates(b,a)},cumulativeOffset:function(b){var a=0;var c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent}while(b);return new MochiKit.Style.Coordinates(c,a)},realOffset:function(b){var a=0;var c=0;do{a+=b.scrollTop||0;c+=b.scrollLeft||0;b=b.parentNode}while(b);return new MochiKit.Style.Coordinates(c,a)},within:function(b,a,c){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(b,a,c)}this.xcomp=a;this.ycomp=c;this.offset=this.cumulativeOffset(b);if(b.style.position=="fixed"){this.offset.x+=this.windowOffset.x;this.offset.y+=this.windowOffset.y}return(c>=this.offset.y&&c<this.offset.y+b.offsetHeight&&a>=this.offset.x&&a<this.offset.x+b.offsetWidth)},withinIncludingScrolloffsets:function(b,a,d){var c=this.realOffset(b);this.xcomp=a+c.x-this.windowOffset.x;this.ycomp=d+c.y-this.windowOffset.y;this.offset=this.cumulativeOffset(b);return(this.ycomp>=this.offset.y&&this.ycomp<this.offset.y+b.offsetHeight&&this.xcomp>=this.offset.x&&this.xcomp<this.offset.x+b.offsetWidth)},overlap:function(b,a){if(!b){return 0}if(b=="vertical"){return((this.offset.y+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(b=="horizontal"){return((this.offset.x+a.offsetWidth)-this.xcomp)/a.offsetWidth}},absolutize:function(c){c=MochiKit.DOM.getElement(c);if(c.style.position=="absolute"){return}MochiKit.Position.prepare();var e=MochiKit.Position.positionedOffset(c);var d=c.clientWidth;var a=c.clientHeight;var b={position:c.style.position,left:e.x-parseFloat(c.style.left||0),top:e.y-parseFloat(c.style.top||0),width:c.style.width,height:c.style.height};c.style.position="absolute";c.style.top=e.y+"px";c.style.left=e.x+"px";c.style.width=d+"px";c.style.height=a+"px";return b},positionedOffset:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent;if(b){p=MochiKit.DOM.getStyle(b,"position");if(p=="relative"||p=="absolute"){break}}}while(b);return new MochiKit.Style.Coordinates(c,a)},relativize:function(b,a){b=MochiKit.DOM.getElement(b);if(b.style.position=="relative"){return}MochiKit.Position.prepare();var d=parseFloat(b.style.top||0)-(a.top||0);var c=parseFloat(b.style.left||0)-(a.left||0);b.style.position=a.position;b.style.top=d+"px";b.style.left=c+"px";b.style.width=a.width;b.style.height=a.height},clone:function(b,c){b=MochiKit.DOM.getElement(b);c=MochiKit.DOM.getElement(c);c.style.position="absolute";var a=this.cumulativeOffset(b);c.style.top=a.y+"px";c.style.left=a.x+"px";c.style.width=b.offsetWidth+"px";c.style.height=b.offsetHeight+"px"},page:function(d){var a=0;var c=0;var b=d;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;if(b.offsetParent==document.body&&MochiKit.DOM.getStyle(b,"position")=="absolute"){break}}while(b=b.offsetParent);b=d;do{a-=b.scrollTop||0;c-=b.scrollLeft||0}while(b=b.parentNode);return new MochiKit.Style.Coordinates(c,a)}};