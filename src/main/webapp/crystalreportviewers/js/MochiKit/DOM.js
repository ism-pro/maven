if(typeof(dojo)!="undefined"){dojo.provide("MochiKit.DOM");dojo.require("MochiKit.Base")}if(typeof(JSAN)!="undefined"){JSAN.use("MochiKit.Base",[])}try{if(typeof(MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.DOM depends on MochiKit.Base!"}if(typeof(MochiKit.DOM)=="undefined"){MochiKit.DOM={}}MochiKit.DOM.NAME="MochiKit.DOM";MochiKit.DOM.VERSION="1.4";MochiKit.DOM.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.DOM.toString=function(){return this.__repr__()};MochiKit.DOM.EXPORT=["removeEmptyTextNodes","formContents","currentWindow","currentDocument","withWindow","withDocument","registerDOMConverter","coerceToDOM","createDOM","createDOMFunc","getNodeAttribute","setNodeAttribute","updateNodeAttributes","appendChildNodes","replaceChildNodes","removeElement","swapDOM","BUTTON","TT","PRE","H1","H2","H3","BR","CANVAS","HR","LABEL","TEXTAREA","FORM","STRONG","SELECT","OPTION","OPTGROUP","LEGEND","FIELDSET","P","UL","OL","LI","TD","TR","THEAD","TBODY","TFOOT","TABLE","TH","INPUT","SPAN","A","DIV","IMG","getElement","$","getElementsByTagAndClassName","addToCallStack","addLoadEvent","focusOnLoad","setElementClass","toggleElementClass","addElementClass","removeElementClass","swapElementClass","hasElementClass","escapeHTML","toHTML","emitHTML","scrapeText"];MochiKit.DOM.EXPORT_OK=["domConverters"];MochiKit.DOM.DEPRECATED=[["computedStyle","MochiKit.Style.computedStyle","1.4"],["elementDimensions","MochiKit.Style.getElementDimensions","1.4"],["elementPosition","MochiKit.Style.getElementPosition","1.4"],["hideElement","MochiKit.Style.hideElement","1.4"],["setElementDimensions","MochiKit.Style.setElementDimensions","1.4"],["setElementPosition","MochiKit.Style.setElementPosition","1.4"],["setDisplayForElement","MochiKit.Style.setDisplayForElement","1.4"],["setOpacity","MochiKit.Style.setOpacity","1.4"],["showElement","MochiKit.Style.showElement","1.4"],["Coordinates","MochiKit.Style.Coordinates","1.4"],["Dimensions","MochiKit.Style.Dimensions","1.4"]];MochiKit.DOM.getViewportDimensions=new Function('if (!MochiKit["Style"]) {    throw new Error("This function has been deprecated and depends on MochiKit.Style.");}return MochiKit.Style.getViewportDimensions.apply(this, arguments);');MochiKit.Base.update(MochiKit.DOM,{currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(h,d){var c=MochiKit.DOM;var b=c._document;var a=c._win;var g;try{c._window=h;c._document=h.document;g=d()}catch(f){c._window=a;c._document=b;throw f}c._window=a;c._document=b;return g},formContents:function(d){var f=[];var c=[];var a=MochiKit.Base;var b=MochiKit.DOM;if(typeof(d)=="undefined"||d===null){d=b._document}else{d=b.getElement(d)}a.nodeWalk(d,function(m){var g=m.name;if(a.isNotEmpty(g)){var k=m.nodeName;if(k=="INPUT"&&(m.type=="radio"||m.type=="checkbox")&&!m.checked){return null}if(k=="SELECT"){if(m.type=="select-one"){if(m.selectedIndex>=0){var j=m.options[m.selectedIndex];f.push(g);c.push((j.value)?j.value:j.text);return null}f.push(g);c.push("");return null}else{var l=m.options;if(!l.length){f.push(g);c.push("");return null}for(var h=0;h<l.length;h++){var j=l[h];if(!j.selected){continue}f.push(g);c.push((j.value)?j.value:j.text)}return null}}if(k=="FORM"||k=="P"||k=="SPAN"||k=="DIV"){return m.childNodes}f.push(g);c.push(m.value||"");return null}return m.childNodes});return[f,c]},withDocument:function(g,c){var b=MochiKit.DOM;var a=b._document;var f;try{b._document=g;f=c()}catch(d){b._document=a;throw d}b._document=a;return f},registerDOMConverter:function(b,a,d,c){MochiKit.DOM.domConverters.register(b,a,d,c)},coerceToDOM:function(d,o){var f=MochiKit.Base;var j=MochiKit.Iter;var n=MochiKit.DOM;if(j){var k=j.iter;var b=j.repeat;var a=f.map}var l=n.domConverters;var c=arguments.callee;var h=f.NotFound;while(true){if(typeof(d)=="undefined"||d===null){return null}if(typeof(d.nodeType)!="undefined"&&d.nodeType>0){return d}if(typeof(d)=="number"||typeof(d)=="boolean"){d=d.toString()}if(typeof(d)=="string"){return n._document.createTextNode(d)}if(typeof(d.__dom__)=="function"){d=d.__dom__(o);continue}if(typeof(d.dom)=="function"){d=d.dom(o);continue}if(typeof(d)=="function"){d=d.apply(o,[o]);continue}if(j){var g=null;try{g=k(d)}catch(i){}if(g){return a(c,g,b(o))}}try{d=l.match(d,o);continue}catch(i){if(i!=h){throw i}}return n._document.createTextNode(d.toString())}return undefined},setNodeAttribute:function(b,a,c){var f={};f[a]=c;try{return MochiKit.DOM.updateNodeAttributes(b,f)}catch(d){}return null},getNodeAttribute:function(d,a){var c=MochiKit.DOM;var b=c.attributeArray.renames[a];d=c.getElement(d);try{if(b){return d[b]}return d.getAttribute(a)}catch(f){}return null},updateNodeAttributes:function(b,g){var c=b;var j=MochiKit.DOM;if(typeof(b)=="string"){c=j.getElement(b)}if(g){var i=MochiKit.Base.updatetree;if(j.attributeArray.compliant){for(var d in g){var h=g[d];if(typeof(h)=="object"&&typeof(c[d])=="object"){i(c[d],h)}else{if(d.substring(0,2)=="on"){if(typeof(h)=="string"){h=new Function(h)}c[d]=h}else{c.setAttribute(d,h)}}}}else{var f=j.attributeArray.renames;for(d in g){h=g[d];var a=f[d];if(d=="style"&&typeof(h)=="string"){c.style.cssText=h}else{if(typeof(a)=="string"){c[a]=h}else{if(typeof(c[d])=="object"&&typeof(h)=="object"){i(c[d],h)}else{if(d.substring(0,2)=="on"){if(typeof(h)=="string"){h=new Function(h)}c[d]=h}else{c.setAttribute(d,h)}}}}}}}return c},appendChildNodes:function(c){var b=c;var a=MochiKit.DOM;if(typeof(c)=="string"){b=a.getElement(c)}var d=[a.coerceToDOM(MochiKit.Base.extend(null,arguments,1),b)];var f=MochiKit.Base.concat;while(d.length){var g=d.shift();if(typeof(g)=="undefined"||g===null){}else{if(typeof(g.nodeType)=="number"){b.appendChild(g)}else{d=f(g,d)}}}return b},replaceChildNodes:function(c){var b=c;var a=MochiKit.DOM;if(typeof(c)=="string"){b=a.getElement(c);arguments[0]=b}var d;while((d=b.firstChild)){b.removeChild(d)}if(arguments.length<2){return b}else{return a.appendChildNodes.apply(this,arguments)}},createDOM:function(f,d){var h;var b=MochiKit.DOM;var a=MochiKit.Base;if(typeof(d)=="string"||typeof(d)=="number"){var c=a.extend([f,null],arguments,1);return arguments.callee.apply(this,c)}if(typeof(f)=="string"){if(d&&!b.attributeArray.compliant){var g="";if("name" in d){g+=' name="'+b.escapeHTML(d.name)+'"'}if(f=="input"&&"type" in d){g+=' type="'+b.escapeHTML(d.type)+'"'}if(g){f="<"+f+g+">"}}h=b._document.createElement(f)}else{h=f}if(d){b.updateNodeAttributes(h,d)}if(arguments.length<=2){return h}else{var c=a.extend([h],arguments,2);return b.appendChildNodes.apply(this,c)}},createDOMFunc:function(){var a=MochiKit.Base;return a.partial.apply(this,a.extend([MochiKit.DOM.createDOM],arguments))},removeElement:function(a){var b=MochiKit.DOM.getElement(a);b.parentNode.removeChild(b);return b},swapDOM:function(b,d){var a=MochiKit.DOM;b=a.getElement(b);var c=b.parentNode;if(d){d=a.getElement(d);c.replaceChild(d,b)}else{c.removeChild(b)}return d},getElement:function(b){var a=MochiKit.DOM;if(arguments.length==1){return((typeof(b)=="string")?a._document.getElementById(b):b)}else{return MochiKit.Base.map(a.getElement,arguments)}},getElementsByTagAndClassName:function(f,k,l){var m=MochiKit.DOM;if(typeof(f)=="undefined"||f===null){f="*"}if(typeof(l)=="undefined"||l===null){l=m._document}l=m.getElement(l);var d=(l.getElementsByTagName(f)||m._document.all);if(typeof(k)=="undefined"||k===null){return MochiKit.Base.extend(null,d)}var b=[];for(var h=0;h<d.length;h++){var c=d[h];var a=c.className.split(" ");for(var g=0;g<a.length;g++){if(a[g]==k){b.push(c);break}}}return b},_newCallStack:function(c,a){var b=function(){var d=arguments.callee.callStack;for(var f=0;f<d.length;f++){if(d[f].apply(this,arguments)===false){break}}if(a){try{this[c]=null}catch(g){}}};b.callStack=[];return b},addToCallStack:function(h,g,f,c){var b=MochiKit.DOM;var d=h[g];var a=d;if(!(typeof(d)=="function"&&typeof(d.callStack)=="object"&&d.callStack!==null)){a=b._newCallStack(g,c);if(typeof(d)=="function"){a.callStack.push(d)}h[g]=a}a.callStack.push(f)},addLoadEvent:function(b){var a=MochiKit.DOM;a.addToCallStack(a._window,"onload",b,true)},focusOnLoad:function(b){var a=MochiKit.DOM;a.addLoadEvent(function(){b=a.getElement(b);if(b){b.focus()}})},setElementClass:function(b,c){var a=MochiKit.DOM;var d=a.getElement(b);if(a.attributeArray.compliant){d.setAttribute("class",c)}else{d.setAttribute("className",c)}},toggleElementClass:function(c){var a=MochiKit.DOM;for(var b=1;b<arguments.length;b++){var d=a.getElement(arguments[b]);if(!a.addElementClass(d,c)){a.removeElementClass(d,c)}}},addElementClass:function(f,g){var b=MochiKit.DOM;var h=b.getElement(f);var a=h.className;if(a.length===0){b.setElementClass(h,g);return true}if(a==g){return false}var d=h.className.split(" ");for(var c=0;c<d.length;c++){if(d[c]==g){return false}}b.setElementClass(h,a+" "+g);return true},removeElementClass:function(f,g){var b=MochiKit.DOM;var h=b.getElement(f);var a=h.className;if(a.length===0){return false}if(a==g){b.setElementClass(h,"");return true}var d=h.className.split(" ");for(var c=0;c<d.length;c++){if(d[c]==g){d.splice(c,1);b.setElementClass(h,d.join(" "));return true}}return false},swapElementClass:function(c,f,a){var d=MochiKit.DOM.getElement(c);var b=MochiKit.DOM.removeElementClass(d,f);if(b){MochiKit.DOM.addElementClass(d,a)}return b},hasElementClass:function(d,f){var h=MochiKit.DOM.getElement(d);var c=h.className.split(" ");for(var b=1;b<arguments.length;b++){var g=false;for(var a=0;a<c.length;a++){if(c[a]==arguments[b]){g=true;break}}if(!g){return false}}return true},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(a){return MochiKit.DOM.emitHTML(a).join("")},emitHTML:function(d,h){if(typeof(h)=="undefined"||h===null){h=[]}var l=[d];var q=MochiKit.DOM;var p=q.escapeHTML;var b=q.attributeArray;while(l.length){d=l.pop();if(typeof(d)=="string"){h.push(d)}else{if(d.nodeType==1){h.push("<"+d.nodeName.toLowerCase());var f=[];var m=b(d);for(var g=0;g<m.length;g++){var n=m[g];f.push([" ",n.name,'="',p(n.value),'"'])}f.sort();for(g=0;g<f.length;g++){var o=f[g];for(var c=0;c<o.length;c++){h.push(o[c])}}if(d.hasChildNodes()){h.push(">");l.push("</"+d.nodeName.toLowerCase()+">");var k=d.childNodes;for(g=k.length-1;g>=0;g--){l.push(k[g])}}else{h.push("/>")}}else{if(d.nodeType==3){h.push(p(d.nodeValue))}}}}return h},scrapeText:function(b,a){var c=[];(function(g){var h=g.childNodes;if(h){for(var f=0;f<h.length;f++){arguments.callee.call(this,h[f])}}var d=g.nodeValue;if(typeof(d)=="string"){c.push(d)}})(MochiKit.DOM.getElement(b));if(a){return c}else{return c.join("")}},removeEmptyTextNodes:function(b){b=MochiKit.DOM.getElement(b);for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(c.nodeType==3&&!/\S/.test(c.nodeValue)){c.parentNode.removeChild(c)}}},__new__:function(k){var f=MochiKit.Base;if(typeof(document)!="undefined"){this._document=document}else{if(MochiKit.MockDOM){this._document=MochiKit.MockDOM.document}}this._window=k;this.domConverters=new f.AdapterRegistry();var n=this._document.createElement("span");var b;if(n&&n.attributes&&n.attributes.length>0){var c=f.filter;b=function(a){return c(b.ignoreAttrFilter,a.attributes)};b.ignoreAttr={};var o=n.attributes;var g=b.ignoreAttr;for(var j=0;j<o.length;j++){var l=o[j];g[l.name]=l.value}b.ignoreAttrFilter=function(i){return(b.ignoreAttr[i.name]!=i.value)};b.compliant=false;b.renames={"class":"className",checked:"defaultChecked",usemap:"useMap","for":"htmlFor",readonly:"readOnly"}}else{b=function(a){return a.attributes};b.compliant=true;b.renames={}}this.attributeArray=b;var h=function(q,a){var i=a[1].split(".");var p="";var m={};p+="if (!MochiKit."+i[1]+') { throw new Error("';p+="This function has been deprecated and depends on MochiKit.";p+=i[1]+'.");}';p+="return MochiKit."+i[1]+"."+a[0];p+=".apply(this, arguments);";m[i[2]]=new Function(p);MochiKit.Base.update(MochiKit[q],m)};for(var j;j<MochiKit.DOM.DEPRECATED.length;j++){h("DOM",MochiKit.DOM.DEPRECATED[j])}var d=this.createDOMFunc;this.UL=d("ul");this.OL=d("ol");this.LI=d("li");this.TD=d("td");this.TR=d("tr");this.TBODY=d("tbody");this.THEAD=d("thead");this.TFOOT=d("tfoot");this.TABLE=d("table");this.TH=d("th");this.INPUT=d("input");this.SPAN=d("span");this.A=d("a");this.DIV=d("div");this.IMG=d("img");this.BUTTON=d("button");this.TT=d("tt");this.PRE=d("pre");this.H1=d("h1");this.H2=d("h2");this.H3=d("h3");this.BR=d("br");this.HR=d("hr");this.LABEL=d("label");this.TEXTAREA=d("textarea");this.FORM=d("form");this.P=d("p");this.SELECT=d("select");this.OPTION=d("option");this.OPTGROUP=d("optgroup");this.LEGEND=d("legend");this.FIELDSET=d("fieldset");this.STRONG=d("strong");this.CANVAS=d("canvas");this.$=this.getElement;this.EXPORT_TAGS={":common":this.EXPORT,":all":f.concat(this.EXPORT,this.EXPORT_OK)};f.nameFunctions(this)}});MochiKit.DOM.__new__(((typeof(window)=="undefined")?this:window));if(MochiKit.__export__){withWindow=MochiKit.DOM.withWindow;withDocument=MochiKit.DOM.withDocument}MochiKit.Base._exportSymbols(this,MochiKit.DOM);