if(typeof(dojo)!="undefined"){dojo.provide("MochiKit.Color");dojo.require("MochiKit.Base");dojo.require("MochiKit.DOM");dojo.require("MochiKit.Style")}if(typeof(JSAN)!="undefined"){JSAN.use("MochiKit.Base",[]);JSAN.use("MochiKit.DOM",[]);JSAN.use("MochiKit.Style",[])}try{if(typeof(MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Color depends on MochiKit.Base"}try{if(typeof(MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Color depends on MochiKit.DOM"}try{if(typeof(MochiKit.Base)=="undefined"){throw""}}catch(e){throw"MochiKit.Color depends on MochiKit.Style"}if(typeof(MochiKit.Color)=="undefined"){MochiKit.Color={}}MochiKit.Color.NAME="MochiKit.Color";MochiKit.Color.VERSION="1.4";MochiKit.Color.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.Color.toString=function(){return this.__repr__()};MochiKit.Color.Color=function(d,b,a,c){if(typeof(c)=="undefined"||c===null){c=1}this.rgb={r:d,g:b,b:a,a:c}};MochiKit.Color.Color.prototype={__class__:MochiKit.Color.Color,colorWithAlpha:function(c){var b=this.rgb;var a=MochiKit.Color;return a.Color.fromRGB(b.r,b.g,b.b,c)},colorWithHue:function(c){var b=this.asHSL();b.h=c;var a=MochiKit.Color;return a.Color.fromHSL(b)},colorWithSaturation:function(c){var b=this.asHSL();b.s=c;var a=MochiKit.Color;return a.Color.fromHSL(b)},colorWithLightness:function(c){var b=this.asHSL();b.l=c;var a=MochiKit.Color;return a.Color.fromHSL(b)},darkerColorWithLevel:function(c){var b=this.asHSL();b.l=Math.max(b.l-c,0);var a=MochiKit.Color;return a.Color.fromHSL(b)},lighterColorWithLevel:function(c){var b=this.asHSL();b.l=Math.min(b.l+c,1);var a=MochiKit.Color;return a.Color.fromHSL(b)},blendedColor:function(a,c){if(typeof(c)=="undefined"||c===null){c=0.5}var f=1-c;var b=this.rgb;var h=a.rgb;var g=c;return MochiKit.Color.Color.fromRGB((b.r*f)+(h.r*g),(b.g*f)+(h.g*g),(b.b*f)+(h.b*g),(b.a*f)+(h.a*g))},compareRGB:function(d){var f=this.asRGB();var c=d.asRGB();return MochiKit.Base.compare([f.r,f.g,f.b,f.a],[c.r,c.g,c.b,c.a])},isLight:function(){return this.asHSL().b>0.5},isDark:function(){return(!this.isLight())},toHSLString:function(){var h=this.asHSL();var g=MochiKit.Color.clampColorComponent;var f=this._hslString;if(!f){var d=(g(h.h,360).toFixed(0)+","+g(h.s,100).toPrecision(4)+"%,"+g(h.l,100).toPrecision(4)+"%");var b=h.a;if(b>=1){b=1;f="hsl("+d+")"}else{if(b<=0){b=0}f="hsla("+d+","+b+")"}this._hslString=f}return f},toRGBString:function(){var f=this.rgb;var d=MochiKit.Color.clampColorComponent;var b=this._rgbString;if(!b){var a=(d(f.r,255).toFixed(0)+","+d(f.g,255).toFixed(0)+","+d(f.b,255).toFixed(0));if(f.a!=1){b="rgba("+a+","+f.a+")"}else{b="rgb("+a+")"}this._rgbString=b}return b},asRGB:function(){return MochiKit.Base.clone(this.rgb)},toHexString:function(){var a=MochiKit.Color;var f=this.rgb;var d=MochiKit.Color.clampColorComponent;var b=this._hexString;if(!b){b=("#"+a.toColorPart(d(f.r,255))+a.toColorPart(d(f.g,255))+a.toColorPart(d(f.b,255)));this._hexString=b}return b},asHSV:function(){var a=this.hsv;var b=this.rgb;if(typeof(a)=="undefined"||a===null){a=MochiKit.Color.rgbToHSV(this.rgb);this.hsv=a}return MochiKit.Base.clone(a)},asHSL:function(){var a=this.hsl;var b=this.rgb;if(typeof(a)=="undefined"||a===null){a=MochiKit.Color.rgbToHSL(this.rgb);this.hsl=a}return MochiKit.Base.clone(a)},toString:function(){return this.toRGBString()},repr:function(){var b=this.rgb;var a=[b.r,b.g,b.b,b.a];return this.__class__.NAME+"("+a.join(", ")+")"}};MochiKit.Base.update(MochiKit.Color.Color,{fromRGB:function(g,c,a,f){var d=MochiKit.Color.Color;if(arguments.length==1){var b=g;g=b.r;c=b.g;a=b.b;if(typeof(b.a)=="undefined"){f=undefined}else{f=b.a}}return new d(g,c,a,f)},fromHSL:function(b,c,f,d){var a=MochiKit.Color;return a.Color.fromRGB(a.hslToRGB.apply(a,arguments))},fromHSV:function(b,c,d,f){var a=MochiKit.Color;return a.Color.fromRGB(a.hsvToRGB.apply(a,arguments))},fromName:function(a){var c=MochiKit.Color.Color;if(a.charAt(0)=='"'){a=a.substr(1,a.length-2)}var b=c._namedColors[a.toLowerCase()];if(typeof(b)=="string"){return c.fromHexString(b)}else{if(a=="transparent"){return c.transparentColor()}}return null},fromString:function(a){var b=MochiKit.Color.Color;var c=a.substr(0,3);if(c=="rgb"){return b.fromRGBString(a)}else{if(c=="hsl"){return b.fromHSLString(a)}else{if(a.charAt(0)=="#"){return b.fromHexString(a)}}}return b.fromName(a)},fromHexString:function(b){if(b.charAt(0)=="#"){b=b.substring(1)}var d=[];var a,c;if(b.length==3){for(a=0;a<3;a++){c=b.substr(a,1);d.push(parseInt(c+c,16)/255)}}else{for(a=0;a<6;a+=2){c=b.substr(a,2);d.push(parseInt(c,16)/255)}}var f=MochiKit.Color.Color;return f.fromRGB.apply(f,d)},_fromColorString:function(h,b,l,m){if(m.indexOf(h)===0){m=m.substring(m.indexOf("(",3)+1,m.length-1)}var d=m.split(/\s*,\s*/);var g=[];for(var j=0;j<d.length;j++){var k=d[j];var f;var a=k.substring(k.length-3);if(k.charAt(k.length-1)=="%"){f=0.01*parseFloat(k.substring(0,k.length-1))}else{if(a=="deg"){f=parseFloat(k)/360}else{if(a=="rad"){f=parseFloat(k)/(Math.PI*2)}else{f=l[j]*parseFloat(k)}}}g.push(f)}return this[b].apply(this,g)},fromComputedStyle:function(g,f){var h=MochiKit.DOM;var a=MochiKit.Color.Color;for(g=h.getElement(g);g;g=g.parentNode){var c=MochiKit.Style.computedStyle.apply(h,arguments);if(!c){continue}var b=a.fromString(c);if(!b){break}if(b.asRGB().a>0){return b}}return null},fromBackground:function(b){var a=MochiKit.Color.Color;return a.fromComputedStyle(b,"backgroundColor","background-color")||a.whiteColor()},fromText:function(b){var a=MochiKit.Color.Color;return a.fromComputedStyle(b,"color","color")||a.blackColor()},namedColors:function(){return MochiKit.Base.clone(MochiKit.Color.Color._namedColors)}});MochiKit.Base.update(MochiKit.Color,{clampColorComponent:function(a,b){a*=b;if(a<0){return 0}else{if(a>b){return b}else{return a}}},_hslValue:function(c,b,a){if(a>6){a-=6}else{if(a<0){a+=6}}var d;if(a<1){d=c+(b-c)*a}else{if(a<3){d=b}else{if(a<4){d=c+(b-c)*(4-a)}else{d=c}}}return d},hsvToRGB:function(l,j,n,d){if(arguments.length==1){var k=l;l=k.h;j=k.s;n=k.v;d=k.a}var c;var g;var o;if(j===0){c=0;g=0;o=0}else{var h=Math.floor(l*6);var m=(l*6)-h;var b=n*(1-j);var a=n*(1-(j*m));var r=n*(1-(j*(1-m)));switch(h){case 1:c=a;g=n;o=b;break;case 2:c=b;g=n;o=r;break;case 3:c=b;g=a;o=n;break;case 4:c=r;g=b;o=n;break;case 5:c=n;g=b;o=a;break;case 6:case 0:c=n;g=r;o=b;break}}return{r:c,g:g,b:o,a:d}},hslToRGB:function(h,g,k,b){if(arguments.length==1){var m=h;h=m.h;g=m.s;k=m.l;b=m.a}var a;var c;var j;if(g===0){a=k;c=k;j=k}else{var l;if(k<=0.5){l=k*(1+g)}else{l=k+g-(k*g)}var n=(2*k)-l;var i=MochiKit.Color._hslValue;var d=h*6;a=i(n,l,d+2);c=i(n,l,d);j=i(n,l,d-2)}return{r:a,g:c,b:j,a:b}},rgbToHSV:function(a,c,k,b){if(arguments.length==1){var h=a;a=h.r;c=h.g;k=h.b;b=h.a}var i=Math.max(Math.max(a,c),k);var d=Math.min(Math.min(a,c),k);var g;var f;var j=i;if(d==i){g=0;f=0}else{var l=(i-d);f=l/i;if(a==i){g=(c-k)/l}else{if(c==i){g=2+((k-a)/l)}else{g=4+((a-c)/l)}}g/=6;if(g<0){g+=1}if(g>1){g-=1}}return{h:g,s:f,v:j,a:b}},rgbToHSL:function(a,c,j,b){if(arguments.length==1){var h=a;a=h.r;c=h.g;j=h.b;b=h.a}var i=Math.max(a,Math.max(c,j));var d=Math.min(a,Math.min(c,j));var g;var f;var l=(i+d)/2;var k=i-d;if(k===0){g=0;f=0}else{if(l<=0.5){f=k/(i+d)}else{f=k/(2-i-d)}if(a==i){g=(c-j)/k}else{if(c==i){g=2+((j-a)/k)}else{g=4+((a-c)/k)}}g/=6;if(g<0){g+=1}if(g>1){g-=1}}return{h:g,s:f,l:l,a:b}},toColorPart:function(a){a=Math.round(a);var b=a.toString(16);if(a<16){return"0"+b}return b},__new__:function(){var d=MochiKit.Base;this.Color.fromRGBString=d.bind(this.Color._fromColorString,this.Color,"rgb","fromRGB",[1/255,1/255,1/255,1]);this.Color.fromHSLString=d.bind(this.Color._fromColorString,this.Color,"hsl","fromHSL",[1/360,0.01,0.01,1]);var i=1/3;var a={black:[0,0,0],blue:[0,0,1],brown:[0.6,0.4,0.2],cyan:[0,1,1],darkGray:[i,i,i],gray:[0.5,0.5,0.5],green:[0,1,0],lightGray:[2*i,2*i,2*i],magenta:[1,0,1],orange:[1,0.5,0],purple:[0.5,0,0.5],red:[1,0,0],transparent:[0,0,0,0],white:[1,1,1],yellow:[1,1,0]};var j=function(m,o,n,k,l){var p=this.fromRGB(o,n,k,l);this[m]=function(){return p};return p};for(var f in a){var b=f+"Color";var g=d.concat([j,this.Color,b],a[f]);this.Color[b]=d.bind.apply(null,g)}var c=function(){for(var k=0;k<arguments.length;k++){if(!(arguments[k] instanceof Color)){return false}}return true};var h=function(l,k){return l.compareRGB(k)};d.nameFunctions(this);d.registerComparator(this.Color.NAME,c,h);this.EXPORT_TAGS={":common":this.EXPORT,":all":d.concat(this.EXPORT,this.EXPORT_OK)}}});MochiKit.Color.EXPORT=["Color"];MochiKit.Color.EXPORT_OK=["clampColorComponent","rgbToHSL","hslToRGB","rgbToHSV","hsvToRGB","toColorPart"];MochiKit.Color.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Color);MochiKit.Color.Color._namedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};