if(typeof(bobj.crv.ReportView)=="undefined"){bobj.crv.ReportView={}}bobj.crv.newReportView=function(a){a=MochiKit.Base.update({id:bobj.uniqueId(),viewStateId:null,isMainReport:false},a);var b=newWidget(a.id);bobj.fillIn(b,a);b.widgetType="ReportView";b.toolPanel=null;b.reportPage=null;b.grabber=null;b._lastPanelWidth=null;b.initOld=b.init;b.isMainReportFlag=b.isMainReport;b.setDisplayOld=b.setDisplay;MochiKit.Base.update(b,bobj.crv.ReportView);return b};bobj.crv.ReportView.init=function(){var b=MochiKit.Signal.connect;var c=MochiKit.Signal.signal;var a=MochiKit.Base.partial;this.initOld();if(this.toolPanel){b(this.toolPanel,"grpDrilldown",a(c,this,"grpDrilldown"));b(this.toolPanel,"grpNodeRetrieveChildren",a(c,this,"grpNodeRetrieveChildren"));b(this.toolPanel,"grpNodeCollapse",a(c,this,"grpNodeCollapse"));b(this.toolPanel,"grpNodeExpand",a(c,this,"grpNodeExpand"));b(this.toolPanel,"paramAdvanced",a(c,this,"paramAdvanced"));b(this.toolPanel,"paramApply",a(c,this,"paramApply"))}if(this.grabber){this.grabber.init();if(!this.toolPanel.isDisplayed()){this.grabber.setDisplay(false)}}};bobj.crv.ReportView.addChild=function(b){var c=MochiKit.Base;var a=MochiKit.Signal;if(b.widgetType=="ToolPanel"){this.toolPanel=b;a.connect(this.toolPanel,"resize",c.partial(a.signal,this,"resizeToolPanel"))}else{if(b.widgetType=="ReportPage"){this.reportPage=b}}};bobj.crv.ReportView.update=function(d,a){if(d&&d.cons=="bobj.crv.newReportView"){for(var b in d.children){var c=d.children[b];if(c){switch(c.cons){case"bobj.crv.newToolPanel":if(this.toolPanel&&a.updateToolPanel()){this.toolPanel.update(c,a)}break;case"bobj.crv.newReportPage":if(this.reportPage&&a.updateReportPage()){this.reportPage.update(c,a)}break}}}}};bobj.crv.ReportView.getHTML=function(){var b=bobj.html;if(this.toolPanel&&this.reportPage){this.grabber=newGrabberWidget(this.id+"_grabber",MochiKit.Base.bind(bobj.crv.ReportView._grabberCB,this),0,0,4,1,true)}var c={width:"100%",height:"100%",overflow:"hidden",position:"relative"};var a=b.DIV({id:this.id,style:c},this.toolPanel?this.toolPanel.getHTML():"",this.grabber?this.grabber.getHTML():"",this.reportPage?this.reportPage.getHTML():"");return a+bobj.crv.getInitHTML(this.widx)};bobj.crv.ReportView._doLayout=function(){if(!this.isDisplayed()){return}var b=this.toolPanel&&this.toolPanel.isDisplayed()?this.toolPanel.getWidth():0;var c=this.grabber&&this.grabber.isDisplayed()?this.grabber.getWidth():0;var a=this.getHeight();if(this.reportPage){this.reportPage.resize(this.getWidth()-b-c,a);this.reportPage.move(b+c,0)}if(this.grabber&&this.grabber.isDisplayed()){this.grabber.resize(null,a);this.grabber.move(b,0)}if(this.toolPanel&&this.toolPanel.isDisplayed()){this.toolPanel.resize(null,a)}};bobj.crv.ReportView.isMainReport=function(){return this.isMainReportFlag};bobj.crv.ReportView._grabberCB=function(a,b){this.toolPanel.resize(a);this._doLayout()};bobj.crv.ReportView.setDisplay=function(a){this.setDisplayOld(a);if(a){this._doLayout()}};bobj.crv.ReportView.resize=function(){this._doLayout()};bobj.crv.ReportView.getBestFitSize=function(){var b=0;var c=0;var a=this.reportPage?this.reportPage.getBestFitSize():null;if(a){b+=a.width;c+=a.height}else{if(this.toolPanel){c+=this.toolPanel.getHeight()}}if(this.toolPanel){b+=this.toolPanel.getWidth()}if(this.grabber){b+=this.grabber.getWidth()}return{width:b,height:c}};bobj.crv.ReportView.setDisplayToolPanel=function(a){if(this.toolPanel){this.toolPanel.setDisplay(a);if(this.grabber){this.grabber.setDisplay(a)}this._doLayout();MochiKit.Signal.signal(this,a?"showToolPanel":"hideToolPanel")}};bobj.crv.ReportView.hasContent=function(){return this.toolPanel||this.reportPage};function GrabberWidget_getHTML(){var b=this;var a=b.isHori?_resizeW:_resizeH;var d='onselectstart="return false" ondragstart="return false" onmousedown="'+_codeWinName+".GrabberWidget_down(event,'"+b.index+"',this);return false;\"";var c=_ie?('<img onselectstart="return false" ondragstart="return false" onmousedown="'+_codeWinName+'.eventCancelBubble(event)" border="0" hspace="0" vspace="0" src="'+_skin+'../transp.gif" id="modal_'+b.id+'" style="z-index:10000;display:none;position:absolute;top:0px;left:0px;width:1px;height:1px;cursor:'+a+'">'):('<div onselectstart="return false" ondragstart="return false" onmousedown="'+_codeWinName+'.eventCancelBubble(event)" border="0" hspace="0" vspace="0" id="modal_'+b.id+'" style="z-index:10000;display:none;position:absolute;top:0px;left:0px;width:1px;height:1px;cursor:'+a+'"></div>');return getBGIframe("grabIframe_"+b.id)+c+'<table cellpadding="0" cellspacing="0" border="0" '+d+' id="'+b.id+'" style="overflow:hidden;position:absolute;left:'+b.x+"px;top:"+b.y+"px;width:"+b.w+"px;height:"+b.h+"px;cursor:"+a+'"><tr><td></td></tr></table>'};