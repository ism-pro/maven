if(typeof bobj.crv.params.FlexParameterUI=="undefined"){bobj.crv.params.FlexParameterUI={}}bobj.crv.params.FlexParameterUI=function(){var j=[];var d=[];var f=[];var g=[];var a=[];var i=[];var h=[];var e;var c=[];var b=[]};bobj.crv.params.FlexParameterUI.setViewerLayoutType=function(b,a){if(!this._viewerLayoutType){this._viewerLayoutType=[]}this._viewerLayoutType[b]=a};bobj.crv.params.FlexParameterUI.setPromptData=function(b,a){if(!this._promptData){this._promptData=[]}this._promptData[b]=a};bobj.crv.params.FlexParameterUI.setCurrentIParamInfo=function(b,a,c){if(!this._paramCtrl){this._paramCtrl=[]}if(!this._currentIParam){this._currentIParam=[]}this._paramCtrl[b]=a;this._currentIParam[b]=c};bobj.crv.params.FlexParameterUI.setCloseDialogCallBack=function(b,a){if(!this._closeDialogCallBack){this._closeDialogCallBack=[]}this._closeDialogCallBack[b]=a};bobj.crv.params.FlexParameterUI.addIParamPromptUnitData=function(e,d,g,b){if(!this._iParamsPromptUnitData){this._iParamsPromptUnitData=[]}if(!this._iParamsPromptUnitData[e]){this._iParamsPromptUnitData[e]=[]}if(!this._iParamsParamData){this._iParamsParamData=[]}if(!this._iParamsParamData[e]){this._iParamsParamData[e]=[]}this._iParamsPromptUnitData[e][d]=b;for(var c=0,a=g.length;c<a;c++){var f=g[c];this._iParamsParamData[e][f]=d}};bobj.crv.params.FlexParameterUI.getSWF=function(b){if(!this._swfID||!this._swfID[b]){return}if(!this._swf){this._swf=[]}if(this._swf[b]){return this._swf[b]}else{var a=document.getElementById(this._swfID[b]);if(!a){return}this._swf[b]=a;return a}};bobj.crv.params.FlexParameterUI.getInstallHTML=function(){return L_bobj_crv_FlashRequired.replace("{0}","<br><a href='http://www.adobe.com/go/getflash/' target='_blank'>")+"</a>"};bobj.crv.params.FlexParameterUI.checkFlashPlayer=function(){return swfobject.hasFlashPlayerVersion("9.0.0")};bobj.crv.params.FlexParameterUI.createSWF=function(k,c,e,l){if(!this._swfID){this._swfID=[]}bobj.crv.logger.info("Create the SWF");if(this.checkFlashPlayer()){var a=bobj.crv.getLangCode();var b=bobj.crvUri("../../swf/");var h=b+"prompting.swf";var i=bobj.uniqueId();var d={eventTarget:k,locale:a,isIParamDialog:l,baseURL:b,servletURL:e};var f={menu:"false",wmode:"window",allowscriptaccess:"sameDomain"};var g={id:i,name:i,style:"z-index:"+bobj.constants.modalLayerIndex};if(!(_ie||_ie11Up)){document.getElementById(c).parentNode.style.visibility="hidden"}swfobject.embedSWF(h,c,"360","50","9.0.0","",d,f,g);this._swfID[k]=i;var j=getWidgetFromID(k);if(j&&j._reportProcessing){j._reportProcessing.delayedShow(false)}}else{document.getElementById(c).innerHTML="<p>"+this.getInstallHTML()+"</p>"}};bobj.crv.params.FlexParameterUI.init=function(i){if(!i||!this._swfID||!this._swfID[i]){return}bobj.crv.logger.info("Init the SWF");var a=this.getSWF(i);if(!a){return}var j=getWidgetFromID(i);if(j&&j._reportProcessing){j._reportProcessing.cancelShow()}if(a.setStateInfo){var h=MochiKit.Base.serializeJSON;a.setStateInfo(encodeURIComponent(h(bobj.crv.stateManager.getCompositeState())))}if(a.setIdealHeight){var d=bobj.crv.Viewer.LayoutTypes;var e=d.CLIENT;if(this._viewerLayoutType&&this._viewerLayoutType[i]){e=this._viewerLayoutType[i]}var b=MochiKit.Style.getElementDimensions(getLayer(i));var c=e===d.FIXED?0:400;a.setIdealHeight(Math.max(c,b.h-20))}if(this._currentIParam&&this._currentIParam[i]){if(!this._iParamsParamData||!this._iParamsParamData[i]||!this._iParamsPromptUnitData||!this._iParamsPromptUnitData[i]){this.setPromptData(i,null)}else{var g=this._iParamsParamData[i][this._currentIParam[i].paramName];if(!g){this.setPromptData(i,null)}var f=this._iParamsPromptUnitData[i][g];this.setPromptData(i,f)}}if(this._promptData&&this._promptData[i]&&a.setPromptData){a.setPromptData(this._promptData[i])}};bobj.crv.params.FlexParameterUI.setIParamValues=function(n,g,j,m){if(!this._paramCtrl||!this._currentIParam||!this._iParamsParamData||!this._iParamsPromptUnitData){return}var d=this._currentIParam[n];var h=this._paramCtrl[n];var a=this._iParamsParamData[n];var k=this._iParamsPromptUnitData[n];if(!d||!h||!a||!k){return}var b=d.paramName;if(g){for(var c=0,f=j.length;c<f;c++){var l=j[c];if(!l.name||!l.values){continue}h.updateParameter(l.name,l.values)}}else{h.updateParameter(b,j)}h._updateToolbar();var e=a[b];if(e){k[e]=m}this.closeIParamDialog(n)};bobj.crv.params.FlexParameterUI.closeIParamDialog=function(a){if(this._closeDialogCallBack&&this._closeDialogCallBack[a]){this._closeDialogCallBack[a]()}};bobj.crv.params.FlexParameterUI.resize=function(e,a,c){var b=this.getSWF(e);if(b){bobj.crv.logger.info("Resizing the SWF h:"+a+" w:"+c);b.style.width=c+"px";b.style.height=a+"px";var d=b.parentNode.style;d.position="absolute";d.visibility="visible"}};bobj.crv.params.FlexParameterUI.center=function(g,a){var b=this.getSWF(g);if(b){var h=bobj.crv.logger;h.info("Centering the SWF");var c=getLayer(g);if(!c){h.error("Could not find the viewer:"+g);return}var i=MochiKit.Style.getElementPosition(c);var f=MochiKit.Style.getElementDimensions(c);var e=MochiKit.Style.getElementDimensions(b);var d=b.parentNode.style;if(!a){d.top=Math.max(i.y,i.y+(f.h/2)-(e.h/2))+"px"}else{d.top=(i.y+10)+"px"}d.left=Math.max(i.x,i.x+(f.w/2)-(e.w/2))+"px";if(b.focus!=undefined){b.focus()}}};bobj.crv.params.FlexParameterUI.startMove=function(d){var b=this.getSWF(d);if(b){if(this._moveArea){return}this._moveArea=document.createElement("div");this._moveArea.id=bobj.uniqueId();MOVE_STYLE=this._moveArea.style;var a=b.style;var c=b.parentNode.style;MOVE_STYLE.top=c.top;MOVE_STYLE.left=c.left;MOVE_STYLE.width=a.width;MOVE_STYLE.height=a.height;MOVE_STYLE.border="1px";MOVE_STYLE.borderStyle="solid";MOVE_STYLE.borderColor="#000000";MOVE_STYLE.backgroundColor="#FFFFFF";MOVE_STYLE.position="absolute";MOVE_STYLE.opacity=0.5;MOVE_STYLE.filter="alpha(opacity=50)";MOVE_STYLE.zIndex=bobj.constants.modalLayerIndex-1;document.body.appendChild(this._moveArea);document.body.style.cursor="move"}};bobj.crv.params.FlexParameterUI.stopMove=function(b){var a=this.getSWF(b);if(a){var c=MochiKit.Style.getElementPosition(this._moveArea);MochiKit.Style.setElementPosition(a.parentNode,c);document.body.removeChild(this._moveArea);delete this._moveArea;document.body.style.cursor="default"}};bobj.crv.params.FlexParameterUI.Move=function(p,n,k){var e=this.getSWF(p);if(e){var r=bobj.crv.logger;r.info("doMove Called viewer:"+p+" x:"+n+" y:"+k);var j=getLayer(p);if(!j){r.error("Shifting SWF could not find the viewer:"+p);return}var h=this._moveArea;if(!h){r.error("Unable to move SWF, no move area available");return}var g=h.offsetLeft;var f=h.offsetTop;var q=h.offsetHeight;var i=h.offsetWidth;var c=j.offsetLeft;var b=j.offsetTop;var o=j.offsetHeight;var d=j.offsetWidth;var a=g+n;var s=f+k;if(s<b){s=b}else{if(s+q>b+o){s=o-q}}if(a<c){a=c}else{if(a+i>c+d){a=d-i}}h.style.top=s+"px";h.style.left=a+"px";r.info("Moved the SWF to x:"+a+" y:"+s)}};bobj.crv.params.FlexParameterUI.setParamValues=function(b,a){bobj.crv.logger.info("setting parameter values");bobj.event.publish("crprompt_flexparam",b,a)};bobj.crv.params.FlexParameterUI.logon=function(b,a){bobj.crv.logger.info("logging on");bobj.event.publish("crprompt_flexlogon",b,a)};