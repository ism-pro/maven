if(typeof bobj=="undefined"){bobj={}}if(typeof bobj.event=="undefined"){bobj.event={};bobj.event._topicSubscriptions={};bobj.event._globalSubscriptions=[]}bobj.event.publish=function(c){var b=bobj.slice(arguments,1);var e=bobj.event._topicSubscriptions[c];if(e){for(var d=0;d<e.length;++d){e[d]._notify.apply(null,b)}}var f=bobj.event._globalSubscriptions;for(var a=0;a<f.length;++a){f[a]._notify.apply(null,b)}};bobj.event.subscribe=function(){var a=bobj.event.subscribe._normalizer;if(!a){a=bobj.event.subscribe._normalizer=new bobj.ArgumentNormalizer();a.addRule("topic","target","methName");a.addRule([bobj.isString,"topic"],"callback");a.addRule("target","methName");a.addRule("callback")}return bobj.event.kwSubscribe(a.normalizeArray(arguments))};bobj.event.kwSubscribe=function(b){var d=MochiKit.Base.bind;var c={};if(b.callback){c._notify=b.callback}else{c._notify=d(b.target[b.methName],b.target)}if(b.topic){c.topic=b.topic;var a=bobj.event._topicSubscriptions;if(!a[b.topic]){a[b.topic]=[]}a[b.topic].push(c)}else{bobj.event._globalSubscriptions.push(c)}return c};bobj.event.unsubscribe=function(c){var b=bobj.event._globalSubscriptions;if(c.topic){b=bobj.event._topicSubscriptions[c.topic]}if(b){var a=MochiKit.Base.findIdentical(b,c);if(a!=-1){b.splice(a,1);delete c._notify}}};