if(typeof(bobj)=="undefined"){bobj={}}if(typeof(bobj.crv)=="undefined"){bobj.crv={};bobj.crv.ActxPrintControl_CLSID="88DD90B6-C770-4CFF-B7A4-3AFD16BB8824";bobj.crv.ActxPrintControl_Version="12,2,220,2677";bobj.crv.config={isDebug:false,scriptUri:null,skin:"skin_standard",needFallback:true,lang:"en",useCompressedScripts:true,useAsync:true,indicatorOnly:false,logging:{enabled:false,id:0}};bobj.crv.logger={info:function(){}};if(typeof(crv_config)=="object"){for(var i in crv_config){bobj.crv.config[i]=crv_config[i]}}if(!bobj.crv.config.scriptUri){var scripts=document.getElementsByTagName("script");var reCrvJs=/(.*)crv\.js$/i;for(var i=0;i<scripts.length;i++){var src=scripts[i].getAttribute("src");if(!src){continue}var matches=src.match(reCrvJs);if(matches&&matches.length){bobj.crv.config.scriptUri=matches[1];break}}if(!bobj.crv.config.scriptUri){bobj.crv.config.scriptUri="";if(bobj.crv.config.isDebug){throw"bobj.crv.config.scriptUri is undefined"}}}bobj.parseUri=function(c){var b="^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$";var a=c.match(new RegExp(b));return{scheme:a[2],authority:a[4],path:a[5],query:a[7],fragment:a[9]}};bobj.crvUri=function(a){return bobj.crv.config.scriptUri+a};bobj.skinUri=function(a){return bobj.crvUri("../dhtmllib/images/")+bobj.crv.config.skin+"/"+a};bobj.crv.createWidget=function(json){if(!bobj.isObject(json)){return null}var constructor=json.cons;if(bobj.isString(constructor)){try{constructor=eval(constructor)}catch(err){if(bobj.crv.config.isDebug){throw"bobj.crv.createWidget: invalid constructor"}}}if(!bobj.isFunction(constructor)){if(bobj.crv.config.isDebug){throw"bobj.crv.createWidget: invalid constructor"}return null}var widget=constructor(json.args);if(widget.addChild&&bobj.isArray(json.children)){for(var i=0,len=json.children.length;i<len;++i){var child=bobj.crv.createWidget(json.children[i]);widget.addChild(child)}}return widget};bobj.crv.writeWidget=function(q,h){var j=bobj.crv.createWidget(q);if(j){if(h){var k=j.getHTML();var c=bobj.html.extractHtml(k);var p=c.links;h.innerHTML=k;for(var o=0,m=p.length;o<m;++o){bobj.includeLink(p[o])}var e=c.scripts;for(var b=0,g=e.length;b<g;++b){var n=e[b];if(!n){continue}if(n.text){try{bobj.evalInWindow(n.text)}catch(d){}}}var a="";for(var f=0,l=c.styles.length;f<l;f++){a+=c.styles[f].text+"\n"}if(a.length>0){bobj.addStyleSheet(a)}}else{j.write()}}return j};bobj.crv._initWidget=function(b,d){try{var c=_widgets[b];c.init();if(d){MochiKit.DOM.removeElement(d)}}catch(a){if(bobj.crv.config.isDebug){var e="bobj.crv._initWidget: Couldn't initialize widget: ";e+="widx="+b;e+=", type=";if(!_widgets[b]){e+="null"}else{if(bobj.isString(_widgets[b].widgetType)){e+=_widgets[b].widgetType}else{e+="unknown"}}e+=" because: "+a;throw e}}};bobj.crv.getInitHTML=function(a){var b="bobj_crv_getInitHTML_"+a;return'<script id="'+b+'" language="javascript">bobj.crv._initWidget('+a+',"'+b+'");<\/script>'};bobj.crv._preloadProcessingIndicatorImages=function(){var e=bobj.crvUri("../dhtmllib/images/"+bobj.crv.config.skin+"/");var b=[];var d=["wait01.gif","dialogtitle.gif","dialogelements.gif","../transp.gif"];for(var c=0,a=d.length;c<a;c++){b[c]=new Image();b[c].src=e+d[c]}};bobj.crv._loadJavaScript=function(a){if(a){document.write('<script language="javascript" src="'+bobj.crvUri(a)+'"><\/script>')}};bobj.crv._includeAll=function(){bobj.crv._includeLocaleStrings();if(bobj.crv.config.useCompressedScripts){if(bobj.crv.config.indicatorOnly){bobj.crv._loadJavaScript("../../processindicator.js")}else{bobj.crv._loadJavaScript("../../allInOne.js");if(bobj.crv.config.logging.Enabled){bobj.crv._loadJavaScript("../log4javascript/log4javascript.js")}}return}else{var b=["../MochiKit/Base.js","../MochiKit/Async.js","../MochiKit/DOM.js","../MochiKit/Style.js","../MochiKit/Signal.js","../MochiKit/New.js","../MochiKit/Color.js","../MochiKit/Iter.js","../MochiKit/Visual.js","../log4javascript/log4javascript_uncompressed.js","../external/date.js","../dhtmllib/dom.js","initDhtmlLib.js","../dhtmllib/palette.js","../dhtmllib/menu.js","../dhtmllib/psheet.js","../dhtmllib/treeview.js","../dhtmllib/dialog.js","../dhtmllib/waitdialog.js","../../prompting/js/promptengine_prompts2.js","../../prompting/js/promptengine_calendar2.js","../swfobject/swfobject.js","common.js","html.js","Toolbar.js","ToolPanel.js","ReportPage.js","ReportView.js","ReportAlbum.js","Separator.js","Viewer.js","ViewerListener.js","StateManager.js","IOAdapters.js","ArgumentNormalizer.js","event.js","PromptPage.js","Dialogs.js","StackedPanel.js","Tooltip.js","Parameter.js","ParameterController.js","ParameterUI.js","ParameterPanel.js","bobjcallback.js","Calendar.js","FlexParameterUI.js"];for(var c=0,a=b.length;c<a;c++){document.write('<script language="javascript" src="'+bobj.crvUri(b[c])+'"><\/script>')}}};bobj.crv.getLangCode=function(){var c="_";if(bobj.crv.config.lang.indexOf("-")>0){c="-"}var b=bobj.crv.config.lang.split(c);if(b[0].toLowerCase()=="zh"){if(b.length>1){var a=b[1].toUpperCase();if(a=="TW"||a=="HK"||a=="MO"||a=="MY"){b[1]="TW"}else{b[1]="CN"}}else{b[1]="CN"}}if(b.length>1&&(!bobj.crv.config.needFallback||b[0].toLowerCase()=="zh")){b=b[0]+"_"+b[1]}else{b=b[0]}return b};bobj.crv._includeLocaleStrings=function(){var a=bobj.crv.getLangCode();if(bobj.crv.config.needFallback){bobj.crv._loadJavaScript("../../allStrings_en.js");if(a=="en"){return}}bobj.crv._loadJavaScript("../../allStrings_"+a+".js")};if(typeof MochiKit=="undefined"){MochiKit={}}if(typeof MochiKit.__export__=="undefined"){MochiKit.__export__=false}bobj.crv._preloadProcessingIndicatorImages();bobj.crv._includeAll();bobj.crv.initLog=function(a,b){bobj.crv.logger=log4javascript.getLogger();log4javascript.setEnabled(bobj.crv.config.logging.enabled);if(bobj.crv.config.logging.enabled){bobj.crv.logger.setLevel(a);var e=b+"?ServletTask=Log";var d=new log4javascript.AjaxAppender(e);bobj.crv.logger.addAppender(d);var c=bobj.crv.logger.log;bobj.crv.logger.log=function(h,g,f){c(h,bobj.crv.config.logging.id+" "+g,f)};bobj.crv.logger.info("Logging Initialized")}}}if(typeof(Sys)!=="undefined"){Sys.Application.notifyScriptLoaded()};