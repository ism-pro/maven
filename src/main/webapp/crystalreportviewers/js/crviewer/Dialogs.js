if(typeof bobj.crv.PrintUI=="undefined"){bobj.crv.PrintUI={}}if(typeof bobj.crv.ExportUI=="undefined"){bobj.crv.ExportUI={}}if(typeof bobj.crv.ErrorDialog=="undefined"){bobj.crv.ErrorDialog={}}if(typeof bobj.crv.ReportProcessingUI=="undefined"){bobj.crv.ReportProcessingUI={}}bobj.crv.newPrintUI=function(c){if(!c.id){c=MochiKit.Base.update({id:bobj.uniqueId()},c)}var d=c.submitBtnLabel;if(!d){d=L_bobj_crv_submitBtnLbl}var b=c.infoTitle;if(!b){b=L_bobj_crv_PrintInfoTitle}var a=c.dialogTitle;if(!a){if(c.isActxPrinting){a=L_bobj_crv_ActiveXPrintDialogTitle}else{a=L_bobj_crv_PDFPrintDialogTitle}}var f=c.infoMsg;if(!f){f=L_bobj_crv_PrintInfo1;f+="\n";f+=L_bobj_crv_PrintInfo2}var e=newDialogBoxWidget(c.id+"_dialog",a,250,100,null,bobj.crv.PrintUI._cancel,false);e.actxId=e.id+"_actx";e.actxContainerId=e.id+"_actxdiv";e._processingPrinting=false;e._initOld=e.init;e._showOld=e.show;if(!c.isActxPrinting){e._fromBox=newIntFieldWidget(e.id+"_fromBox",null,null,null,null,true,"",50);e._fromBox.setDisabled=bobj.crv.PrintUI.disabledTextFieldWidget;e._toBox=newIntFieldWidget(e.id+"_toBox",null,null,null,null,true,"",50);e._toBox.setDisabled=bobj.crv.PrintUI.disabledTextFieldWidget;e._submitBtn=newButtonWidget(e.id+"_submitBtn",d,MochiKit.Base.bind(bobj.crv.PrintUI._submitBtnCB,e));e._allRadio=newRadioWidget(e.id+"_allRadio",e.id+"_grp",L_bobj_crv_PrintAllLbl,MochiKit.Base.bind(bobj.crv.PrintUI.disabledPageRange,e,true));e._rangeRadio=newRadioWidget(e.id+"_rangeRadio",e.id+"_grp",L_bobj_crv_PrintPagesLbl,MochiKit.Base.bind(bobj.crv.PrintUI.disabledPageRange,e,false));e._optionsFrame=newFrameZoneWidget(e.id+"_optionsFrame",250);if(!c.isExporting){e._info=newInfoWidget(e.id+"_info",b,null,f,100)}}e.widgetType="PrintUI";bobj.fillIn(e,c);MochiKit.Base.update(e,bobj.crv.PrintUI);return e};bobj.crv.PrintUI.disabledTextFieldWidget=function(a){TextFieldWidget_setDisabled.call(this,a);if(a){MochiKit.DOM.addElementClass(this.layer,"textDisabled")}else{MochiKit.DOM.removeElementClass(this.layer,"textDisabled")}};bobj.crv.PrintUI.disabledPageRange=function(a){if(this._fromBox&&this._toBox){this._fromBox.setDisabled(a);this._toBox.setDisabled(a)}};bobj.crv.PrintUI._submitBtnCB=function(){var b=null;var a=null;if(this._rangeRadio.isChecked()){b=parseInt(this._fromBox.getValue(),10);a=parseInt(this._toBox.getValue(),10);if(!b||!a||(b<0)||(b>a)){alert(L_bobj_crv_PrintPageRangeError);return}}if(this.widgetType=="PrintUI"){MochiKit.Signal.signal(this,"printSubmitted",b,a)}else{MochiKit.Signal.signal(this,"exportSubmitted",b,a,this._comboBox.getSelection().value)}this.show(false)};bobj.crv.PrintUI._getRPSafeURL=function(c){if(!c){return}if(c.indexOf("/")===0){return c}var b=window.location.href;var a=b.lastIndexOf("/");if(a<0){return c}b=b.substring(0,a);return b+"/"+c};bobj.crv.PrintUI._getObjectTag=function(b){var c=[];c.push('<OBJECT width="0" height="0" ID="');c.push(this.actxId);c.push('" CLASSID="CLSID:');c.push(bobj.crv.ActxPrintControl_CLSID);c.push('" CODEBASE="');c.push(this._getRPSafeURL(this.codeBase));c.push("#Version=");c.push(bobj.crv.ActxPrintControl_Version);c.push('" VIEWASTEXT>');c.push('<PARAM NAME="PostBackData" VALUE="');c.push(b);c.push('">');c.push('<PARAM NAME="ServerResourceVersion" VALUE="');c.push(bobj.crv.ActxPrintControl_Version);c.push('">');if(this.lcid){c.push('<PARAM NAME="LocaleID" VALUE="');c.push(this.lcid);c.push('">')}if(this.url){c.push('<PARAM NAME="URL" VALUE="');c.push(this._getRPSafeURL(this.url));c.push('">')}if(this.title){c.push('<PARAM NAME="Title" VALUE="');c.push(this.title);c.push('">')}if(this.maxPage){c.push('<PARAM NAME="MaxPageNumber" VALUE="');c.push(this.maxPage);c.push('">')}if(this.paperOrientation){c.push('<PARAM NAME="PageOrientation" VALUE="');c.push(this.paperOrientation);c.push('">')}if(this.paperSize){c.push('<PARAM NAME="PaperSize" VALUE="');c.push(this.paperSize);c.push('">')}if(this.paperWidth){c.push('<PARAM NAME="PaperWidth" VALUE="');c.push(this.paperWidth);c.push('">')}if(this.paperLength){c.push('<PARAM NAME="PaperLength" VALUE="');c.push(this.paperLength);c.push('">')}if(this.driverName){c.push('<PARAM NAME="PrinterDriverName" VALUE="');c.push(this.driverName);c.push('">')}if(this.useDefPrinter){c.push('<PARAM NAME="UseDefaultPrinter" VALUE="');c.push(this.useDefPrinter);c.push('">')}if(this.useDefPrinterSettings){c.push('<PARAM NAME="UseDefaultPrinterSettings" VALUE="');c.push(this.useDefPrinterSettings);c.push('">')}if(this.sendPostDataOnce){c.push('<PARAM NAME="SendPostDataOnce" VALUE="');c.push(this.sendPostDataOnce);c.push('">')}c.push("</OBJECT>");c.push('<table id="');c.push(this.actxId);c.push('_wait" border="0" cellspacing="0" cellpadding="0" width="100%" ><tbody>');c.push('<tr><td align="center" valign="top">');var e=this;var d=e.getContainerWidth()-10;var a=e.getContainerHeight()-(2*e.pad+21+10);c.push('<table class="waitdialogzone" style="');c.push(sty("width",d));c.push(sty("height",a));c.push('" id="frame_table_');c.push(e.id);c.push('" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td valign="top" class="dialogzone" id="frame_cont_');c.push(e.id);c.push('">');c.push('<table border="0" cellspacing="0" cellpadding="0" width="100%"><tbody>');c.push('<tr><td align="center" style="padding-top:5px;">');c.push(img(_skin+"wait01.gif",200,40));c.push("</td></tr>");c.push('<tr><td align="left" style="padding-left:2px;padding-right:2px;padding-top:5px;">');c.push('<div class="icontext" style="wordWrap:break_word;">');c.push(convStr(L_bobj_crv_PrintControlProcessingMessage,false,true));c.push("</div></td></tr></tbody></table>");c.push("</td></tr></tbody></table>");c.push("</td></tr></tbody></table>");return c.join("")};bobj.crv.PrintUI._cancel=function(){if(this.isActxPrinting){document.getElementById(this.actxContainerId).innerHTML="";this._processingPrinting=false}};bobj.crv.PrintUI._processPrinting=function(){if(!this._processingPrinting){var b=document.getElementById(this.actxId);var a=document.getElementById(this.actxId+"_wait");if(b&&a){b.width="100%";b.height="100%";a.style.display="none"}this._processingPrinting=true}};bobj.crv.PrintUI.show=function(b,a){this._processingPrinting=false;if(b){if(!this.layer){targetApp(this.getHTML());this.init()}if(this.isActxPrinting){document.getElementById(this.actxContainerId).innerHTML=this._getObjectTag(a)}this._showOld(true)}else{if(this.layer){this._showOld(false)}}};bobj.crv.PrintUI.init=function(){this._initOld();if(!this.isActxPrinting){this._fromBox.init();this._toBox.init();this._submitBtn.init();this._optionsFrame.init();this._allRadio.init();this._rangeRadio.init();if(!this.isExporting){this._info.init()}this._allRadio.check(true);this._toBox.setDisabled(true);this._fromBox.setDisabled(true);if(this.widgetType=="ExportUI"){this._initExportList()}}};bobj.crv.PrintUI.getHTML=function(){var a=bobj.html;var c=this;var b=[];b.push(c.beginHTML());if(!this.isActxPrinting){b.push('<table class="dialogzone" border=0 cellpadding=0 cellspacing=2>');b.push("<tr>");b.push('  <td style="padding-top:4px;">');b.push(c._optionsFrame.beginHTML());if(this.widgetType=="ExportUI"){b.push(this._getExportList())}if(_ie){b.push('<label tabIndex="0">'+L_bobj_crv_PrintRangeLbl+"</label>")}else{b.push(L_bobj_crv_PrintRangeLbl)}b.push(c._allRadio.getHTML());b.push(c._rangeRadio.getHTML());b.push('<span style="padding-left:20px">'+L_bobj_crv_PrintFromLbl+"</span>");b.push(c._fromBox.getHTML());b.push('<span style="padding-left:4px">'+L_bobj_crv_PrintToLbl+"</span>");b.push(c._toBox.getHTML());b.push(c._optionsFrame.endHTML());b.push("  </td>");b.push("</tr><tr>");if(!this.isExporting){b.push('  <td style="padding-top:8px;">');b.push(c._info.getHTML());b.push("  </td>");b.push("</tr><tr>")}b.push('  <td align="right" style="padding-top:4px;">');b.push(c._submitBtn.getHTML());b.push("  </td>");b.push("</tr></table>")}else{b.push(a.DIV({id:this.actxContainerId}));b.push('<script for="'+this.actxId+'" EVENT="Finished(status, statusText)" language="javascript">');b.push('getWidgetFromID("'+this.id+'").show(false);');b.push("<\/script>");b.push('<script for="'+this.actxId+'" EVENT="PrintingProgress(pageNumber)" language="javascript">');b.push('getWidgetFromID("'+this.id+'")._processPrinting();');b.push("<\/script>")}b.push(c.endHTML());b.push(bobj.crv.getInitHTML(this.widx));return b.join("")};bobj.crv.newExportUI=function(kwArgs){kwArgs=MochiKit.Base.update({submitBtnLabel:L_bobj_crv_ExportBtnLbl,dialogTitle:L_bobj_crv_ExportDialogTitle,infoTitle:L_bobj_crv_ExportInfoTitle,infoMsg:L_bobj_crv_PrintInfo1,isExporting:true},kwArgs);var o=bobj.crv.newPrintUI(kwArgs);o._comboBox=newCustomCombo(o.id+"_combo",MochiKit.Base.bind(bobj.crv.ExportUI._onSelectFormat,o),false,270,L_bobj_crv_ExportFormatLbl,_skin+"../transp.gif",0,14);if(o._comboBox){o._comboBox.icon.border=0;o._comboBox.icon.h=14;o._comboBox.arrow.h=12;o._comboBox.arrow.dy+=2;o._comboBox.arrow.disDy+=2}o.availableFormats=(o.availableFormats?eval(o.availableFormats):null);var itemsCount=(bobj.isArray(o.availableFormats)?o.availableFormats.length:0);for(var i=0;i<itemsCount;i++){var item=o.availableFormats[i];o._comboBox.add(item.name,item.value,item.isSelected)}o.widgetType="ExportUI";MochiKit.Base.update(o,bobj.crv.ExportUI);return o};bobj.crv.ExportUI._onSelectFormat=function(){var a=this._comboBox.getSelection().value;if(a=="CrystalReports"||a=="RecordToMSExcel"||a=="CharacterSeparatedValues"||a=="XML"){this._fromBox.setDisabled(true);this._toBox.setDisabled(true);this._rangeRadio.check(false);this._rangeRadio.setDisabled(true);this._allRadio.check(true)}else{this._rangeRadio.setDisabled(false)}};bobj.crv.ExportUI._initExportList=function(){if(!this._comboBox.initialized()){this._comboBox.init();var a=this._comboBox.getItemByIndex(0);if(a!=null){this._comboBox.selectItem(a)}}this._onSelectFormat()};bobj.crv.ExportUI._getExportList=function(){var a=L_bobj_crv_ExportFormatLbl;if(_ie){a='<label tabIndex="0">'+L_bobj_crv_ExportFormatLbl+"</label>"}return a+this._comboBox.getHTML()};bobj.crv.ErrorDialog.getInstance=function(){if(!bobj.crv.ErrorDialog.__instance){bobj.crv.ErrorDialog.__instance=bobj.crv.newErrorDialog()}return bobj.crv.ErrorDialog.__instance};bobj.crv.newErrorDialog=function(a){a=MochiKit.Base.update({id:bobj.uniqueId(),title:L_bobj_crv_Error,text:null,detailText:null,okLabel:L_bobj_crv_OK,promptType:_promptDlgCritical},a);var b=newPromptDialog(a.id,a.title,a.text,a.okLabel,null,a.promptType,null,null,true);b.widgetType="ErrorDialog";bobj.fillIn(b,a);b._promptDlgInit=b.init;b._promptDialogSetText=b.setText;b._promptDialogShow=b.show;b._promptDialogSetTitle=b.setTitle;b._promptDialogSetPromptType=b.setPromptType;MochiKit.Base.update(b,bobj.crv.ErrorDialog);b.noCB=MochiKit.Base.bind(b._onClose,b);b.yesCB=b.noCB;b._detailBtn=newIconWidget(b.id+"_detailBtn",bobj.skinUri("../help.gif"),MochiKit.Base.bind(bobj.crv.ErrorDialog._onDetailBtnClick,b),L_bobj_crv_showDetails,null,16,16,0,0,22,0);return b};bobj.crv.ErrorDialog.init=function(){this._promptDlgInit();this._detailBtn.init();this._detailRow=document.getElementById(this.id+"_detRow");this._detailArea=document.getElementById(this.id+"_detArea");if(!this.detailText){this._detailBtn.show(false)}};bobj.crv.ErrorDialog.getHTML=function(){var i=bobj.html.TABLE;var b=bobj.html.TBODY;var e=bobj.html.TR;var k=bobj.html.TD;var l=bobj.html.PRE;var h=bobj.html.DIV;var j=PromptDialog_getimgPath(this.promptType);var f=PromptDialog_getimgAlt(this.promptType);var a="320";var d="300px";var g="100px";var c=i({"class":"dialogzone",width:a,cellpadding:"0",cellspacing:"5",border:"0"},b(null,e(null,k(null,i({"class":"dialogzone",cellpadding:"5",cellspacing:"0",border:"0"},b(null,e(null,k({align:"right",width:"32"},img(j,32,32,null,'id="dlg_img_'+this.id+'"',f)),k(),k({id:"dlg_txt_"+this.id,align:"left",tabindex:"0"},convStr(this.text,false,true))))))),e({id:this.id+"_detRow",style:{display:"none"}},k(null,h({"class":"infozone",style:{width:d,height:g,overflow:"auto"}},l({id:this.id+"_detArea"},this.detailText)))),e(null,k(null,getSep())),e(null,k(null,i({cellpadding:"5",cellspacing:"0",border:"0",width:"100%"},b(null,e(null,k({align:"left"},this._detailBtn.getHTML()),k({align:"right"},this.yes.getHTML()))))))));return this.beginHTML()+c+this.endHTML()};bobj.crv.ErrorDialog.setText=function(c,a){this.text=c;this.detailText=a;if(this.layer){this._promptDialogSetText(c||"");if(this._detailArea){this._detailArea.innerHTML=a||""}var b=a?true:false;this._detailBtn.show(b);if(!b){this.showDetails(false)}}};bobj.crv.ErrorDialog.setTitle=function(a){this.title=a;if(this.layer){this._promptDialogSetTitle(a||"")}};bobj.crv.ErrorDialog.setPromptType=function(a){this.promptType=a;if(this.layer){this._promptDialogSetPromptType(a)}};bobj.crv.ErrorDialog.show=function(a,b){if(typeof a=="undefined"){a=true}if(a){this._closeCB=b;if(!this.layer){targetApp(this.getHTML());this.init()}this.layer.onkeyup=DialogBoxWidget_keypress;DialogBoxWidget_keypress=MochiKit.Base.noop;this._promptDialogShow(true)}else{if(this.layer){this._closeCB=null;this._promptDialogShow(false)}}};bobj.crv.ErrorDialog.showDetails=function(a){if(typeof a=="undefined"){a=true}if(this._detailRow&&this._detailBtn){if(a){this._detailRow.style.display="";this._detailBtn.changeText(L_bobj_crv_hideDetails)}else{this._detailRow.style.display="none";this._detailBtn.changeText(L_bobj_crv_showDetails)}}};bobj.crv.ErrorDialog._onDetailBtnClick=function(){if(this._detailRow){this.showDetails(this._detailRow.style.display=="none")}};bobj.crv.ErrorDialog._onClose=function(){if(this._closeCB){this._closeCB();this._closeCB=null}DialogBoxWidget_keypress=this.layer.onkeyup;this.layer.onkeyup=null};bobj.crv.newReportProcessingUI=function(b){b=MochiKit.Base.update({id:bobj.uniqueId(),delay:3000,message:L_bobj_crv_ReportProcessingMessage},b);var e=document.createElement("div");e.style.visibility="hidden";e.innerHTML=b.message;var a=e.innerHTML;e=null;var c=newWaitDialogBoxWidget(b.id,0,0,"",true,bobj.crv.ReportProcessingUI.cancelCB,true,a);c.widgetType="ReportProcessingUI";c.delay=b.delay;MochiKit.Base.update(c,bobj.crv.ReportProcessingUI);return c};bobj.crv.reportProcessingDialog=null;bobj.crv.timerID=null;bobj.crv.ReportProcessingUI.cancelCB=function(){bobj.crv.reportProcessingDialog.cancelled=true;if(bobj.crv.reportProcessingDialog.deferred!==null){bobj.crv.reportProcessingDialog.deferred.cancel()}bobj.crv.reportProcessingDialog.cancelShow()};bobj.crv.ReportProcessingUI.wasCancelled=function(){return bobj.crv.reportProcessingDialog.cancelled};bobj.crv.ReportProcessingUI.delayedShow=function(a){if(bobj.crv.reportProcessingDialog!==null){bobj.crv.reportProcessingDialog.cancelShow()}if(!this.layer){targetApp(this.getHTML());this.init()}this.cancelled=false;this.deferred=null;this.setShowCancel(a,a?this.cancelCB:null);bobj.crv.reportProcessingDialog=this;bobj.crv.timerID=setTimeout("bobj.crv._showReportProcessingDialog ()",bobj.crv.reportProcessingDialog.delay)};bobj.crv.ReportProcessingUI.cancelShow=function(){if(bobj.crv.timerID){clearTimeout(bobj.crv.timerID)}if(bobj.crv.reportProcessingDialog){bobj.crv.reportProcessingDialog.show(false)}bobj.crv.reportProcessingDialog=null;bobj.crv.timerID=null};bobj.crv.ReportProcessingUI.setDeferred=function(a){bobj.crv.reportProcessingDialog.deferred=a;if(bobj.crv.reportProcessingDialog.wasCancelled()===true){a.cancel()}};bobj.crv._showReportProcessingDialog=function(){if(bobj.crv.reportProcessingDialog&&bobj.crv.reportProcessingDialog.delay!==0){bobj.crv.logger.info("ShowReportProcessingDialog");bobj.crv.reportProcessingDialog.show(true)}};