
if(typeof(bobj)=="undefined"){bobj={}}if(typeof(bobj.prompt)=="undefined"){bobj.prompt={}}bobj.prompt.Calendar=function(d,b,a,c){this.locale=a;this.crystalreportviewerPath=c+"/../";this.loadFiles();this.formName=d;this.dateFormat=b;this.dateTimeFormat=b+" H:mm:ss";this.isDateTime=false};bobj.prompt.Calendar.prototype={show:function(c,a){this.calendar=bobj.crv.Calendar.getInstance();this.input=document.getElementById(a);var b=c.target?c.target:c.srcElement;var d=this._getPosition(b);this._setValue(this.input.value);this._setSignals(true);this.calendar.setShowTime(this.isDateTime);this.calendar.show(true,d.x,d.y)},setIsDateTime:function(a){this.isDateTime=a},_getPosition:function(a){return MochiKit.Style.getElementPosition(a)},_setValue:function(b){var a=this._getDateValue(b);if(!a){a=new Date()}this.calendar.setDate(a)},_onOkayClick:function(a){this._setFieldValue(a)},_setFieldValue:function(a){if(this.input){this.input.value=this._getStringValue(a)}},_onHide:function(){this._removeSignals()},_getStringValue:function(a){var b=this.isDateTime?this.dateTimeFormat:this.dateFormat;return bobj.external.date.formatDate(a,b)},_getDateValue:function(a){var b=this.isDateTime?this.dateTimeFormat:this.dateFormat;return bobj.external.date.getDateFromFormat(a,b)},_setSignals:function(b){var a=b?MochiKit.Signal.connect:MochiKit.Signal.disconnect;a(this.calendar,this.calendar.Signals.OK_CLICK,this,"_onOkayClick");a(this.calendar,this.calendar.Signals.ON_HIDE,this,"_onHide")},_removeSignals:function(){this._setSignals(false)},loadJsResources:function(){var b=["js/external/date.js","js/MochiKit/Base.js","js/MochiKit/DOM.js","js/MochiKit/Style.js","js/MochiKit/Signal.js","js/dhtmllib/dom.js","prompting/js/initDhtmlLib.js","js/dhtmllib/palette.js","js/dhtmllib/menu.js","js/crviewer/html.js","js/crviewer/common.js","js/crviewer/Calendar.js"];for(var a=0;a<b.length;a++){this.loadJsFile(b[a])}},loadJsFile:function(a){document.write('<script src="'+this.crystalreportviewerPath+a+'" language="javascript"><\/script>')},loadLocaleStrings:function(){var a=["js/dhtmllib/language/en/labels.js","js/crviewer/strings_en.js"];var d="_";if(this.locale.indexOf("-")>0){d="-"}var c=this.locale.split(d);if(c.length>=1){a.push("js/dhtmllib/language/"+c[0]+"/labels.js");a.push("js/crviewer/strings_"+c[0]+".js")}if(c.length>=2){a.push("js/dhtmllib/language/"+c[0]+"_"+c[1]+"/labels.js");a.push("js/crviewer/strings_"+c[0]+"_"+c[1]+".js")}for(var b=0;b<a.length;b++){this.loadJsFile(a[b])}},loadFiles:function(){if(typeof(bobj.crv)=="undefined"){window.promptengine_skin=this.crystalreportviewerPath+"js/dhtmllib/images/skin_standard/";window.promptengine_style=this.crystalreportviewerPath+"js/crviewer/images/";window.promptengine_lang=this.locale;this.loadLocaleStrings();this.loadJsResources()}}};