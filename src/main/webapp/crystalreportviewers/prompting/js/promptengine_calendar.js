
topBackground="black";bottomBackground="white";tableBGColor="black";cellColor="lightgrey";headingCellColor="white";headingTextColor="black";headingFontStyle="bold 12pt arial, helvetica";bottomBorder=false;tableBorder=0;calendarTopOffsetFromImage=15;calendarLeftOffsetFromImage=15;var DateTimeFormat=true;var isNav=false;var isIE=false;if(navigator.appName=="Netscape"){isNav=true}else{isIE=true}var calDocTop;var calDocBottom;var promptEngineOrigOnMouseDown;buildCalParts();function setDateField(a,b){thisform=document.forms[a];calDateField=thisform[b];inDate=thisform[b].value;setInitialDate();calDocTop=buildTopCalFrame();calDocBottom=buildBottomCalFrame();if(document.onmousedown){promptEngineOrigOnMouseDown=document.onmousedown}document.onmousedown=clickit}function setInitialDate(){calDate=ParseDate(inDate,DateTimeFormat);if(isNaN(calDate)){calDate=new Date()}calDay=calDate.getDate();calDate.setDate(1)}function buildTopCalFrame(){var a='<div style="background:'+topBackground+"\" ><div id='IDcalControl'><CENTER><TABLE CELLPADDING=0 CELLSPACING=1 BORDER=0 WIDTH=100%><TR><TD COLSPAN=7><CENTER>"+getMonthSelect()+"<INPUT id='INtopYear' VALUE='"+calDate.getFullYear()+"'TYPE=TEXT SIZE=4 MAXLENGTH=4 onChange='setYear()' onfocus='INopenDocumentKey()' onblur='INopenDocumentKey()' onkeyup='INopenDocumentKey()' onKeyDown='if (window.event != null && window.event.keyCode == 13) setYear()'></CENTER></TD></TR><TR><TD COLSPAN=7><CENTER><INPUT TYPE=BUTTON id='INtopPreviousYear' VALUE='<<'    onClick='setPreviousYear()'><INPUT TYPE=BUTTON id='INtopPreviousMonth' VALUE=' < '   onClick='setPreviousMonth()'><INPUT TYPE=BUTTON id='INtopToday' VALUE='"+L_Today+"' onClick='setToday()'><INPUT TYPE=BUTTON id='INtopNextMonth' VALUE=' > '   onClick='setNextMonth()'><INPUT TYPE=BUTTON id='INtopNextYear' VALUE='>>'    onClick='setNextYear()'></CENTER></TD></TR></TABLE></CENTER></div></div>";return a}function buildBottomCalFrame(){var h=calendarBegin;month=calDate.getMonth();year=calDate.getFullYear();day=calDay;var c=0;var j=getDaysInMonth();if(day>j){day=j}var b=new Date(year,month,1);var e=b.getDay();j+=e;var f=0;for(c=0;c<e;c++){h+=blankCell;f++}var g=0;var d="weekday";for(c=e;c<j;c++){var a="&nbsp;";if(c-e+1<10){padding="&nbsp;&nbsp;"}else{padding="&nbsp;"}g=c-e+1;if(g==day){d="focusDay"}else{d="weekDay"}h+='<TD align=center style="background:'+cellColor+"\" ><a class='"+d+"' href='javascript:returnDate("+g+")'>"+padding+g+a+"</a></TD>";f++;if(f%7==0){h+="</TR><TR>"}}for(c=j;c<42;c++){h+=blankCell;f++;if(f%7==0){h+="</TR>";if(c<41){h+="<TR>"}}}h+=calendarEnd;return h}function writeCalendar(){calDocBottom=buildBottomCalFrame();if(document.getElementById){document.getElementById("bottomDiv").innerHTML=calDocBottom}}function setToday(){calDate=new Date();var b=calDate.getMonth();var a=calDate.getFullYear();document.getElementById("INtopMonth").selectedIndex=b;document.getElementById("INtopYear").value=a;calDay=calDate.getDate();writeCalendar()}function setYear(){var a=document.getElementById("INtopYear").value;if(isFourDigitYear(a)){calDate.setFullYear(a);writeCalendar()}else{document.getElementById("INtopYear").focus();document.getElementById("INtopYear").select()}document.onkeydown=function(){return false}}function setCurrentMonth(){var a=document.getElementById("INtopMonth").selectedIndex;calDate.setMonth(a);writeCalendar()}function setPreviousYear(){var a=document.getElementById("INtopYear").value;if(isFourDigitYear(a)&&a>1000){a--;calDate.setFullYear(a);document.getElementById("INtopYear").value=a;writeCalendar()}}function setPreviousMonth(){var a=document.getElementById("INtopYear").value;if(isFourDigitYear(a)){var b=document.getElementById("INtopMonth").selectedIndex;if(b==0){b=11;if(a>1000){a--;calDate.setFullYear(a);document.getElementById("INtopYear").value=a}}else{b--}calDate.setMonth(b);document.getElementById("INtopMonth").selectedIndex=b;writeCalendar()}}function setNextMonth(){var a=document.getElementById("INtopYear").value;if(isFourDigitYear(a)){var b=document.getElementById("INtopMonth").selectedIndex;if(b==11){b=0;a++;calDate.setFullYear(a);document.getElementById("INtopYear").value=a}else{b++}calDate.setMonth(b);document.getElementById("INtopMonth").selectedIndex=b;writeCalendar()}}function setNextYear(){var a=document.getElementById("INtopYear").value;if(isFourDigitYear(a)){a++;calDate.setFullYear(a);document.getElementById("INtopYear").value=a;writeCalendar()}}function getDaysInMonth(){var c;var b=calDate.getMonth()+1;var a=calDate.getFullYear();if(b==1||b==3||b==5||b==7||b==8||b==10||b==12){c=31}else{if(b==4||b==6||b==9||b==11){c=30}else{if(b==2){if(isLeapYear(a)){c=29}else{c=28}}}}return(c)}function isLeapYear(a){if(((a%4)==0)&&((a%100)!=0)||((a%400)==0)){return(true)}else{return(false)}}function isFourDigitYear(a){if(a==null||a.match(/^[0-9]{4}$/)==null){document.getElementById("INtopYear").value=calDate.getFullYear();document.getElementById("INtopYear").select();document.getElementById("INtopYear").focus()}else{return true}}function getMonthSelect(){monthArray=new Array(L_January,L_February,L_March,L_April,L_May,L_June,L_July,L_August,L_September,L_October,L_November,L_December);var a=calDate.getMonth();monthSelect="<SELECT id='INtopMonth' onChange='setCurrentMonth()'>";for(i in monthArray){if(i==a){monthSelect+="<OPTION SELECTED>"+monthArray[i]+"\n"}else{monthSelect+="<OPTION>"+monthArray[i]+"\n"}}monthSelect+="</SELECT>";return monthSelect}function createWeekdayList(){weekdayArray=new Array(L_Su,L_Mo,L_Tu,L_We,L_Th,L_Fr,L_Sa);var a="<TR BGCOLOR='"+headingCellColor+"'>";for(i in weekdayArray){a+="<TD style='text-decoration: none; color:"+headingTextColor+"; font: "+headingFontStyle+"' align=center>"+weekdayArray[i]+"</TD>"}a+="</TR>";return a}function buildCalParts(){weekdays=createWeekdayList();blankCell='<TD align=center style="vertical-align:middle; background:'+cellColor+'" >&nbsp;&nbsp;&nbsp;</TD>';calendarBegin="";'<div style="background:'+bottomBackground+"\" onload='javascript:self.focus()'>";if(document.getElementById){calendarBegin+="<DIV ID='bottomDiv'>"}calendarBegin+="<CENTER>";if(isNav){calendarBegin+="<TABLE CELLPADDING=0 CELLSPACING=1 BORDER="+tableBorder+" ALIGN=CENTER BGCOLOR='"+tableBGColor+"'><TR><TD>"}calendarBegin+="<TABLE CELLPADDING=0 CELLSPACING=1 BORDER="+tableBorder+" ALIGN=CENTER BGCOLOR='"+tableBGColor+"'>"+weekdays+"<TR>";calendarEnd="";if(bottomBorder){calendarEnd+="<TR></TR>"}if(isNav){calendarEnd+="</TD></TR></TABLE>"}calendarEnd+="</TABLE></CENTER>";if(document.getElementById){calendarEnd+="</DIV>"}calendarEnd+="</div>"}function jsReplace(c,d,b){var a="";if(!c){return""}if(c.indexOf(d)!=-1){t=c.split(d);return(t.join(b))}else{return c}}function doNothing(){}function makeTwoDigit(a){var b=parseInt(a,10);if(b<10){return("0"+b)}else{return b}}function returnDate(a){calDate.setDate(a);var b=calDate.getDate();var e=calDate.getMonth()+1;var d=calDate.getFullYear();if(promptengine_getIsTwoDigitMonth()){e=makeTwoDigit(e)}if(promptengine_getIsTwoDigitDay()){b=makeTwoDigit(b)}var c=promptengine_getDatePattern();c=jsReplace(c,"Y",d);c=jsReplace(c,"M",e);c=jsReplace(c,"D",b);if(DateTimeFormat==true){c+=" ";c+=gHour+":";gHour="00";c+=gMin+":";gMin="00";c+=gSec;gSec="00"}if(calDateField!=null&&!calDateField.disabled){calDateField.value=c;calDateField.focus()}document.getElementById("INIDcalendarWindow").style.display="none"}var gHour="00";var gMin="00";var gSec="00";var regDateTimePrompt=/^(D|d)(A|a)(T|t)(E|e)(T|t)(I|i)(M|m)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *, *([0-1]?\d|2[0-3]) *, *[0-5]?\d *, *[0-5]?\d *\)$/;var regDateTimePromptHTML=/^ *\d{4} *- *(0?[1-9]|1[0-2]) *- *((0?[1-9]|[1-2]\d)|3(0|1)) *  *([0-1]?\d|2[0-3]) *: *[0-5]?\d *: *[0-5]?\d *$/;function ParseDateTimePrompt(c){if(regDateTimePrompt.test(c)){var d=c.substr(c.indexOf("(")+1);d=d.substr(0,d.lastIndexOf(")"));var b=d.split(",");var l=new Date(b[0],Number(b[1])-1,b[2]);gHour=b[3];gMin=b[4];gSec=b[5];return l}if(regDateTimePromptHTML.test(c)){var h=c.indexOf("-");var a=c.substr(0,h);var e=c.substr(h+1);h=e.indexOf("-");var j=e.substr(h+1);e=e.substr(0,h);h=j.indexOf(" ");var g=j.substr(h+1);j=j.substr(0,h);h=g.indexOf(":");var k=g.substr(h+1);g=g.substr(0,h);h=k.indexOf(":");var f=k.substr(h+1);k=k.substr(0,h);gHour=g;gMin=k;gSec=f;return new Date(a,Number(e)-1,j)}return new Date()}var regDatePrompt=/^(D|d)(A|a)(T|t)(E|e) *\( *\d{4} *, *(0?[1-9]|1[0-2]) *, *((0?[1-9]|[1-2]\d)|3(0|1)) *\)$/;var regDatePromptHTML=/^ *\d{4} *- *(0?[1-9]|1[0-2]) *- *((0?[1-9]|[1-2]\d)|3(0|1)) *$/;function ParseDatePrompt(d){if(regDatePrompt.test(d)){var e=d.substr(d.indexOf("(")+1);e=e.substr(0,e.lastIndexOf(")"));var c=e.split(",");return new Date(c[0],Number(c[1])-1,c[2])}if(regDatePromptHTML.test(d)){var g=d.indexOf("-");var f=d.substr(0,g);var a=d.substr(g+1);g=a.indexOf("-");var b=a.substr(g+1);a=a.substr(0,g);return new Date(f,Number(a)-1,b)}return new Date()}function ParseDate(b,c){var a;if(c==true){a=ParseDateTimePrompt(b)}else{a=ParseDatePrompt(b)}return a}var INwidth=230;var INheight=250;var INscreenX=0;var INscreenY=0;function INCreateCalendar(d,c){if(document.getElementById("INIDcalendarWindow")==null){var a='<div class="INcalendarWindow" id="INIDcalendarWindow" onmousedown="INnoClose()"> <iframe src="" scroll=none frameborder=0 style="width:100%;height:100%;position:absolute;z-index:-9999"></iframe> <div class="INcalendarTitle" onmousedown="dragStart(event,\'INIDcalendarWindow\')"> <table  cellspacing="0" cellpadding="1" border="0" style="background:url(\''+d+'button_middle_normal.gif\');"> <tr> <td class="INtitleText">&nbsp;Business Objects</td> <td class="INclose" onclick="INcloseWin()"><img alt="Close" src="'+c+'errormsg.gif" height="12" width="12"/></td> </tr> </table> </div> <div class="INcalendarTop" id="INIDcalendarTop">&nbsp;</div> <div class="INcalendarBottom" id="INIDcalendarBottom">&nbsp;</div> </div>';if(document.body.insertAdjacentHTML){document.body.insertAdjacentHTML("afterBegin",a)}else{var b=document.createElement("div");b.innerHTML=a;document.body.appendChild(b)}}}function INwriteCalendar(d,b,e,c,a){INwidth=b;INheight=e;document.getElementById("INIDcalendarWindow").style.width=INwidth;document.getElementById("INIDcalendarWindow").style.height=INheight;document.getElementById("INIDcalendarTop").innerHTML=calDocTop;document.getElementById("INIDcalendarBottom").innerHTML=calDocBottom;setPosition(d);document.getElementById("INIDcalendarWindow").style.display="block"}function INcloseWin(){var a=document.getElementById("INIDcalendarWindow");if(a){a.style.display="none"}if(promptEngineOrigOnMouseDown){document.onmousedown=promptEngineOrigOnMouseDown}}function setPosition(f){var h;if(f.target){h=f.target}else{h=f.srcElement}var b=findPos(h);var k,j;var g;var d;if(isIE){k=document.body.clientWidth+document.documentElement.scrollLeft+document.body.scrollLeft;j=document.body.clientHeight+document.documentElement.scrollTop+document.body.scrollTop;g=230;d=250}if(isNav){k=window.innerWidth+window.scrollX-15;j=window.innerHeight+window.scrollY;g=230+8;d=250+8}var c=calendarLeftOffsetFromImage+b.x;var a=calendarTopOffsetFromImage+b.y;if(k-c>=g&&j-a>=d){document.getElementById("INIDcalendarWindow").style.left=c;document.getElementById("INIDcalendarWindow").style.top=a}else{if(k-c>=g&&j-a<d){document.getElementById("INIDcalendarWindow").style.left=c;document.getElementById("INIDcalendarWindow").style.top=j-d}else{if(k-c<g&&j-a>=d){document.getElementById("INIDcalendarWindow").style.left=k-g;document.getElementById("INIDcalendarWindow").style.top=a}else{if(j>d&&c-calendarLeftOffsetFromImage>g){document.getElementById("INIDcalendarWindow").style.left=c-calendarLeftOffsetFromImage-g;document.getElementById("INIDcalendarWindow").style.top=j-d}else{if(k>g&&a-calendarTopOffsetFromImage>=d){document.getElementById("INIDcalendarWindow").style.left=k-g;document.getElementById("INIDcalendarWindow").style.top=a-calendarTopOffsetFromImage-d}else{document.getElementById("INIDcalendarWindow").style.left=k-g;document.getElementById("INIDcalendarWindow").style.top=j-d}}}}}}function findPos(c){var b=c.offsetLeft;var a=c.offsetTop;while(c.offsetParent&&(c.offsetParent.style.position==""||c.offsetParent.style.position=="fixed")){c=c.offsetParent;b+=c.offsetLeft;a+=c.offsetTop}return{x:b,y:a}}var dragObject=new Object();dragObject.zIndex=0;function dragStart(c,e){var b;var a,d;if(e){dragObject.elNode=document.getElementById(e)}if(isIE){a=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;d=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}if(isNav){a=c.clientX+window.scrollX;d=c.clientY+window.scrollY}dragObject.cursorStartX=a;dragObject.cursorStartY=d;dragObject.elStartLeft=parseInt(dragObject.elNode.style.left,10);dragObject.elStartTop=parseInt(dragObject.elNode.style.top,10);if(isIE){if(isNaN(dragObject.elStartLeft)){dragObject.elStartLeft=INscreenX+INwidth/2+20}if(isNaN(dragObject.elStartTop)){dragObject.elStartTop=INscreenY-INheight+20}}else{if(isNaN(dragObject.elStartLeft)){dragObject.elStartLeft=INscreenX}if(isNaN(dragObject.elStartTop)){dragObject.elStartTop=INscreenY}}dragObject.elNode.style.zIndex=++dragObject.zIndex;if(isIE){document.attachEvent("onmousemove",dragBegin);document.attachEvent("onmouseup",dragEnd);window.event.cancelBubble=true;window.event.returnValue=false}if(isNav){document.addEventListener("mousemove",dragBegin,true);document.addEventListener("mouseup",dragEnd,true);c.preventDefault()}}function dragBegin(b){var a,c;if(isIE){a=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;c=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}if(isNav){a=b.clientX+window.scrollX;c=b.clientY+window.scrollY}dragObject.elNode.style.left=(dragObject.elStartLeft+a-dragObject.cursorStartX)+"px";dragObject.elNode.style.top=(dragObject.elStartTop+c-dragObject.cursorStartY)+"px";if(isIE){window.event.cancelBubble=true;window.event.returnValue=false}if(isNav){b.preventDefault()}}function dragEnd(a){dragObject.elNode=null;if(isIE){document.detachEvent("onmousemove",dragBegin);document.detachEvent("onmouseup",dragEnd)}if(isNav){document.removeEventListener("mousemove",dragBegin,true);document.removeEventListener("mouseup",dragEnd,true)}}var CloseIt=true;function clickit(){if(CloseIt){if(document.getElementById("INIDcalendarWindow")!=null){INcloseWin()}}else{CloseIt=true}}function INnoClose(){CloseIt=false}function INopenDocumentKey(){document.onkeydown=function(){return true}};