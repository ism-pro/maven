<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pi="http://primefaces.org/ui/ism"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      id="html">
    <h:head>
        <title><ui:insert name="title">#{ism.AppName}</ui:insert></title>
        <link rel="shortcut icon" href="#{resource['img/ism/favico.png']}" type="image/x-png" /> 
        <meta http-equiv="refresh" 
              content="#{ribbonView.advanceSessionMaxInactiveInterval()+2};url=#{request.contextPath}#{request.servletPath}/index.xhtml?faces-redirect=true"/>
        <meta charset="UTF-8"/>


        <f:facet name="last">
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- CSS - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

            <h:outputStylesheet library="css" name="ribbon/ism-ribbon.min.css" />
            <h:outputStylesheet library="css" name="ism-layout.min.css" />
            <h:outputStylesheet library="css" name="ism-global.min.css" />
            <h:outputStylesheet library="css" name="admin/ism-smq-nc.min.css" />


            <h:outputStylesheet library="webjars" name="font-awesome/4.7.0/css/font-awesome.min-jsf.css"/>
            <h:outputStylesheet library="webjars" name="bootstrap/3.3.7/css/bootstrap.min-jsf.css" />

            <!-- JQUERY UI REQUIRE FOR DATERANGE PICKER !!CSS INCOMPATIBLE!! -->
            <!-- <h:outputStylesheet library="vendor" name="jquery-ui/1.12.1/jquery-ui.min.css" /> -->
            
            <!-- DATE RANGE PIKER -->
            <h:outputStylesheet library="vendor" name="daterangepicker/0.6.0/jquery.comiseo.daterangepicker.min.css" />

            <!-- After bootstrap is mendatory -->
            <h:outputStylesheet library="css" name="ism.min.css" /> 




            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- JS  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

            <!-- PRIMEFACES  -->
            <h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />
            
            <!-- JQUERY UI : NECESSAIRE POUR L'USAGE DE DATRERANGE PICKER -->
            <h:outputScript library="vendor" name="jquery-ui/1.12.1/jquery-ui.min.js" target="head" />
            
            <!-- ISM JS -->
            <h:outputScript library="js" name="ism-global.min.js" />

            <!-- Date Range Piker -->
            <h:outputScript library="js" name="moment/2.18.1/moment.min.js" target="head" />
            <h:outputScript library="vendor" name="daterangepicker/0.6.0/jquery.comiseo.daterangepicker.js" />

            <!-- BOOTSTRAP -->
            <h:outputScript library="webjars" name="bootstrap/3.3.7/js/bootstrap.min.js"  />

        </f:facet>

    </h:head>

    <h:body id="body" rendered="#{request.session.getAttribute('authenticated')}">

        <!-- Affichage message maximum 5S -->
        <p:growl id="growl" life="5000" 
                 showDetail="true" showSummary="true" escape="false"/>  




        <p:layout id="fullPage" fullPage="#{viewLayout.layout.fullPage}"
                  resizeTitle="Réduire ou Double click pour réduire"
                  collapseTitle="Réduire la taille"
                  expandTitle="Etirer ou Double click pour restaurer"
                  closeTitle="Fermer"
                  stateful="true" 
                  widgetVar="fpLayoutWidget"
                  > 

            <p:ajax event="resize" listener="#{viewLayout.handleResize}" update="growl"/>
            <p:ajax event="close" listener="#{viewLayout.handleClose}" update="growl"/>
            <p:ajax event="toggle" listener="#{viewLayout.handleToggle}" update="growl"/>


            <p:layoutUnit id="unitNorth" position="north" 
                          size="#{viewLayout.northUnit.size}"
                          resizable="#{viewLayout.northUnit.resizable}" 
                          closable="#{viewLayout.northUnit.closable}"
                          collapsible="#{viewLayout.northUnit.collapsible}"
                          minSize="#{viewLayout.northUnit.minSize}"
                          maxSize="#{viewLayout.northUnit.maxSize}"
                          gutter="#{viewLayout.northUnit.gutter}"
                          visible="#{viewLayout.northUnit.visible}"
                          collapsed="#{viewLayout.northUnit.collapsed}"
                          collapseSize="#{viewLayout.northUnit.collapseSize}"
                          effect="#{viewLayout.northUnit.effect}"
                          effectSpeed="#{viewLayout.northUnit.effectSpeed}"
                          >

                <f:facet name="header" class="unitNorthHeader">
                    <h:form id="shortcutForm">

                        <p:poll id="poll" interval="#{ribbonView.reminingTimeSessionClock}" 
                                listener="#{ribbonView.updateReminingTimeSession()}" 
                                update="shortcut-label-reminingTimeout" global="false"  />



                        <div id="layout-shortcut" class="ui-layout-shortcut" >
                            <div id="shortcut-main" class="ui-main" >
                                <p:menuButton id="shortcut-selector" value=""  >
                                    <p:menuitem actionListener="#{ribbonView.findComponent('btn_1')}" value="btn 1" update="@form" />
                                    <p:menuitem actionListener="#{ribbonView.findComponent('btn_2')}" value="btn 2" update="@form" />
                                    <p:separator />
                                    <p:menuitem actionListener="#{ribbonView.findComponent('shortcut-btn-theme')}" value="#{ism.Themes}" update="@form" />
                                    <p:menuitem actionListener="#{ribbonView.findComponent('shortcut-btn-logout')}" value="#{ism.Authentication_Disconnect}" update="@form" />
                                    <p:menuitem actionListener="#{ribbonView.findComponent('shortcut-label-reminingTimeout')}" value="TimeOut" update="@form" />
                                </p:menuButton>
                            </div>
                            <div id="shortcut-left" class="ui-left">
                                <p:commandButton id="btn_1"  value='' rendered="false" />
                                <p:commandButton id="btn_2" value=''  rendered="false" />
                            </div>
                            <div id="shortcut-center" class="ui-center">
                                <p:outputLabel value="#{ism.AppNameA} [ #{ism.AppVersion} ]  -  #{ism.CompanyName} - #{staffAuthController.staff.stStaff} - #{staffAuthController.staff.stFirstname} #{staffAuthController.staff.stLastname} #{staffAuthController.staff.stMiddlename}"/>
                            </div>
                            <div id="shortcut-right" class="ui-right">
                                <p:selectOneMenu  id="shortcut-btn-theme" 
                                                  style="float:left;"
                                                  value="#{staffSetupController.theme}" 
                                                  valueChangeListener="#{staffSetupController.handleThemeChanged}"
                                                  filter="true" filterMatchMode="contains"
                                                  title="Thème recommandé (ISM, Flick Smothness, redmond , cupertino, aristo, bitzer, hot-sneaks, Excite Bike" 
                                                  var="t"
                                                  >
                                    <p:ajax oncomplete="location.reload();" />
                                    <f:selectItem   itemLabel="#{staffSetupController.selected.stsTheme}"
                                                    itemValue="#{themeService.getStrTheme(staffSetupController.selected.stsTheme)}"
                                                    />
                                    <f:selectItems value="#{themeService.themes}" var="th"  itemValue="#{th}"  />

                                    <p:column >
                                        <div style="min-width: 96px; min-height: 96px; padding: 0px; margin:0px;" class="ui-theme-#{t.name}"/>
                                    </p:column>

                                    <p:column>
                                        <h:outputText value="#{t.displayName}" />
                                    </p:column>
                                </p:selectOneMenu>

                                <div class="shortcut-timeout" >
                                    <p:outputLabel  id="shortcut-label-reminingTimeout"
                                                    value="#{ribbonView.reminingTimeSession / 60}'"
                                                    rendered="true"
                                                    />
                                </div>


                                <p:commandButton id="shortcut-collapse-nl" 
                                                 icon="ui-btn-sign-up"
                                                 styleClass="shortcut-btn"
                                                 value="" 
                                                 onclick="PF('fpLayoutWidget').toggle('north')"
                                                 />
                                <p:commandButton id="shortcut-btn-logout"
                                                 icon="ui-btn-exit"
                                                 styleClass="shortcut-btn"
                                                 value="#{ism.Authentication_Disconnect}" 
                                                 action="#{staffAuthController.logout}"
                                                 />
                            </div>
                        </div>
                    </h:form>
                </f:facet>








                <!-- Formulaire du rubban -->
                <h:form id="mainForm">


                    <div id="ribbon-layout">

                        <pi:ribbon id="ism-ribbon" activeIndex="#{ribbonView.activeIndex}" widgetVar="ribbon">
                            <p:ajax event="tabChange" listener="#{ribbonView.handleTabChange}" />


                            <p:tab id="main" title="#{ism.Home}" titletip="#{ism.HomeTitle}"   >

                                <pi:ribbonGroup id="ribbonGroupHome" label="#{ism.StaffField_stStaff}"  >

                                    <pi:ribbonGroupSet id="ribbonGroupSetHomeSetup" set="big" >
                                        <p:commandButton title="Visualiser la page d'acceuil"
                                                         action="/company/index.xhtml?faces-redirect=true"
                                                         icon="ui-ribbonicon-dashboard-big" 
                                                         value="#{ism.Dashboard}"
                                                         />

                                        <p:commandButton id="btnHomeStaffProfil"
                                                         actionListener="#{staffController.prepareUpdate(staffAuthController.staff.stStaff)}"
                                                         title="Visualiser votre profile"
                                                         action="/company/hr/staff/Profile.xhtml?faces-redirect=true"
                                                         icon="ui-ribbonicon-person"
                                                         value="#{staffAuthController.staff.stFirstname} #{staffAuthController.staff.stLastname} #{staffAuthController.staff.stMiddlename}"
                                                         rendered="#{request.isUserInRole('STAFF')}"
                                                         />

                                        <p:commandButton id="btnHomeStaffConfig"
                                                         actionListener="#{staffController.prepareUpdate(staffAuthController.staff.stStaff)}"
                                                         title="Visualiser vos configurations"
                                                         action="/company/hr/staff/Setup.xhtml?faces-redirect=true"
                                                         icon="ui-ribbonicon-config"
                                                         value="#{ism.Configurations}"
                                                         rendered="#{request.isUserInRole('STAFF')}"
                                                         />

                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>




                                <pi:ribbonGroup id="ribbonGroupApp" label="#{ism.AppTitle}"  >
                                    <pi:ribbonGroupSet set="middle">
                                        <p:commandButton title="#{ism.EntrepriseTitle}"
                                                         action="/company/admin/entreprise/List.xhtml?faces-redirect=true"
                                                         icon="ui-icon-company-woldwork" 
                                                         value="#{ism.EntrepriseField_EEntreprise}"
                                                         disabled="#{!request.isUserInRole('A_ENTREPRISE_L')}"
                                                         />
                                        <p:commandButton title="#{ism.CompanyTitleList}"
                                                         action="/company/admin/company/List.xhtml?faces-redirect=true"
                                                         icon="ui-icon-company-work" 
                                                         value="#{ism.CompanyField_CCompany}"
                                                         disabled="#{!request.isUserInRole('A_COMPANY_L')}"
                                                         />
                                    </pi:ribbonGroupSet>


                                    <pi:ribbonGroupSet id="ribbonGroupSetApp" set="small" >
                                        <p:commandButton actionListener="#{mailsenderController.prepareCreate()}"
                                                         title="Configuration du serveur de messagerie"
                                                         action="/company/admin/mailsender/List.xhtml?faces-redirect=true"
                                                         icon="ui-btn-smtp-server" 
                                                         value="#{ism.AppMailServer}"
                                                         />

                                        <p:commandButton title="Envoyer un email de test"
                                                         onclick="PF('emailTestDlg').show()"
                                                         icon="ui-btn-message" 
                                                         value="#{ism.EmailSendTestMsg}"
                                                         update=":growl"
                                                         />

                                    </pi:ribbonGroupSet>

                                </pi:ribbonGroup>



                            </p:tab>

                            <p:tab id="administration" title="#{ism.AdminPage}" titletip="#{ism.AdminPageTitle}">
                                <pi:ribbonGroup id="ribbonGroupSMQ" label="SMQ"  >
                                    <pi:ribbonGroupSet id="ribbonGroupSetSMQ" set="big" >
                                        <p:commandButton id="btnSMQProcessus"
                                                         rendered="#{request.isUserInRole('S_PROCESSUS')}"
                                                         title="Visualiser les processus"
                                                         action="/company/smq/processus/List.xhtml?faces-redirect=true"
                                                         icon="ui-ribbonicon-new" 
                                                         value="Processus"
                                                         />
                                        <p:commandButton id="btnSMQDocType"
                                                         rendered="#{request.isUserInRole('S_TYPE')}"
                                                         title="Visualiser les types de document"
                                                         action="/company/smq/docType/List.xhtml?faces-redirect=true"
                                                         icon="ui-ribbonicon-new" 
                                                         value="Type de document"
                                                         />
                                        <p:commandButton id="btnSMQDocument"
                                                         rendered="#{request.isUserInRole('S_EXPLORER')}"
                                                         title="Liste de document"
                                                         action="/company/smq/docExplorer/List.xhtml?faces-redirect=true"
                                                         icon="ui-ribbonicon-new" 
                                                         value="Documentation"
                                                         />
                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>

                                <pi:ribbonGroup id="RibbonGroupAdminNC" label="Non conformité" >
                                    <pi:ribbonGroupSet id="ribSetNC" set="big">
                                        <p:commandButton id="btnSMQNC"
                                                         title="Gestion de non conformité"
                                                         action="/company/smq/nc/Request/List.xhtml?faces-redirect=true"
                                                         rendered="#{request.isUserInRole('SNC_REQUEST')}"
                                                         icon="ui-icon-smqnc" 
                                                         value="Gérer"
                                                         />

                                        <p:menuButton id="menubutton-smq-nc" 
                                                      value="Configuration"
                                                      styleClass="ui-menubutton-smqnc"
                                                      >
                                            <p:menuitem id="splitButtonMenuItemNCUnit"
                                                        value="Unités"
                                                        action="/company/smq/nc/Unite/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('SNC_UNITE')}"
                                                        icon="ui-icon-smqnc-unit"
                                                        />
                                            <p:menuitem id="splitButtonMenuItemNCNature"
                                                        value="Nature" 
                                                        action="/company/smq/nc/Nature/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('SNC_NATURE')}"
                                                        icon="ui-icon-smqnc-nature"
                                                        />
                                            <p:menuitem id="splitButtonMenuItemNCGravity"
                                                        value="Gravités" 
                                                        action="/company/smq/nc/Gravite/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('SNC_GRAVITE')}"
                                                        icon="ui-icon-smqnc-gravite"
                                                        />
                                            <p:menuitem id="splitButtonMenuItemNCFrequency"
                                                        value="Fréquences" 
                                                        action="/company/smq/nc/Frequence/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('SNC_FREQUENCE')}"
                                                        icon="ui-icon-smqnc-frequence"
                                                        />
                                            <p:separator />
                                            <p:menuitem id="splitButtonMenuItemNCRequest"
                                                        value="Non conformité" 
                                                        action="/company/smq/nc/Request/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('SNC_REQUEST')}"
                                                        icon="ui-icon-smqnc-request" 
                                                        />
                                        </p:menuButton>

                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>

                                <pi:ribbonGroup label="Point Infos">
                                    <pi:ribbonGroupSet id="ribSetPointInfos" set="big">
                                        <p:commandButton id="btnPointInfos"
                                                         title="Gestion du point informations"
                                                         action="/company/smq/pointInfos/List.xhtml?faces-redirect=true"
                                                         rendered="#{request.isUserInRole('HR_GROUP')}"
                                                         icon="ui-btn-PointInfos" 
                                                         value="Infos"
                                                         />
                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>
                            </p:tab>

                            <p:tab id="resources" title="#{ism.HRPage}" titletip="#{ism.HRPageTitle}">
                                <pi:ribbonGroup id="RibbonGroupResources" label="Staff">
                                    <pi:ribbonGroupSet id="ribbonGroupSetStaffCreate" set="big">
                                        <p:menuButton   id="menubutton-hr-accessright" 
                                                        value="Droits"
                                                        styleClass="ui-menubutton-accessright"
                                                        >
                                            <p:menuitem id="splitButtonMenuItemHRGroup"
                                                        disabled="#{!request.isUserInRole('HR_GROUP')}"
                                                        title="Gérer vos groupes de staff donnant accès au utilisateur"
                                                        action="/company/hr/staffGroupDef/List.xhtml?faces-redirect=true"
                                                        value="Gestion des Groupes" 
                                                        icon="ui-icon-hrstaffgroups"
                                                        />
                                            <p:menuitem id="splitButtonMenuItemHRRole"
                                                        disabled="#{!request.isUserInRole('HR_GROUPROLE')}"
                                                        actionListener="#{staffGroupDefRoleController.prepareCreate}"
                                                        title="Associer des rôles d'accès au groupes de staff sous forme d'arbre"
                                                        action="/company/hr/staffGroupDefRole/CreateTree.xhtml?faces-redirect=true"
                                                        value="Gestion des rôles" 
                                                        icon="ui-icon-hrstaffroles" 
                                                        />
                                            <p:separator />
                                            <p:menuitem id="splitButtonMenuItemHRAcces"
                                                        disabled="#{!request.isUserInRole('HR_GROUPSTAFF')}"
                                                        title="Lier des utilisateur à un groupe d'accès"
                                                        action="/company/hr/staffGroups/List.xhtml?faces-redirect=true"
                                                        value="Gestion des droits"
                                                        icon="ui-icon-hrstaffacces"
                                                        />

                                        </p:menuButton>
                                        <p:commandButton id="btnStaffManageList"
                                                         rendered="#{request.isUserInRole('HR_MANAGER')}"
                                                         actionListener="#{staffManagerController.prepareCreate}"
                                                         title="Grille de la liste du staffs (utilisateurs)"
                                                         action="/company/hr/staffManager/List.xhtml?faces-redirect=true"
                                                         value="Staffs" 
                                                         icon="ui-icon-hrstaffusers"
                                                         />
                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>
                            </p:tab>








                            <p:tab id="tabProcess" title="#{ism.ProcessPage}" titletip="#{ism.ProcessPageTitle}" rendered="true" >
                                <pi:ribbonGroup id="RibbonGroupProcessIndustriel" label="Industriel">
                                    <pi:ribbonGroupSet id="ribbonGroupSetProcessIndustriel" set="small">
                                        <p:commandButton id="btnProcessEquipement"
                                                         rendered="#{request.isUserInRole('GUEST')}"
                                                         title="Gérer vos équipements industriel"
                                                         action="/company/process/equipement/List.xhtml?faces-redirect=true"
                                                         value="#{ism.EquipementTitle}" 
                                                         icon="ui-icon-equipement" 
                                                         />

                                        <p:commandButton id="btnProcessUnite"
                                                         rendered="#{request.isUserInRole('GUEST')}"
                                                         title="Gérer vos unité industriel"
                                                         action="/company/process/unite/List.xhtml?faces-redirect=true"
                                                         value="#{ism.UniteTitle}" 
                                                         icon="ui-icon-unite"
                                                         />
                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>

                                <pi:ribbonGroup id="RibbonGroupProcessCtrl" label="Analyse">
                                    <pi:ribbonGroupSet id="ribbonGroupSetProcessAnalyse" set="big">
                                        <p:commandButton id="btnProcessAnalysePoint"
                                                         title="Gestion des points d'échantillonnage"
                                                         action="/company/process/ctrl/AnalysePoint/List.xhtml?faces-redirect=true"
                                                         rendered="#{request.isUserInRole('GUEST')}"
                                                         icon="ui-icon-analysepoint" 
                                                         value="Point Echant." 
                                                         />

                                        <p:commandButton id="btnProcessAnalyseData"
                                                         title="Gestion des données d'analyse d'échantillonnage"
                                                         action="/company/process/ctrl/AnalyseData/List.xhtml?faces-redirect=true"
                                                         rendered="#{request.isUserInRole('GUEST')}"
                                                         icon="ui-icon-analysedata" 
                                                         value="Résultats"
                                                         />

                                        <p:menuButton id="menubutton-specification" 
                                                      value="Spécification"
                                                      styleClass="ui-icon-specification"
                                                      >
                                            <p:menuitem id="sBtnItemProcessAnalyseCategory"
                                                        value="Catégorie d'analyse"
                                                        action="/company/process/ctrl/AnalyseCategory/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analysecategory"
                                                        />
                                            <p:menuitem id="sBtnItemProcessAnalyseMethod"
                                                        value="Méthode d'analyse"
                                                        action="/company/process/ctrl/AnalyseMethod/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analysemethod"
                                                        />
                                            <p:separator />
                                            <p:menuitem id="sBtnItemProcessAnalyseType"
                                                        value="Type d'analyse"
                                                        action="/company/process/ctrl/AnalyseType/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analysetype"
                                                        />
                                            <p:menuitem id="sBtnItemProcessAnalysePoint"
                                                        value="Point d'analyse"
                                                        action="/company/process/ctrl/AnalysePoint/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analysepoint"
                                                        />
                                            <p:separator />
                                            <p:menuitem id="sBtnItemProcessAnalyseAllowed"
                                                        value="Analyse possible"
                                                        action="/company/process/ctrl/AnalyseAllowed/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analyseallowed"
                                                        />
                                            <p:menuitem id="sBtnItemProcessAnalyseNotify"
                                                        value="Notifications"
                                                        action="/company/process/ctrl/AnalyseNotify/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analysenotify"
                                                        />
                                            <p:separator />
                                            <p:menuitem id="sBtnItemProcessAnalyseData"
                                                        value="Résultats" 
                                                        action="/company/process/ctrl/AnalyseData/List.xhtml?faces-redirect=true"
                                                        rendered="#{request.isUserInRole('GUEST')}"
                                                        icon="ui-icon-analysedata"
                                                        />
                                        </p:menuButton>

                                        <p:commandButton id="btnProcessAnalyseDataStatis"
                                                         title="Gestion des données d'analyse par statistique"
                                                         action="/company/process/ctrl/AnalyseData/Request.xhtml?faces-redirect=true"
                                                         actionListener="#{viewAnalyseChart.prepareCreate()}"
                                                         rendered="#{request.isUserInRole('GUEST')}"
                                                         icon="ui-icon-analysedatastatis" 
                                                         value="Statistiques"
                                                         />

                                    </pi:ribbonGroupSet>
                                </pi:ribbonGroup>
                            </p:tab>



                            <p:tab id="manageLayout" title="#{ism.DisplayPage}" titletip="#{ism.DisplayPageTitle}" >
                                <pi:ribbonGroup id="managedLayoutGroup" label="Fenêtre">
                                    <pi:ribbonGroupSet id="manageLayoutAuto" set="big">
                                        <p:commandButton id="btnLayoutAuto"
                                                         icon="ui-icon-layoutInit"
                                                         value="Réinitialiser"
                                                         actionListener="#{viewLayout.handleInitLayout()}"
                                                         update="fullPage"/>
                                    </pi:ribbonGroupSet>
                                    <pi:ribbonGroupSet id="manageLayoutOC" set="small" >
                                        <p:commandButton value="Menu" type="button"  
                                                         icon="ui-icon-layoutWest"
                                                         onclick="PF('fpLayoutWidget').toggle('west')"/>  
                                        <p:commandButton value="Options" type="button"  
                                                         icon="ui-icon-layoutEast"
                                                         onclick="PF('fpLayoutWidget').toggle('east')"/>  
                                        <p:commandButton value="Log" type="button"  
                                                         icon="ui-icon-layoutSouth"
                                                         onclick="PF('fpLayoutWidget').toggle('south')"/>  
                                    </pi:ribbonGroupSet>

                                </pi:ribbonGroup>
                            </p:tab>
                        </pi:ribbon>
                    </div>
                </h:form>
            </p:layoutUnit>



            <p:layoutUnit   id="unitWest" position="west" 
                            size="#{viewLayout.westUnit.size}"
                            resizable="#{viewLayout.westUnit.resizable}" 
                            closable="#{viewLayout.westUnit.closable}"
                            collapsible="#{viewLayout.westUnit.collapsible}"
                            minSize="#{viewLayout.westUnit.minSize}"
                            gutter="#{viewLayout.westUnit.gutter}"
                            visible="#{viewLayout.westUnit.visible}"
                            collapsed="#{viewLayout.westUnit.collapsed}"
                            collapseSize="#{viewLayout.westUnit.collapseSize}"
                            effect="#{viewLayout.westUnit.effect}"
                            effectSpeed="#{viewLayout.westUnit.effectSpeed}"
                            >
                <f:facet name="header"><h:outputText value="Menu"/></f:facet> 
                <ui:insert id="west" name="west" />
            </p:layoutUnit>  

            <!--
            <p:layoutUnit id="unitEast" position="east" 
                          size="#{viewLayout.eastUnit.size}"
                          resizable="#{viewLayout.eastUnit.resizable}" 
                          closable="#{viewLayout.eastUnit.closable}"
                          collapsible="#{viewLayout.eastUnit.collapsible}"
                          minSize="#{viewLayout.eastUnit.minSize}"
                          maxSize="#{viewLayout.eastUnit.maxSize}"
                          gutter="#{viewLayout.eastUnit.gutter}"
                          visible="#{viewLayout.eastUnit.visible}"
                          collapsed="#{viewLayout.eastUnit.collapsed}"
                          collapseSize="#{viewLayout.eastUnit.collapseSize}"
                          effect="#{viewLayout.eastUnit.effect}"
                          effectSpeed="#{viewLayout.eastUnit.effectSpeed}"
                          >
                <f:facet name="header">
                    <h:graphicImage library="img" name="ism/std/Options.png" width="22px" height="22px" style="float:left;" /> 
                    <h:outputText value="Options"/> </f:facet>  
                <ui:insert id="east" name="east" />
            </p:layoutUnit>
            
            <p:layoutUnit id="unitSouth" position="south" 
                          size="#{viewLayout.southUnit.size}"
                          resizable="#{viewLayout.southUnit.resizable}" 
                          closable="#{viewLayout.southUnit.closable}"
                          collapsible="#{viewLayout.southUnit.collapsible}"
                          minSize="#{viewLayout.southUnit.minSize}"
                          maxSize="#{viewLayout.southUnit.maxSize}"
                          gutter="#{viewLayout.southUnit.gutter}"
                          visible="#{viewLayout.southUnit.visible}"
                          collapsed="#{viewLayout.southUnit.collapsed}"
                          collapseSize="#{viewLayout.southUnit.collapseSize}"
                          effect="#{viewLayout.southUnit.effect}"
                          effectSpeed="#{viewLayout.southUnit.effectSpeed}"
                          >
                <p:messages />
                <p:outputLabel value="#{ism.EmptyList} : #{request.pathInfo}"
                               rendered="#{request.pathInfo!='/company/smq/nc/Request/View.xhtml'?true:false}" />
                <p:outputLabel value="Theme : #{staffSetupController.selected.stsTheme}" />
            </p:layoutUnit>  
            -->




            <p:layoutUnit id="unitCenter" position="center" collapseSize="4" gutter="4" style="margin:0px;margin-left: -15px;">
                <ui:insert id="body" name="body" >
                    <p:dialog id="ReportDlg" widgetVar="ReportDlg" 
                              showEffect="clip"  hideEffect="clip" 
                              header="#{ism.ReportDlgTitle} : #{ism.ReportDlgMsg}" 
                              width="610"
                              draggable="false" resizable="false" modal="true" 

                              fitViewport="true" 
                              >

                        <h:form id="reportForm">
                            <p:panelGrid id="reportPanel" 
                                         columns="2" 
                                         columnClasses="columnFieldClass, columnContentClass" 
                                         styleClass="panelGridClass">

                                <p:outputLabel value="#{ism.ReportChooseOne}" for="fileReport" />
                                <p:selectOneMenu id="fileReport" value="#{crystalController.fileReport}">
                                    <p:ajax event="change" listener="#{crystalController.setFileReport(crystalController.fileReport)}" 
                                            update="outputReportPath" />
                                    <f:selectItem itemLabel="#{ism.SelectList}" itemValue="" />
                                    <f:selectItem itemLabel="#{csDialogView.itemLabel}" 
                                                  itemValue="#{csDialogView.itemValue}"  />
                                    <f:selectItems rendered="#{csDialogView.values!=null?true:false}" 
                                                   value="#{csDialogView.values}" var="report" 
                                                   itemLabel="#{report.report} : #{report.designation}"
                                                   itemValue="#{report}"
                                                   />
                                </p:selectOneMenu>

                                <p:outputLabel value="#{ism.ReportReload}" for="reportReload" />
                                <p:selectBooleanButton id="reportReload" value="#{crystalController.reloadFile}" 
                                                       offLabel="#{ism.No}" onLabel="#{ism.Yes}"
                                                       />


                                <p:outputLabel value="Rapport sélectionné" />
                                <p:outputLabel id="outputReportPath" value="#{crystalController.fileReport==''?'-':crystalController.fileReport}" />

                            </p:panelGrid>
                            <br/>

                            <p:commandButton  value="#{ism.ReportRun}" ajax="false"
                                              action="Report.xhtml?faces-redirect=true"
                                              oncomplete="PF('ReportDlg').hide()"
                                              actionListener="#{crystalController.handleCSReportViewer()}"
                                              icon="fa fa-eye"
                                              />
                            <p:commandButton value="#{ism.Cancel}" 
                                             icon="fa fa-times"
                                             onclick="PF('ReportDlg').hide()"/>
                        </h:form>
                    </p:dialog> 
                </ui:insert>
            </p:layoutUnit>





        </p:layout>













        <h:form id="MainFormDialog">
            <p:dialog header="Déconnexion imminante" 
                      widgetVar="dlgReminingTimeSessionWakeUp" 
                      modal="true" height="50" width="400" 
                      closable="false" resizable="false" >
                <h:outputText value="Continuer avec ISM ... " /> <br />
                <h:outputText value="#{ribbonView.currentPath}" />
                <br /><br />


                <f:facet name="footer" >
                    <p:commandButton id="dlgReminingTimeSessionWakeUpYes" 
                                     value="#{ism.Accept}"
                                     onclick="PF('dlgReminingTimeSessionWakeUp').hide();
                                             location.reload(true);"
                                     action="#{ribbonView.reloadCurrentPath()}"
                                     />
                    <p:commandButton id="dlgReminingTimeSessionWakeUpNo" 
                                     value="#{ism.Refused}"
                                     onclick="PF('dlgReminingTimeSessionWakeUp').hide();"
                                     action="#{staffAuthController.logout()}"
                                     />
                </f:facet>
            </p:dialog> 

            <p:confirmDialog id="mainConfirmDialog" 
                             global="#{viewConfirmDialog.dlg.global}"
                             header="#{viewConfirmDialog.header}"
                             severity="#{viewConfirmDialog.severity}"
                             width="#{viewConfirmDialog.dlg.width}"
                             height="#{viewConfirmDialog.dlg.height}"
                             closable="#{viewConfirmDialog.dlg.closable}"
                             showEffect="#{viewConfirmDialog.dlg.showEffect}"
                             hideEffect="#{viewConfirmDialog.dlg.hideEffect}"
                             closeOnEscape="#{viewConfirmDialog.dlg.closeOnEscape}"
                             widgetVar="mainConfirmDialog"
                             >
                <f:facet name="message">
                    <p:graphicImage library="img" 
                                    name="#{viewConfirmDialog.severity=='alert'?'ism/std/DlgWarning.png':'ism/std/DlgInfos.png'}"
                                    width="48" height="48" style="float: left;" />
                    <h:outputFormat value="#{viewConfirmDialog.message}" escape="false"/>
                </f:facet>

                <p:commandButton type="button" value="#{ism.ConfirmYes}" 
                                 styleClass="ui-confirmdialog-yes"
                                 icon="ui-btn-Accept"
                                 update="#{viewConfirmDialog.update}"
                                 oncomplete="PF('mainConfirmDialog').hide()"
                                 />
                <p:commandButton type="button" value="#{ism.ConfirmNo}" 
                                 styleClass="ui-confirmdialog-no"
                                 icon="ui-btn-Cancel"
                                 oncomplete="PF('mainConfirmDialog').hide()"
                                 />
            </p:confirmDialog>



            <p:dialog modal="true" widgetVar="statusDialog" header="Status" draggable="false"
                      showHeader="false" resizable="false" 
                      closable="false">
                <p:graphicImage width="120px" height="120px" library="img" name="ism/std/Onload.gif"/>
            </p:dialog>

            <p:ajaxStatus onstart="PF('statusDialog').show()" 
                          oncomplete="PF('statusDialog').hide();"/>


        </h:form>

        <p:dialog id="emailTestDlg" widgetVar="emailTestDlg" 
                  showEffect="clip"  hideEffect="clip" appendTo="@(body)" 
                  header="#{ism.EmailDlgTitle}" width="640"
                  modal="true"
                  >
            <h:form id="dialogForm">

                <p>
                    <p:outputLabel value="#{ism.EmailDlgInviteMessage}" />
                </p>
                <p:panelGrid id="emailTestPanel" 
                             columns="2" columnClasses="columnFieldClass, columnContentClass" 
                             styleClass="panelGridClass" >
                    <p:outputLabel value="#{ism.EmailDlgFieldReceiverEmail}" for="emailTest" />
                    <p:inputText id="emailTest" value="#{mailsenderController.emailTest}"
                                 />
                </p:panelGrid>
                <br/>
                <p:commandButton  value="#{ism.EmailDlgSend}" ajax="false"
                                  actionListener="#{mailsenderController.sendTestMail()}"
                                  onsuccess="PF('emailTestDlg').hide()"
                                  icon="fa fa-send"
                                  update=":growl"
                                  />
                <p:commandButton value="#{ism.Cancel}" 
                                 icon="fa fa-times"
                                 onclick="PF('emailTestDlg').hide()"/>

            </h:form>
        </p:dialog>

        <p:dialog id="ReportDlg" widgetVar="ReportDlg" 
                  showEffect="clip"  hideEffect="clip" appendTo="@(body)" 
                  header="#{ism.ReportDlgTitle} : #{ism.ReportDlgMsg}" 
                  width="610"
                  draggable="false" resizable="false" modal="true" 

                  fitViewport="true" 
                  >

            <h:form id="printForm">
                <p:panelGrid id="printPanel" 
                             columns="2" 
                             columnClasses="columnFieldClass, columnContentClass" 
                             styleClass="panelGridClass">

                    <p:outputLabel value="#{ism.ReportChooseOne}" for="fileReport" />
                    <p:selectOneMenu id="fileReport" value="#{crystalController.fileReport}">
                        <p:ajax event="change" listener="#{crystalController.setFileReport(crystalController.fileReport)}" 
                                update="outputReportPath" />
                        <f:selectItem itemLabel="#{ism.SelectList}" itemValue="" />
                        <f:selectItem itemLabel="#{csDialogView.itemLabel}" 
                                      itemValue="#{csDialogView.itemValue}"  />
                    </p:selectOneMenu>

                    <p:outputLabel value="#{ism.ReportReload}" for="reportReload" />
                    <p:selectBooleanButton id="reportReload" value="#{crystalController.reloadFile}" 
                                           offLabel="#{ism.No}" onLabel="#{ism.Yes}"
                                           />


                    <p:outputLabel value="Rapport sélectionné" />
                    <p:outputLabel id="outputReportPath" value="#{crystalController.fileReport==''?'-':crystalController.fileReport}" />

                </p:panelGrid>
                <br/>

                <p:commandButton  value="#{ism.ReportRun}" ajax="false"
                                  action="Report.xhtml?faces-redirect=true"
                                  oncomplete="PF('ReportDlg').hide()"
                                  actionListener="#{crystalController.handleCSReportViewer()}"
                                  icon="fa fa-eye"
                                  />
                <p:commandButton value="#{ism.Cancel}" 
                                 icon="fa fa-times"
                                 onclick="PF('ReportDlg').hide()"/>
            </h:form>
        </p:dialog> 


    </h:body>


    <h:body rendered="#{!request.session.getAttribute('authenticated')}">
        <meta http-equiv="refresh" 
              content="0;url=#{request.contextPath}#{request.servletPath}/index.xhtml?faces-redirect=true"/>
    </h:body>

</html>

