/*!
 * jQuery UI date range picker widget
 * Copyright (c) 2016 Tamble, Inc.
 * Licensed under MIT (https://github.com/tamble/jquery-ui-daterangepicker/raw/master/LICENSE.txt)
 *
 * Depends:
 *   - jQuery 1.8.3+
 *   - jQuery UI 1.9.0+ (widget factory, position utility, button, menu, datepicker)
 *   - moment.js 2.3.0+
 */
(function(m,k,p){var j=0;m.widget("comiseo.daterangepicker",{version:"0.5.0",options:{presetRanges:[{text:"Aujourd'hui",dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Hier",dateStart:function(){return moment().subtract("days",1)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Depuis 7 jours",dateStart:function(){return moment().subtract("days",6)},dateEnd:function(){return moment()}},{text:"Depuis (Lu-Di)",dateStart:function(){return moment().subtract("days",7).isoWeekday(1)},dateEnd:function(){return moment().subtract("days",7).isoWeekday(7)}},{text:"Mois au jour",dateStart:function(){return moment().startOf("month")},dateEnd:function(){return moment()}},{text:"Mois précédent",dateStart:function(){return moment().subtract("month",1).startOf("month")},dateEnd:function(){return moment().subtract("month",1).endOf("month")}},{text:"Année au jour",dateStart:function(){return moment().startOf("year")},dateEnd:function(){return moment()}}],initialText:"Sélection période...",icon:"ui-icon-triangle-1-s",applyButtonText:"Ok",clearButtonText:"Effacer",cancelButtonText:"Annuler",rangeSplitter:" - ",dateFormat:"M d, yy",altFormat:"yy-mm-dd",verticalOffset:0,mirrorOnCollision:true,autoFitCalendars:true,applyOnMenuSelect:true,open:null,close:null,change:null,clear:null,cancel:null,onOpen:null,onClose:null,onChange:null,onClear:null,datepickerOptions:{locale:"fr",numberOfMonths:2,maxDate:0}},_create:function(){this._dateRangePicker=q(this.element,this,this.options)},_destroy:function(){this._dateRangePicker.destroy()},_setOptions:function(a){this._super(a);this._dateRangePicker.enforceOptions()},open:function(){this._dateRangePicker.open()},close:function(){this._dateRangePicker.close()},setRange:function(a){this._dateRangePicker.setRange(a)},getRange:function(){return this._dateRangePicker.getRange()},clearRange:function(){this._dateRangePicker.clearRange()},widget:function(){return this._dateRangePicker.getContainer()}});function r(g,a,u){var b,i;function e(){i="drp_autogen"+j++;m('label[for="'+g.attr("id")+'"]').attr("for",i)}function v(){e();b=m('<button type="button"></button>').addClass(a+"-triggerbutton").attr({title:g.attr("title"),tabindex:g.attr("tabindex"),id:i}).button({icons:{secondary:u.icon},label:u.initialText})}function f(){return b.button("option","label")}function h(s){b.button("option","label",s)}function d(){g.val("").change();h(u.initialText)}function c(){b.button("option",{icons:{secondary:u.icon},label:u.initialText})}v();return{getElement:function(){return b},getLabel:f,setLabel:h,reset:d,enforceOptions:c}}function o(d,c,e){var f,b;function a(){f=m("<div></div>").addClass(d+"-presets");b=m("<ul></ul>");m.each(c.presetRanges,function(){m('<li><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).click(e).appendTo(b)});f.append(b);b.menu().data("ui-menu").delay=0}a();return{getElement:function(){return f}}}function n(x,v){var b,g={start:null,end:null};function w(){b=m("<div></div>",{"class":x+"-calendar ui-widget-content"});b.datepicker(m.extend({},v.datepickerOptions,{beforeShowDay:c,onSelect:f}));h()}function a(){b.datepicker("option",m.extend({},v.datepickerOptions,{beforeShowDay:c,onSelect:f}))}function f(z,t){var u=v.datepickerOptions.dateFormat||m.datepicker._defaults.dateFormat,s=m.datepicker.parseDate(u,z);if(!g.start||g.end){g.start=s;g.end=null}else{if(s<g.start){g.end=g.start;g.start=s}else{g.end=s}}if(v.datepickerOptions.hasOwnProperty("onSelect")){v.datepickerOptions.onSelect(z,t)}}function c(s){var u=[true,g.start&&((+s===+g.start)||(g.end&&g.start<=s&&s<=g.end))?"ui-state-highlight":""],t=[true,"",""];if(v.datepickerOptions.hasOwnProperty("beforeShowDay")){t=v.datepickerOptions.beforeShowDay(s)}return[u[0]&&t[0],u[1]+" "+t[1],t[2]]}function h(){setTimeout(function(){d();h()},moment().endOf("day")-moment())}function i(){if(g.start){b.datepicker("setDate",g.start)}}function d(){b.datepicker("refresh");b.datepicker("setDate",null)}function e(){g={start:null,end:null};d()}w();return{getElement:function(){return b},scrollToRangeStart:function(){return i()},getRange:function(){return g},setRange:function(s){g=s;d()},refresh:d,reset:e,enforceOptions:a}}function l(b,t,h){var d,c,g,i;function a(){d=m("<div></div>").addClass(b+"-buttonpanel");if(t.applyButtonText){c=m('<button type="button" class="ui-priority-primary"></button>').text(t.applyButtonText).button();d.append(c)}if(t.clearButtonText){g=m('<button type="button" class="ui-priority-secondary"></button>').text(t.clearButtonText).button();d.append(g)}if(t.cancelButtonText){i=m('<button type="button" class="ui-priority-secondary"></button>').text(t.cancelButtonText).button();d.append(i)}f()}function e(){if(c){c.button("option","label",t.applyButtonText)}if(g){g.button("option","label",t.clearButtonText)}if(i){i.button("option","label",t.cancelButtonText)}}function f(){if(h){if(c){c.click(h.onApply)}if(g){g.click(h.onClear)}if(i){i.click(h.onCancel)}}}a();return{getElement:function(){return d},enforceOptions:e}}function q(ar,X,an){var aB="comiseo-daterangepicker",au,aC,d,az,Z,ae,ay=false,ak=false,ao=0,c=1,ag=2,ai=3,g=["left","right","top","bottom"],ad=c,b=null;function f(){d=r(ar,aB,an);az=o(aB,an,av);Z=n(aB,an);h.numberOfMonths=an.datepickerOptions.numberOfMonths;if(h.numberOfMonths instanceof Array){an.autoFitCalendars=false}ae=l(aB,an,{onApply:function(s){aa(s);ax(null,s)},onClear:function(s){aa(s);am(s)},onCancel:function(s){X._trigger("cancel",s,{instance:X});aa(s);ac()}});ah();h();ac();a()}function ah(){au=m("<div></div>",{"class":aB+" "+aB+"-"+g[ad]+" ui-widget ui-widget-content ui-corner-all ui-front"}).append(m("<div></div>",{"class":aB+"-main ui-widget-content"}).append(az.getElement()).append(Z.getElement())).append(m('<div class="ui-helper-clearfix"></div>').append(ae.getElement())).hide();ar.hide().after(d.getElement());aC=m("<div></div>",{"class":"ui-front "+aB+"-mask"}).hide();m("body").append(aC).append(au)}function h(){if(an.autoFitCalendars){var u=m(k).width(),s=au.outerWidth(true),v=Z.getElement(),w=v.datepicker("option","numberOfMonths"),t=w;if(s>u){while(w>1&&au.outerWidth(true)>u){v.datepicker("option","numberOfMonths",--w)}if(w!==t){h.monthWidth=(s-au.outerWidth(true))/(t-w)}}else{while(w<h.numberOfMonths&&(u-au.outerWidth(true))>=h.monthWidth){v.datepicker("option","numberOfMonths",++w)}}aq();ak=false}}function Y(){au.remove();d.getElement().remove();ar.show()}function a(){d.getElement().click(al);d.getElement().keydown(i);aC.click(function(s){aa(s);ac()});m(k).resize(function(){ay?h():ak=true})}function aA(s){var t=an.dateFormat;return m.datepicker.formatDate(t,s.start)+(+s.end!==+s.start?an.rangeSplitter+m.datepicker.formatDate(t,s.end):"")}function ab(s){var t=an.altFormat,u={};u.start=m.datepicker.formatDate(t,s.start);u.end=m.datepicker.formatDate(t,s.end);return JSON.stringify(u)}function e(t){var v=an.altFormat,u=null;if(t){try{u=JSON.parse(t,function(x,w){return x?m.datepicker.parseDate(v,w):w})}catch(s){}}return u}function ac(){var s=aw();if(s){d.setLabel(aA(s));Z.setRange(s)}else{Z.reset()}}function ax(s,t){var u=s||Z.getRange();if(!u.start){return}if(!u.end){u.end=u.start}s&&Z.setRange(u);d.setLabel(aA(u));ar.val(ab(u)).change();if(an.onChange){an.onChange()}X._trigger("change",t,{instance:X})}function aw(){return e(ar.val())}function am(s){d.reset();Z.reset();if(an.onClear){an.onClear()}X._trigger("clear",s,{instance:X})}function av(u){var t=m(this),s=t.data("dateStart")().startOf("day").toDate(),v=t.data("dateEnd")().startOf("day").toDate();Z.setRange({start:s,end:v});if(an.applyOnMenuSelect){aa(u);ax(null,u)}return false}function aq(){au.position({my:"left top",at:"left bottom"+(an.verticalOffset<0?an.verticalOffset:"+"+an.verticalOffset),of:d.getElement(),collision:"flipfit flipfit",using:function(A,v){var w=v.element.left+v.element.width/2,t=v.target.left+v.target.width/2,B=ad,y,x=v.element.top+v.element.height/2,u=v.target.top+v.target.height/2,s=b,z;ad=(w>t)?c:ao;if(ad!==B){if(an.mirrorOnCollision){y=(ad===ao)?az:Z;au.children().first().append(y.getElement())}au.removeClass(aB+"-"+g[B]);au.addClass(aB+"-"+g[ad])}au.css({left:A.left,top:A.top});b=(x>u)?ai:ag;if(b!==s){if(s!==null){d.getElement().removeClass(aB+"-"+g[s])}d.getElement().addClass(aB+"-"+g[b])}z=b===ai&&v.element.top-v.target.top!==v.target.height+an.verticalOffset||b===ag&&v.target.top-v.element.top!==v.element.height+an.verticalOffset;d.getElement().toggleClass(aB+"-vfit",z)}})}function aj(s){s.preventDefault();s.stopPropagation()}function i(s){switch(s.which){case m.ui.keyCode.UP:case m.ui.keyCode.DOWN:aj(s);ap(s);return;case m.ui.keyCode.ESCAPE:aj(s);aa(s);ac();return;case m.ui.keyCode.TAB:aa(s);return}}function ap(s){if(!ay){d.getElement().addClass(aB+"-active");aC.show();ay=true;ak&&h();Z.scrollToRangeStart();au.show();aq()}if(an.onOpen){an.onOpen()}X._trigger("open",s,{instance:X})}function aa(s){if(ay){au.hide();aC.hide();d.getElement().removeClass(aB+"-active");ay=false}if(an.onClose){an.onClose()}X._trigger("close",s,{instance:X})}function al(s){if(ay){aa(s);ac()}else{ap(s)}}function af(){return au}function at(){var t=az;az=o(aB,an,av);t.getElement().replaceWith(az.getElement());Z.enforceOptions();ae.enforceOptions();d.enforceOptions();var s=aw();if(s){d.setLabel(aA(s))}}f();return{toggle:al,destroy:Y,open:ap,close:aa,setRange:ax,getRange:aw,clearRange:am,reset:ac,enforceOptions:at,getContainer:af}}})(jQuery,window);(function(b){if(typeof define==="function"&&define.amd){define(["../widgets/datepicker"],b)}else{b(jQuery.datepicker)}}(function(b){b.regional.fr={closeText:"Fermer",prevText:"Précédent",nextText:"Suivant",currentText:"Aujourd'hui",monthNames:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthNamesShort:["Janv.","Févr.","Mars","Avr.","Mai","Juin","Juil.","Août","Sept.","Oct.","Nov.","Déc."],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],dayNamesMin:["Di","Lu","Ma","Me","Je","Ve","Sa"],weekHeader:"Sem.",dateFormat:"dd/mm/yy",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""};b.setDefaults(b.regional.fr);return b.regional.fr}));