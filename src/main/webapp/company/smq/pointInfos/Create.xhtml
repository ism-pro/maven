<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/tmpl/MainWindow.xhtml">

        <ui:define name="body">
            <h1><h:outputText value="#{ism.PointInfosTitleCreate}"/></h1>

            <h:form id="bodyForm">

                <p:panelGrid id="panelForm" columns="2" columnClasses="columnFieldClass, columnContentClass" styleClass="panelGridClass"
                             rendered="#{pointInfosController.selected != null}">


                    <p:outputLabel value="#{ism.PointInfosField_piId}" rendered="false" for="piId" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" rendered="false">                
                        <p:inputText id="piId" 
                                     value="#{pointInfosController.selected.piId}" 
                                     title="#{ism.PointInfosFieldInfo_piId}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_piId}" 
                                     />
                        <p:message for="piId" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_piGroup}"  for="piGroup" rendered="false" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" rendered="false" >            
                        <p:inputText id="piGroup" 
                                     value="#{pointInfosController.selected.piGroup}" 
                                     title="#{ism.PointInfosFieldInfo_piGroup}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_piGroup}" 
                                     />
                        <p:message for="piGroup" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_piSlideshow}"  for="piSlideshow" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" >                
                        <p:inputText id="piSlideshow" 
                                     value="#{pointInfosController.selected.piSlideshow}" 
                                     title="#{ism.PointInfosFieldInfo_piSlideshow}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_piSlideshow}" 
                                     />
                        <p:message for="piSlideshow" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_piSlide}"  for="piSlide" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" >                
                        <p:inputText id="piSlide" 
                                     value="#{pointInfosController.selected.piSlide}" 
                                     title="#{ism.PointInfosFieldInfo_piSlide}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_piSlide}" 
                                     />
                        <p:message for="piSlide" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_pislidePath}"  for="pislidePath" rendered="false" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" rendered="false" >              
                        <p:inputText id="pislidePath" 
                                     value="#{pointInfosController.selected.pislidePath}" 
                                     title="#{ism.PointInfosFieldInfo_pislidePath}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_pislidePath}" 
                                     />
                        <p:message for="pislidePath" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_piDescription}"  for="piDescription" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" >                
                        <p:inputText id="piDescription" 
                                     value="#{pointInfosController.selected.piDescription}" 
                                     title="#{ism.PointInfosFieldInfo_piDescription}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_piDescription}" 
                                     />
                        <p:message for="piDescription" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_pislideDuration}"  for="pislideDuration" rendered="false" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" rendered="false" >         
                        <p:inputText id="pislideDuration" 
                                     value="#{pointInfosController.selected.pislideDuration}" 
                                     title="#{ism.PointInfosFieldInfo_pislideDuration}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_pislideDuration}" 
                                     />
                        <p:message for="pislideDuration" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_pislideShowDuration}"  for="pislideShowDuration" rendered="false" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" rendered="false" >            
                        <p:inputText id="pislideShowDuration" 
                                     value="#{pointInfosController.selected.pislideShowDuration}" 
                                     title="#{ism.PointInfosFieldInfo_pislideShowDuration}" 
                                     required="true" requiredMessage="#{ism.PointInfosRequiredMsg_pislideShowDuration}" 
                                     />
                        <p:message for="pislideShowDuration" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_piEnabled}"  for="piEnabled" rendered="false" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" rendered="false" >          
                        <p:selectBooleanCheckbox id="piEnabled"
                                                 value="#{pointInfosController.selected.piEnabled}" 
                                                 required="true" 
                                                 requiredMessage="#{ism.PointInfosRequiredMsg_piEnabled}" 
                                                 />
                        <p:message for="piEnabled" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_pilockOnStaff}"  for="pilockOnStaff" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" >                
                        <p:selectBooleanCheckbox id="pilockOnStaff"
                                                 value="#{pointInfosController.selected.pilockOnStaff}" 
                                                 required="true" 
                                                 requiredMessage="#{ism.PointInfosRequiredMsg_pilockOnStaff}" 
                                                 />
                        <p:message for="pilockOnStaff" />
                    </h:panelGrid>




                    <p:outputLabel value="#{ism.PointInfosField_piStaff}"  for="piStaff" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;" >                
                        <p:inputText id="piStaff" widgetVar="piStaff"
                                     value="#{pointInfosController.selected.piStaff = staffAuthController.staff}"
                                     style="display: none" 
                                     required="true" disabled="true" 
                                     requiredMessage="#{ism.PointInfosRequiredMsg_piCompany}"/>
                        <p:outputLabel style="margin-left: 5px;"
                                       value="#{staffAuthController.staff.stFirstname} #{staffAuthController.staff.stLastname} #{staffAuthController.staff.stMiddlename} [#{staffAuthController.staff.stStaff}]" />
                        <p:message for="piStaff" />
                    </h:panelGrid>


                    <p:outputLabel value="#{ism.PointInfosField_piCompany}" for="PCompany" />
                    <h:panelGrid columns="2" cellpadding="0px" cellspacing="0px" style="margin:0px; padding:0px;">
                        <p:inputText id="PCompany" widgetVar="PCompany"
                                     value="#{pointInfosController.selected.piCompany = staffAuthController.company}" 
                                     style="display: none" 
                                     required="true" disabled="true" 
                                     requiredMessage="#{ism.PointInfosRequiredMsg_piCompany}"/>
                        <p:outputLabel style="margin-left: 5px;"
                                       value="#{staffAuthController.company.CCompany} - #{staffAuthController.company.CDesignation}" />
                    </h:panelGrid>

                    <p:outputLabel value="Charger les slide" for="btnLoadSlide" />
                    <p:commandButton    id="btnLoadSlide" 
                                        value="Options" icon="ui-icon-extlink" 
                                        type="button" onclick="PF('loader').show()"
                                        />

                </p:panelGrid>




                <h:panelGroup id="btn-crud-zone_id"  >
                    <p:outputLabel  value="#{ism.CreateMultiple}" style="margin-right: 10px;"/>
                    <p:selectBooleanButton  value="#{pointInfosController.isOnMultiCreation}" 
                                            onLabel="#{ism.Yes}" offLabel="#{ism.No}" 
                                            onIcon="ui-icon-check" offIcon="ui-icon-close" 
                                            styleClass="ui-btn"
                                            >
                        <p:ajax update=":bodyForm:btn-crud-zone_id,westGroup,:growl" listener="#{pointInfosController.toggleMultiCreationFake()}"  />
                    </p:selectBooleanButton>

                    <p:commandButton icon="ui-btn-Save"
                                     styleClass="ui-btn"
                                     value="#{ism.Save}" 
                                     actionListener="#{pointInfosController.create}" 
                                     onstart="#{p:widgetVar('bodyForm:PCompany')}.enable();"
                                     update=":bodyForm,:growl" 
                                     rendered="#{pointInfosController.isOnMultiCreation}"
                                     />
                    <p:commandButton icon="ui-btn-SaveOne"
                                     styleClass="ui-btn"
                                     value="#{ism.Save}" 
                                     actionListener="#{pointInfosController.createUnReleasded()}" 
                                     onstart="#{p:widgetVar('bodyForm:PCompany')}.enable();"
                                     update=":bodyForm,:growl"
                                     action="List.xhtml?faces-redirect=true"
                                     rendered="#{!pointInfosController.isOnMultiCreation}"
                                     />

                    <p:commandButton icon="ui-btn-Cancel"
                                     styleClass="ui-btn"
                                     value="#{ism.Cancel}" 
                                     update=":bodyForm,:growl"
                                     actionListener="#{pointInfosController.prepareCreate()}"
                                     action="./List.xhtml?faces-redirect=true"
                                     immediate="true"
                                     />

                </h:panelGroup>

                <p:messages showDetail="true" showSummary="false"
                            escape="false"/>










                <p:dialog header="Chargement diapositive" widgetVar="loader"


                          >
                    <p:outputLabel value="Charger les slides" for="uploader" />
                    <p:fileUpload id="uploader" 
                                  fileUploadListener="#{uploaderController.upload}"
                                  value="#{uploaderController.uploadedFiles}"
                                  cancelLabel="#{ism.Cancel}"
                                  dragDropSupport="true"
                                  fileLimitMessage="#{ism.maxLoadingFileReach}"
                                  label="#{ism.SelectList}"
                                  previewWidth="1"
                                  multiple="true"
                                  update=":bodyForm, bodyForm:loadContent"
                                  />
                </p:dialog>


                <br /><br />
                <p:dataTable id="loadContent" value="#{uploaderController.uploadedFiles}"
                             draggableRows="true" rowIndexVar="rowKey"
                             var="file" rendered="#{uploaderController.uploadedFiles.size()==0?false:true}">


                    <f:facet name="header">
                        <p:commandButton id="toggler" type="button" value="Columns" 
                                         icon="ui-icon-calculator" 
                                         />
                        <p:commandButton type="button" icon="ui-icon-print" style="float:left;">
                            <p:printer target="loadContent"  />
                        </p:commandButton>

                        <p:columnToggler id="tableColToggler" datasource="loadContent" trigger="toggler" >
                        </p:columnToggler>


                    </f:facet>




                    <p:column headerText="N°" width="30px">
                        <h:outputText value="#{rowKey}" />
                    </p:column>

                    <p:column headerText="Nom du fichier">
                        <img width="320" height="180"
                             src="data:image/gif;base64,#{uploaderController.toImgBase64(file.contents)}" />
                    </p:column>
                    <p:column headerText="Type de contenu">
                        <p:outputLabel value="#{file.contentType}" />
                    </p:column>
                    <p:column headerText="Taille">
                        <p:outputLabel value="#{file.size/1000}ko" />
                    </p:column>

                </p:dataTable>


            </h:form>

        </ui:define>





        <ui:define name="west" id="west">
            <h:panelGroup id="westGroup">
                <p:commandButton icon="ui-btn-Save"
                                 styleClass="options-btn"
                                 value="#{ism.Save}" 
                                 actionListener="#{pointInfosController.create}" 
                                 onstart="#{p:widgetVar('bodyForm:PCompany')}.enable();"
                                 update=":bodyForm,:growl" 
                                 rendered="#{pointInfosController.isOnMultiCreation}"
                                 form="bodyForm"
                                 />
                <p:commandButton icon="ui-btn-SaveOne"
                                 styleClass="options-btn"
                                 value="#{ism.Save}" 
                                 actionListener="#{pointInfosController.createUnReleasded()}" 
                                 onstart="#{p:widgetVar('bodyForm:PCompany')}.enable();"
                                 update=":bodyForm,:growl"
                                 action="List.xhtml?faces-redirect=true"
                                 rendered="#{!pointInfosController.isOnMultiCreation}"
                                 form="bodyForm"
                                 />

                <p:commandButton icon="ui-btn-Cancel"
                                 styleClass="options-btn"
                                 value="#{ism.Cancel}" 
                                 update=":bodyForm,:growl"
                                 actionListener="#{pointInfosController.prepareCreate()}"
                                 action="./List.xhtml?faces-redirect=true"
                                 immediate="true"
                                 />

            </h:panelGroup>
        </ui:define>
    </ui:composition>
</html>
